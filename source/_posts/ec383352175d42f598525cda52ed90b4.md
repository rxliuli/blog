---
layout: post
title: Browser Extension Dev - 08. 发布 Chrome Web Store
abbrlink: ec383352175d42f598525cda52ed90b4
tags:
  - chrome extension
  - javascript
  - wxt
categories:
  - 前端
  - Browser Extension
date: 1769387224459
updated: 1769765073386
---

## 前言

在之前的 7 篇博客中，我们依次了解了一些扩展开发中的基本概念，并且每一篇都附上了一个扩展示例。现在，我们终于要演示如何发布扩展了。下面我们将演示如何将之前做的自动冻结不活跃标签页的那个扩展发布到 Chrome Web Store 中，还记得吗？就是我们在 [Browser Extension Dev - 04. Background Script](/p/5a4441fe1e7741dcaf90a837c3270715) 和 [Browser Extension Dev - 05. 存储和配置](/p/3b250074ced142abb1d239d244fc308a) 中作为示例的那个扩展。

## 步骤

### 准备 Chrome Web Store 发布账户

1. 首先按照官方文档注册开发者账户，需要一个 Google 账户并且支付一次性注册费用 \$5 即可完成。参考：<https://developer.chrome.com/docs/webstore/register>
2. 然后继续完成设置，主要是设置开发者账户名称，以及验证邮箱，没什么太复杂的。参考 <https://developer.chrome.com/docs/webstore/set-up-account>

注册完成后打开 <https://chrome.google.com/webstore/devconsole/> 应该可以看到如下页面。

![1769515955075.jpg](/resources/303dde3595df4cc08e991221d3659924.jpg)

### 构建扩展包

接下来，开始演示如何从构建到最终发布扩展。

首先，在项目中打开终端，然后运行 `pnpm zip`，应该会看到类似下面这样的输出，可以看到 Chrome 扩展已经被正常打包成 zip。

```sh
ℹ Zipping extension...
✔ Zipped extension in 12 ms
  └─ .output/05-storage-and-configuration-0.0.0-chrome.zip  13.37 kB
Σ Total size: 13.37 kB
```

在 .output 目录下找到这个文件，记住这个路径。

![1769517095997.jpg](/resources/5c268b954f5349d4b68972c97aac78ea.jpg)

### 上传到 Chrome Web Store

然后打开 <https://chrome.google.com/webstore/devconsole/> 并点击右上角的 New Item 按钮。

![1769517209416.jpg](/resources/aea91283c2d44517877f55c7868ef18b.jpg)

选择刚刚找到的 zip 文件上传，此时遇到了一个错误，提示 `The manifest has an invalid version: 0.0.0. Please format the version as defined`，也就是版本号不能为 0.0.0

![1769517322845.jpg](/resources/c53d9b18215448d6a32bfc5403c177af.jpg)

使用 `pnpm version patch` 将版本号增加到 0.0.1，然后重新运行 `pnpm zip` 构建并上传，即可看到扩展发布管理页面。

![1769517483216.jpg](/resources/d65a1462b600438783b7ee2f172b1cb5.jpg)

### 配置商店展示信息 (Store Listing)

其中，对于发布而言，最重要的两个标签页是 Store listing 和 Privacy。前者用于配置扩展在 Chrome Web Store 中的展示信息，例如简介、分类、图标和截图等等，后者则是权限使用说明和隐私政策链接。
对于这个扩展而言，选择分类为 Productivity > Tools，语言选择 English。

![1769649613093.jpg](/resources/2fa2a3164ad542ec8b53ef913007d708.jpg)

然后从 public/icon 目录选择 128.png 图标作为在商店显示的扩展图标。要截取精确 1280x800 像素的截图可能有点麻烦，但可以直接使用 <https://squoosh.app> 来调整截图的大小，使用 Resize 功能调整截图尺寸到 1280x800 就好了。

![1769518272363.jpg](/resources/bcf7514c502941f98d3fcc3bdaedec62.jpg)

> PS: 如果你使用 mac，可以使用小工具 [Window Resizer](https://rxliuli.com/project/window-resizer/) 来将窗口尺寸修改为指定大小。
> 参考 Chrome 官方发布文档 <https://developer.chrome.com/docs/webstore/publish>

### 配置隐私政策 (Privacy)

切换到 Privacy 标签，可以看到有几个主要区域

- Single purpose：单一用途说明，简单来说就是用一两句话说清楚扩展是做什么的
- Permission justification：权限使用说明，注意最后的 `Are you using remote code?`，Chrome 禁止使用远程代码，某些库（如 zod）可能会不小心引入远程代码，需特别留意
- Data usage：数据收集说明，选择扩展收集了什么数据，如果扩展是本地运行的，那么不需要选择任何选项
- Privacy policy：隐私政策链接，这是唯一需要外部托管的内容，可以在个人域名上托管它，如果是开源的，也可以直接放上 GitHub 相关文件的链接。这是一个示例：<https://rxliuli.com/webstore/privacy/>

![1769649228557.jpg](/resources/8783b517224a4def85fc0fa3ed4da3bd.jpg)
![1769649249668.jpg](/resources/79869791a7eb483dbb06e5f317e7815c.jpg)

### 提交审核

按下 Save draft 按钮之后，如果 Submit for review 按钮可用，那就说明可以提交扩展进行审核了。

![1769649204651.jpg](/resources/43601fc875c84b40b0b59b2334366a01.jpg)

提交审核后，将会进入审核队列，通常需要几天甚至更长时间进行初次审核，所以还请耐心等待，某些使用高风险权限（例如向所有网站注入脚本）或者针对高风险网站（当然，吾辈是在说 YouTube）的扩展可能需要等待更长时间。

![1769649344613.jpg](/resources/05b4e34e8dc64adcb37060e17e1359d3.jpg)

## 总结

至此，浏览器扩展开发的基础内容就介绍完了。后续可能会有一些进阶主题的番外篇，比如国际化、GitHub Actions 自动发布等。

> 如果还对发布 Safari 扩展并上架 App Store 感兴趣，可以查看我之前写的博客 [转换 Chrome Extension 为 Safari 版本](/p/1a7d920368904cd38a0ea562cf90b246) 和 [发布 Safari 扩展到 iOS 应用商店](/p/ca2067c24f564463824c10e27eef9bb9)。提醒一下，这非常复杂，且开发者账户无试用期，必须满足 1）有一台 macOS 电脑并且安装 Xcode 等开发工具 2）开通 App Store 开发者账户并支付 \$99/年的费用。
