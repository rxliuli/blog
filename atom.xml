<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>rxliuli blog</title>
  
  
  <link href="https://blog.rxliuli.com/atom.xml" rel="self"/>
  
  <link href="https://blog.rxliuli.com/"/>
  <updated>2023-02-20T15:32:15.444Z</updated>
  <id>https://blog.rxliuli.com/</id>
  
  <author>
    <name>rxliuli</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>周报 2023-02-20</title>
    <link href="https://blog.rxliuli.com/p/3635256a91074219a12bfd22ec830550/"/>
    <id>https://blog.rxliuli.com/p/3635256a91074219a12bfd22ec830550/</id>
    <published>2023-02-20T00:28:22.456Z</published>
    <updated>2023-02-20T15:32:15.444Z</updated>
    
    <content type="html"><![CDATA[<p>好吧，这次的周报迟了一天，昨天没能写成。这周主要是将计划中的 nat-test 考试完成了，后续计划的阻塞性问题将在 2~3 周内解决。</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8B2d-8y_Rf-t3-y1TctQS7xNzwCas7UtWm-JvjP84cOPofo-I8lH-QDZu6mHGA-gsoO4KHeq05P4qmSg1gOTZn3sQo3-Of1AINJPmUI8Qmc4nhNZOdDO-eGMyuR3FIsVJJuiphR4hFq61HcgwAmr8LP=w1739-h1304-no?authuser=0" alt="cover"></p><h2 id="学习"><a href="#学习" class="headerlink" title="学习"></a>学习</h2><p>截止到今天，《みんなの日本語》初级上册已经复习 24 课，虽然没有复习完成，但考试在 app 上模拟测试结果还不错，所以考试通过应该问题也不大。今天将第 25 课复习完成之后，明天就开始继续学习下册了，计划每两天学习一课、两个月之内学习完并完成 nat-test n4 测试。</p><h2 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h2><p>这周仍然没有进行太多的开发工作，主要处理了一下 chrome store 插件审核被拒的问题，chrome store 的审核真的太让人有挫败感，之前说吾辈插件的描述不正确，修改完成之后又要添加隐私权政策链接，虽然吾辈甚至不明白哪里涉及到了用户的隐私，代码都是开源的，也没有后端服务器。但 chrome store 永远只是说违规了，需要怎么怎么做，不得已之下使用 chatgpt 生成了一份。<br><img src="/resources/315114e477e2494d941702449cafc3ac.png" alt="1676869170168.png"></p><p>以及发布了 joplin-search-integration@0.5.0，支持了 you.com 搜索引擎集成，ref: <a href="https://github.com/rxliuli/joplin-utils/releases/tag/joplin-search-integration%400.5.0">https://github.com/rxliuli/joplin-utils/releases/tag/joplin-search-integration%400.5.0</a></p><h2 id="出行"><a href="#出行" class="headerlink" title="出行"></a>出行</h2><p>按照惯例，上周去了北京国家博物馆，感觉上要比颐和园和故宫要好玩，下面分享一下拍的照片。</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8CXLdZg93myEeExGyaqgpVgfedg7rUHemqG7VDL_pddo2oKE6xMKzB3s7ZoO7eu496g9SSXPBBF5fDpJnFLraNhiTmtNldL_5SOTNNAHaLvfXTaGItM0EK8utQewL9U9LRiTOTVCwO90yS5Vx8rxfwm=w1739-h1304-no" alt="img"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8CdGq_l7xbSVU_aU9TRRD6muO00TbTqQSTc2ecEO-9LGbPgsHPrgnOgbM5sUBbjWiOa5227NyamxPb5Uczew9jzaftjpTbRHLNZkII_2yn9KBIZliy_PpSTzzKih-FJnGudFt2AEo6uzqb_6LVcyARr=w978-h1304-no" alt="img"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8AWtIJbf_atQFepHIvEfionOTN67FfwcgS9ELnmWurXQTUdMeXRMv0KBtaWJxC-GgDnFr-4zNF930G9sTI-UTQCPcvLmgEhPR8D-wyG_GttDfe__ZhoqFxarKp1FTY2m5MYopv9nC7je12DiRXGprnw=w1739-h1304-no" alt="img"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8ARMWwuyI28WkNWVZ9OZUu7HDdUBtDhWnxinKX2UB2NPwhx7dqPAMo0XvcJCEYCd_Mm2ecwRpJjV_dbNBEBViRZ5r8LtHQMjotVLc-vo8_36HEQbvWECmQKqEtsdb2oFl4UDgZyt5c_TnCdo8ew3tj6=w978-h1304-no" alt="img"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8BReo9KWjb0LKK7EHzMvmggPtQtORCEBOs2ZcMgRCw4VjrzzTgTIbS7xAqLuhK9IGiNEHgc5yB_UO6TKFECAiuGXBbMVgvuZpJ28iFDOuB3RFnOA4vTy-Lzea1cXXUgGPpXRzYGPQve1fdoIfZOW7VO=w1739-h1304-no" alt="img"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8BnD35aISCl8XCwE1yr1HCBofvTcbNWe8EFVj_ghIKzI2jBKuOKD4qxpsdAH0E1Npflnseez1DKfUYaJVlDSVKLtvzh4qEWAtFQ-ZyXtgxBI4PPzYgkqI_Abt0M9l2u20E_q0Eu3diZSzyJ2tCzwKHF=w978-h1304-no" alt="img"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8DF8mwYgj84n8KCI5UYaYprAe_F6YJB_V8wsaNZxDKAxATQZlTiPlno63THMqB0D-rw1-SMt4-aBsjzmFyka6e9G3tzeVBxxrX_y5jG1g0GklesiLRXg33FJq2hVIgQMA_VA3nwxb3_2VyCs3n2ji_E=w1739-h1304-no" alt="img"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8BkEZd_jIHKcgZB7L60mMcimkBkYkgil3vQO9dP8qMINcl6ij9k6QSLWjGmh3t3tXK_rqnKjH5Egsbz9vpk1p62jJj-lrtBv2jpHTTYK4lj3EpGJXZN9btILciXQUXlXqz34Q0Q3DvGFbY0ox3rkYGS=w978-h1304-no" alt="img"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8DrZJPNC39OZYJthruTSzE30TViJH61INDthO8vxhJRm8vQ4qs6uhhCoH3jRMSXotwQXfxyCXpmyrGvWGU85ZyF__Rv2gZqVULtfAJsJwNNkw0y-CygOA0YZM_YY8Mepog1N8Z0GeMGzr32wSc13LuF=w978-h1304-no" alt="img"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8A6z0QyUGslRQnEo9Vwk-8wpNZ3ECn9Isd0dRm5ANqSmm2c0-S5IMPJCpv3YKNyEbuSLf7BIEVB2qfLuBauI4A_HJWLq00AdzU-gqdOgEYYg1NkhYsz5EOgh8UlhMdiM6jZ2MulKDLSHb54agvOztH1=w978-h1304-no" alt="img"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8CXVUiMKWXrruGGI6LPStpD0k_rGdO7glEpwzdH0UJW9fsDNC7KzYIPVDUqDzF9p34jQDW33UU7Gwj2M7en36sjw-fCgoRhgzkT3vMLiqyvXXI_Pag3GwgWA9kt_kbClDajCrllddiGW_DL-6C0Kapi=w978-h1304-no" alt="img"></p><p><a href="https://photos.app.goo.gl/JZUrMrmoeNTWGKG17">影集</a></p><p>这周六预计去北宫国家森林公园，有人想一起去玩么？</p>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="周报" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/%E5%91%A8%E6%8A%A5/"/>
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/tags/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="周报" scheme="https://blog.rxliuli.com/tags/%E5%91%A8%E6%8A%A5/"/>
    
  </entry>
  
  <entry>
    <title>周报 2023-02-12</title>
    <link href="https://blog.rxliuli.com/p/8142d81f162f4603b4cbf886c3035de6/"/>
    <id>https://blog.rxliuli.com/p/8142d81f162f4603b4cbf886c3035de6/</id>
    <published>2023-02-12T14:09:58.259Z</published>
    <updated>2023-02-12T15:56:08.861Z</updated>
    
    <content type="html"><![CDATA[<h2 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h2><p>这周开始尝试了有计划的生活，使用日程规划明天的非工作时间。从去年开始，已经开始感觉到没有计划随心做事已经很难提升自己了，直到这周才开始真正实践。<br>计划在工作日执行得还不错，但周末几乎完全失败了。一方面，没有料到一些插入的时间会那么花时间，例如公司的体检从今天 9 点半做到了 12 点，比吾辈想象中要花的时间多不少。另一方面，对于周末，仍未有某种规律的感觉，对之的时间感觉与工作日并不相同，即便花费时间去看小说或动画感觉似乎也没什么不好。<br>不过，下周将仍会继续做下去，寻找改变是最重要的，一成不变就意味着等死，明灯不息的熊熊烈火才是最为纯粹的生命本质。</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8A-TfoQjaVTbsCkswHu6v0gHI57KlJ3FNzQQPcEuApz1eXkzcWU33T1qy8yFZL9gEuraZ8V7nq7swyz5EJ8yJs3kmlubB0z1FoYswjgluQ8vxpjMbf5NVhb8rUKgcKTVgNg7mUH4o8yCmPuniIGzZfQ=w1783-h1337-no" alt="cover"></p><h2 id="学习"><a href="#学习" class="headerlink" title="学习"></a>学习</h2><p>这周还将多邻国正式使用了起来，目前还刚开始，但使用效果确实非常不错，就像是玩游戏一样。除了它刻意识别国内用户并限制了一些功能之外，吾辈对之没有太多不满，毕竟这并不是由它本身造成的。<br><img src="/resources/69a3d06e073c49cf8429afe7902e7524.png" alt="1676216159278.png"></p><p>总的来说，这周复习了从 13-18 五节课，还有 7 节课要复习，可能需要下周才能完成。但吾辈在想是否应该刷一下题，毕竟这对于考试可能真的更加重要。<br>另外这周还达成了使用手机学习的时间超过玩的时间，走出这一步真的不容易！<br><img src="/resources/276dd31fe9b6461ab5e3d418b52bf9ed.png" alt="1676216607399.png"></p><h2 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h2><p>这周两次收到 chrome store 的申请被拒，果然有了实际用户后审核就变得烦人起来了。<br>第一次提示吾辈添加了过多的关键字，因为在 readme 中吾辈列出了支持的搜索引擎 Google、Bing、Baidu、DuckDuckGo、Searx。吾辈删除之后紧接着提示了第二条，提示吾辈需要添加指向隐私权政策的链接，因为说吾辈处理个人或敏感数据，但吾辈完全不知道来源，这个插件基本上是离线运作的，将相关本地笔记集成到搜索中罢了。<br><img src="/resources/86efb030b4954ef1a811b752b98d173d.png" alt="1676216386388.png"></p><blockquote><p>插件链接: <a href="https://chrome.google.com/webstore/detail/joplin-search-integration/mcjkdcifkhjenpfjacnbhpdcnjknjkhj">Joplin Search Integration</a></p></blockquote><h2 id="出行"><a href="#出行" class="headerlink" title="出行"></a>出行</h2><p>这周去看了北京海洋馆和动物园，海洋馆全程室内体验还不错，动物园这个季节确实差强人意，也许吾辈应该等到快夏天的时候再去一次，下面分享一些照片。</p><p>不知为何，蝙蝠鱼让吾辈立刻想到了恶魔之魂中风暴之王，它们的体型看起来真的有点像。<br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8B5tnx5MLqDJjnoha3NySwUrmzQaX8d33RVei3VkVPJ8NjUBMcuw--BD7vQoiL9XenxyXrcluUWREYIXPDMZImZMmAAufuw8j_O-8UorP1ek9RZZcEHr7ERXYnyq3gfCBJpyA3GHEgpq6kbimgyI8vw=w1783-h1337-no" alt="img"><br><img src="/resources/2a7d22b0ddb34b2f8324aca799bd7f39.png" alt="1676213630730.png"></p><p>鲨鱼<br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8BkBaEJzARm5LSRX0KzdT3HsbBe_T67Neh8ZLBSTezll0y_8biyu25BmOBqdcNW4-NFq3N5fvPMGr-rpF22InjweBWkmqVcD7SLPrpOnXZ7I4GmednUda0zV7RFEi3zJa2ORRjCrsieq_jFYvhOoaJx=w1003-h1337-no" alt="img2"></p><p>不知道叫什么，但很漂亮<br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8A-TfoQjaVTbsCkswHu6v0gHI57KlJ3FNzQQPcEuApz1eXkzcWU33T1qy8yFZL9gEuraZ8V7nq7swyz5EJ8yJs3kmlubB0z1FoYswjgluQ8vxpjMbf5NVhb8rUKgcKTVgNg7mUH4o8yCmPuniIGzZfQ=w1783-h1337-no" alt="img3"></p><p>同样很漂亮的水母，旁边有卖无毒无电可家养的小水母，吾辈都考虑过要不要买，真的很漂亮<br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8CoBHefZD8xnKuY5tbtiFpGBD-_hCehimB83r5vVFufEZ-Lr_qFsfkAhWJP_ZoESSvKEP0mMQKCxSJP33F-Iz86Zk2CRnveamDzOGCMCUtdn5KFvgQSxFtLxJfRnDbvcd79kd7yn-9ktWscJbPXZq7W=w1003-h1337-no" alt="img4"></p><p>被卡住的乌龟<br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8Cn1BDbU01X1k6gAwPd1275cYs3FXto98SseDPMla56Wxj8T42d_jeOX6t6SyqWieTS0IG6KvGB_NW52kr_uSY9xKuS1jG-IdqfFQ4pR15ce_lzAaAP5Rp9KvEa_TVROip9wn5eTTkq8q7-VP82Xpsw=w1783-h1337-no" alt="img5"></p><p>这一幕骑着海豚的场景让吾辈有点想起海王<br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8BGywiOm_JtIsHF5oyFuuE1FDgExbcZKDQccsTrScff-eo2BHIjjlDuWKvfqBawA3hiCEYs0oup_BSGtxkbWVcTKAxF6uT8ekF1grt1L7UFl-kfMZX6Xa_UCW7dYz3neRJjgMnbnGkRXq5KAWxxRb-q=w1003-h1337-no" alt="img6"></p><blockquote><p><a href="https://photos.app.goo.gl/WCEqvMm9BVyCaZ8Y9">全部影集</a></p></blockquote><p>由于下周日的考试，周六不会再去太花时间的地方，应该下午会去国家博物馆看一眼。</p><p>目前日本 3 年旅游签证尚未开放（5 年的表示无法满足条件.JPG），希望今年五月份还有机会去日本玩一趟。</p>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="周报" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/%E5%91%A8%E6%8A%A5/"/>
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/tags/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="周报" scheme="https://blog.rxliuli.com/tags/%E5%91%A8%E6%8A%A5/"/>
    
  </entry>
  
  <entry>
    <title>mac 初上手的疑问与困惑</title>
    <link href="https://blog.rxliuli.com/p/88862964f94e4bdca5c97a5a2581898a/"/>
    <id>https://blog.rxliuli.com/p/88862964f94e4bdca5c97a5a2581898a/</id>
    <published>2023-02-09T04:35:04.178Z</published>
    <updated>2023-02-20T05:29:19.808Z</updated>
    
    <content type="html"><![CDATA[<h2 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h2><p>最近换了 m2 macbook，使用大概一周多了，作为一个 windows 长期使用者，截止目前为止遇到了很多问题和疑惑，有些解决了，有些目前仍未找到解决方法。</p><h2 id="如何添加字体"><a href="#如何添加字体" class="headerlink" title="如何添加字体"></a>如何添加字体</h2><p>之前日常的字体为<a href="https://github.com/be5invis/Sarasa-Gothic">更纱黑体</a>，它并不出色，但主要优势是以统一的风格支持简繁日英四种语言。<br>基本步骤和 windows 类似，下载 ttc 点击打开，等待验证通过即可。不过 mac 上这个过程会很慢很慢很慢以至于让我以为出现了 bug。</p><h2 id="如何外接显示屏关闭盖子不熄屏"><a href="#如何外接显示屏关闭盖子不熄屏" class="headerlink" title="如何外接显示屏关闭盖子不熄屏"></a>如何外接显示屏关闭盖子不熄屏</h2><p>虽然查了一堆答案，但实际上只要外接电源并将外部显示器设置为主显示器即可。</p><h2 id="如何调整鼠标反向过来"><a href="#如何调整鼠标反向过来" class="headerlink" title="如何调整鼠标反向过来"></a>如何调整鼠标反向过来</h2><p>最开始遇到的非常不习惯的地方，不过可以使用工具 <a href="https://pilotmoon.com/scrollreverser/">SCROLL REVERSER</a> 将之设置为反向。</p><h2 id="视频播放器"><a href="#视频播放器" class="headerlink" title="视频播放器"></a>视频播放器</h2><p>在 windows 上基本上都是使用 potplayer，强大而简单。mac 上似乎不支持，所以使用了一个开源工具 <a href="https://iina.io/">iina</a>，控制条稍微有点奇怪，但支持通过键盘控制进度倒也还好。<br><img src="/resources/f7a272132bee49a4aee730e1b75a233c.png" alt="1676612583239.png"></p><h2 id="音乐播放器"><a href="#音乐播放器" class="headerlink" title="音乐播放器"></a>音乐播放器</h2><p>虽然 iina 也支持播放音乐，但还是找了一个开源的音乐播放器 <a href="https://museeks.io/">museeks</a>。<br><img src="/resources/2b45e8d94c1b4dd89554f00fe02c870c.png" alt="1676374490873.png"></p><h2 id="mac-查看全局快捷键占用"><a href="#mac-查看全局快捷键占用" class="headerlink" title="mac 查看全局快捷键占用"></a>mac 查看全局快捷键占用</h2><p>没有找到真正可用的，后续通过 google + 提问查找 mac 的快捷键设置。</p><h2 id="如何使用其他输入法"><a href="#如何使用其他输入法" class="headerlink" title="如何使用其他输入法"></a>如何使用其他输入法</h2><p>直接使用系统的输入法下载即可，然后可以使用 <code>ctrl+space</code> 切换输入法。</p><blockquote><p>由于与 vscode 提示建议的快捷键冲突，修改为 <code>ctrl+shift+space</code>。</p></blockquote><h2 id="mac-上不使用-fn-就使用功能键"><a href="#mac-上不使用-fn-就使用功能键" class="headerlink" title="mac 上不使用 fn 就使用功能键"></a>mac 上不使用 fn 就使用功能键</h2><p>在系统设置 <strong>将 F1、F2 等键用作标准功能键</strong> 启用，ref: <a href="https://support.apple.com/zh-cn/HT204436">https://support.apple.com/zh-cn/HT204436</a><br><img src="/resources/09264df5dd584caaa619454af260e8c6.png" alt="1675933558696.png"></p><blockquote><p>实测 F5 刷新浏览器页面的快捷键并未生效。。。</p></blockquote><h2 id="剪切板历史管理"><a href="#剪切板历史管理" class="headerlink" title="剪切板历史管理"></a>剪切板历史管理</h2><p>使用开源程序 Maccy 管理即可，github: <a href="https://github.com/p0deje/Maccy">https://github.com/p0deje/Maccy</a></p><h2 id="mac-上禁用或修改系统的快捷键"><a href="#mac-上禁用或修改系统的快捷键" class="headerlink" title="mac 上禁用或修改系统的快捷键"></a>mac 上禁用或修改系统的快捷键</h2><p>首先是 ctrl+space，这是输入法的切换快捷键，在 快捷键 =&gt; 输入法 中可以修改<br><img src="/resources/8e484fa11c0746b0b7a062cdc7e62a0e.png" alt="1675940507249.png"></p><p>然后是 ctrl+command+space，默认是唤出 emoji 菜单，在 <strong>快捷键 =&gt; App 快捷键</strong>，修改为一个复杂的不常用的快捷键。<br><img src="/resources/1a15ccca47c74f5f9d006e362699b68f.png" alt="1675940701125.png"></p><p>禁用 command+alt+m 最小化窗口的快捷键，同样在 <strong>快捷键 =&gt; App 快捷键</strong>，修改为一个复杂的不常用的快捷键。<br><img src="/resources/8d4dbd63c48d43f8aac93d29b166fdd4.png" alt="1676524787758.png"></p><h2 id="如何关闭所有访达窗口"><a href="#如何关闭所有访达窗口" class="headerlink" title="如何关闭所有访达窗口"></a>如何关闭所有访达窗口</h2><p>在访达窗口按 option+command+w 关闭当前应用的所有窗口。</p><h2 id="如何使用类似-ctrl-home-x2F-ctrl-end-的快捷键跳转光标"><a href="#如何使用类似-ctrl-home-x2F-ctrl-end-的快捷键跳转光标" class="headerlink" title="如何使用类似 ctrl+home/ctrl+end 的快捷键跳转光标"></a>如何使用类似 ctrl+home/ctrl+end 的快捷键跳转光标</h2><p>默认情况下 mac 上移动光标的快捷键是</p><p>使用 command+home/end 跳转到行（段落）开头/行（段落）结尾<br>使用 option+left/right 跳转到上一个单词开头/下一个单词段落结尾<br>使用 command+top/bottom 跳转到文本开始/文本结尾（vscode 中 command+bottom 似乎不生效）</p><p>以上按键都可以与 shift 配合使用。</p><h2 id="如何在应用关闭主窗口时从-dock-栏隐藏"><a href="#如何在应用关闭主窗口时从-dock-栏隐藏" class="headerlink" title="如何在应用关闭主窗口时从 dock 栏隐藏"></a>如何在应用关闭主窗口时从 dock 栏隐藏</h2><p>这取决于应用是否支持该行为，例如 ssr 支持关闭窗口后最小化到右上角，但 proxifier 就不支持，必须在 dock 栏占一个位置。</p><h2 id="配置终端命令行提示"><a href="#配置终端命令行提示" class="headerlink" title="配置终端命令行提示"></a>配置终端命令行提示</h2><p>使用 <a href="https://iterm2.com/index.html">iterm2</a> 和 <a href="https://github.com/ohmyzsh/ohmyzsh">oh-my-zsh</a> 即可。</p><h2 id="proxifier-mac-激活码"><a href="#proxifier-mac-激活码" class="headerlink" title="proxifier mac 激活码"></a>proxifier mac 激活码</h2><p>不想在 mac 上再买一次 proxifier，所以使用破解，注册码 <code>3CWNN-WYTP4-SD83W-ASDFR-84KEA</code>，ref: <a href="https://www.cnblogs.com/itachilee/p/14202469.html">https://www.cnblogs.com/itachilee/p/14202469.html</a></p><h2 id="vscode-中无法使用-Run-Script-的功能"><a href="#vscode-中无法使用-Run-Script-的功能" class="headerlink" title="vscode 中无法使用 Run Script 的功能"></a>vscode 中无法使用 Run Script 的功能</h2><p>错误 <code>The terminal process "/bin/zsh '-c', 'pnpm run dev'" failed to launch (exit code: 127).</code></p><p>安装 iter2 和 oh-my-zsh 后解决，奇怪的。</p><h2 id="git-pull-拉取代码时自动合并"><a href="#git-pull-拉取代码时自动合并" class="headerlink" title="git pull 拉取代码时自动合并"></a>git pull 拉取代码时自动合并</h2><p>目前使用 <code>git pull</code> 时总是会提示让输入 commit msg，但应该有配置可以禁用这个行为。</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">git config --global branch.autosetupmerge always<br>git config --global branch.autosetuprebase always<br></code></pre></td></tr></tbody></table></figure><p>ref: <a href="https://stackoverflow.com/questions/5480069/">https://stackoverflow.com/questions/5480069/</a></p><blockquote><p>未生效</p></blockquote><h2 id="vscode-切换标签页"><a href="#vscode-切换标签页" class="headerlink" title="vscode 切换标签页"></a>vscode 切换标签页</h2><p>好吧，idea 在 windows 平台上默认的 alt+left/right 与 macos 本身的光标跳转有冲突。只能使用以下快捷键缓解这个问题</p><ul><li>command+alt+left/right 在打开的文件中将光标后退/前进到下一个位置</li><li>ctrl+tab 切换标签页（显然，这个快捷键用起来不是特别好按）</li></ul><h2 id="finder"><a href="#finder" class="headerlink" title="finder"></a>finder</h2><ul><li><p>mac 中删除桌面上的图标 – 使用 command+退格键 即可删除选中的图标。</p></li><li><p>快速切换窗口 – 使用 ctrl+left/right 可以切换邻近的窗口，这对于开发时只需要使用常用的几个窗口非常有用快速。（恢复旧的类似于多窗口的行为，放弃类似于移动端一个应用覆盖屏幕的做法）</p></li><li><p>不显示隐藏文件<br><code>command+shift+.</code> 可以临时切换显示隐藏文件。</p><p>使用以下方法永久设置（似乎对浏览器出发的文件选择器未生效）</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">defaults write com.apple.finder AppleShowAllFiles -bool <span class="hljs-literal">true</span> <span class="hljs-comment"># 显示隐藏文件</span><br>defaults write com.apple.finder AppleShowAllFiles -bool <span class="hljs-literal">false</span> <span class="hljs-comment"># 不显示隐藏文件</span><br>killall Finder <span class="hljs-comment"># 重启 Finder</span><br></code></pre></td></tr></tbody></table></figure><p><img src="/resources/ecd77d020fb6423b82928c5deaf06c52.png" alt="1676374613271.png"></p></li><li><p>如何粘贴文件路径<br>有时候复制了一个文件路径，希望能快速在 finder 中打开，可以使用 <code>command+shift+g</code> 快捷键，然后粘贴路径即可。</p><p><img src="/resources/eea912d0e8a2470a9dbba03e9b965ff5.png" alt="1676374734148.png"></p></li></ul><h2 id="mac-不再提示权限请求"><a href="#mac-不再提示权限请求" class="headerlink" title="mac 不再提示权限请求"></a>mac 不再提示权限请求</h2><p>每次打开国产软件都会请求权限，但禁止后下次打开仍然会提醒，有办法像 android/浏览器 一样永久禁止指定软件的权限请求么？</p><p><img src="/resources/662b59a13ddc49cd87929a3a055c0e74.png" alt="1676338817475.png"></p><p>无法关闭，因为这是应用程序创建的窗口。</p><h2 id="沙盒工具使用什么"><a href="#沙盒工具使用什么" class="headerlink" title="沙盒工具使用什么"></a>沙盒工具使用什么</h2><p>Parallels 可以安装 windows，但 $80 实在是有点贵。</p><h2 id="如何转换-wav-cue-为-flac"><a href="#如何转换-wav-cue-为-flac" class="headerlink" title="如何转换 wav+cue 为 flac"></a>如何转换 wav+cue 为 flac</h2><p>使用 <a href="https://www.mediahuman.com/audio-converter/welcome.html">Medihuman Audio Converter</a> 即可，参考：<a href="https://www.reddit.com/r/audiophile/comments/s7ftf3/help_with_cue_splitter_program_for_mac/">https://www.reddit.com/r/audiophile/comments/s7ftf3/help_with_cue_splitter_program_for_mac/</a></p><h2 id="如何在-Finder-当前目录打开终端"><a href="#如何在-Finder-当前目录打开终端" class="headerlink" title="如何在 Finder 当前目录打开终端"></a>如何在 Finder 当前目录打开终端</h2><p>选中目录后，从 <strong>访达 =&gt; 服务 =&gt; New iTerm2 Window Here</strong> 即可。</p><p><img src="/resources/ba751c1a5f0c4b589c0ee2525612039c.png" alt="1676352594802.png"></p><blockquote><p>这其实和期望中的打开当前目录有所区别，而且也比较慢。</p></blockquote><p>好吧，其实右键菜单的二级菜单中也有。</p><p><img src="/resources/bf6285e69712475e840a7b5548004de6.png" alt="1676366846045.png"></p><p>打开 iTerm2 第一次会有两个终端，这看起来是个 bug。</p><h2 id="mac-按后缀修改默认打开程序"><a href="#mac-按后缀修改默认打开程序" class="headerlink" title="mac 按后缀修改默认打开程序"></a>mac 按后缀修改默认打开程序</h2><ol><li>在 Finder 中右键点击一个该类型的文件，调出菜单</li><li>在菜单中选择” 显示简介”(Get Info) 选项</li><li>在弹出的对话框中，展开” 打开方式”(Open With) 选项</li><li>选择你要改变的默认打开程序，并点击下方的” 全部更改…“(Change All)</li></ol><p><img src="/resources/943e7465c48e43f093e6fc3e5022dc01.png" alt="1676366713119.png"></p><p>选中打开应用程序时的 <strong>始终以此种方式打开</strong> 选项很迷惑，没想到是只针对这个文件的。<br><img src="/resources/64153840a5084456be9b0f5e78f106e4.png" alt="1676612397276.png"></p><h2 id="如何列出所有窗口切换"><a href="#如何列出所有窗口切换" class="headerlink" title="如何列出所有窗口切换"></a>如何列出所有窗口切换</h2><p>mac 的 command+tab 只能切换应用，但同一个应用中的多个窗口则无法切换。<br>使用同一应用切换多个窗口时，需要使用 command+~ 快捷键。<br>列出所有窗口可以使用 ctrl+top 快捷键，但无法使用快捷键切换，必须右手从鼠标上移动到键盘再移动回鼠标太反直觉了，而且大小不一很奇怪。</p><p>使用 <a href="https://github.com/lwouis/alt-tab-macos">alt-tab</a> 可以恢复类似于 windows 的行为。<br><img src="/resources/6a9735ba560f48bb913d8fed5171aa17.png" alt="1676374370548.png"></p><h2 id="重命名"><a href="#重命名" class="headerlink" title="重命名"></a>重命名</h2><p>选中文件后按下 Enter 重命名，或者右键菜单中选择 Rename。</p><h2 id="禁用-chrome-里的右键菜单"><a href="#禁用-chrome-里的右键菜单" class="headerlink" title="禁用 chrome 里的右键菜单"></a>禁用 chrome 里的右键菜单</h2><p>默认情况下 chrome 会显示几个 mac 的集成右键菜单项，它们大部分时候并不实用，需要禁用。<br><img src="/resources/0b5bcac070ee4320acb5adc48dfab6e7.png" alt="1676515401808.png"><br>嗯，看起来这个问题似乎是不可解决的，这真的很糟糕。ref: <a href="https://superuser.com/questions/1012292/">https://superuser.com/questions/1012292/</a></p><h2 id="禁止按住-alt-会输入特殊字符"><a href="#禁止按住-alt-会输入特殊字符" class="headerlink" title="禁止按住 alt 会输入特殊字符"></a>禁止按住 alt 会输入特殊字符</h2><p>遗憾的是，这个问题似乎同样无法解决，这是 mac 内置输入法的行为且找不到设置修改。</p><h2 id="修改在输入中光标移动为-windows-的快捷键"><a href="#修改在输入中光标移动为-windows-的快捷键" class="headerlink" title="修改在输入中光标移动为 windows 的快捷键"></a>修改在输入中光标移动为 windows 的快捷键</h2><p>mac 上的移动光标快捷键可能很好，但显然与 windows 上有相当大的差异。<br>在 windows 中一般使用以下键来移动光标：</p><ul><li>home/end 跳转到行首/行尾</li><li>ctrl+home/end 跳转到文本首/文本尾</li><li>ctrl+left/right 跳转到单词首/单词尾</li></ul><p>以上按键都可以与 shift 配合使用。</p><p>可以通过 <a href="https://karabiner-elements.pqrs.org/">Karabiner-Elements</a> 配置全局键盘映射可以缓解这个问题。<br><img src="/resources/8fea00bb34c743939d69be7272208488.png" alt="1676608991086.png"></p><h2 id="finder-如何剪切文件"><a href="#finder-如何剪切文件" class="headerlink" title="finder 如何剪切文件"></a>finder 如何剪切文件</h2><p>好吧，它必须使用 command+c 然后通过 command+option+v 来移动文件，这是 mac only，甚至 mac 上的其他程序都支持 command+x。</p><p>第三方增强工具 XtraFinder 并不支持 m1，ref: <a href="https://www.zhihu.com/question/19579070">https://www.zhihu.com/question/19579070</a></p><h2 id="如何使用快捷键新建访达窗口"><a href="#如何使用快捷键新建访达窗口" class="headerlink" title="如何使用快捷键新建访达窗口"></a>如何使用快捷键新建访达窗口</h2><p>暂未处理</p><h2 id="如何录制-gif"><a href="#如何录制-gif" class="headerlink" title="如何录制 gif"></a>如何录制 gif</h2><p>使用开源工具 <a href="https://getkap.co/">kap</a> 替代 windows 中的 <a href="https://www.screentogif.com/">ScreenToGif</a>，不支持裁剪和缩放时间轴但基本能用（尤其是选择应用窗口的功能，屏幕录制相关工具不支持实在是太蠢）。</p><h2 id="如何从第三方下载-dmg-文件"><a href="#如何从第三方下载-dmg-文件" class="headerlink" title="如何从第三方下载 dmg 文件"></a>如何从第三方下载 dmg 文件</h2><p>暂未处理</p><h2 id="如何杀死特定进程"><a href="#如何杀死特定进程" class="headerlink" title="如何杀死特定进程"></a>如何杀死特定进程</h2><p>有时某个后台程序卡死需要重启，但活动监视器似乎无法右键杀死一个进程。<br>使用 linux 命令 ps + kill -9</p>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="其他" scheme="https://blog.rxliuli.com/categories/%E5%85%B6%E4%BB%96/"/>
    
    <category term="Mac" scheme="https://blog.rxliuli.com/categories/%E5%85%B6%E4%BB%96/Mac/"/>
    
    
    <category term="mac" scheme="https://blog.rxliuli.com/tags/mac/"/>
    
  </entry>
  
  <entry>
    <title>周报 2023-02-05</title>
    <link href="https://blog.rxliuli.com/p/0810f80fd8144e71b146fe4002aad183/"/>
    <id>https://blog.rxliuli.com/p/0810f80fd8144e71b146fe4002aad183/</id>
    <published>2023-02-05T11:19:54.612Z</published>
    <updated>2023-02-12T15:48:04.693Z</updated>
    
    <content type="html"><![CDATA[<h2 id="出门"><a href="#出门" class="headerlink" title="出门"></a>出门</h2><p>自上周滚回北京已经上班一周了，这两周的周六去了颐和园、故宫与天安门这些地方去玩了。虽然是北京非常有名的地方，但实际上并没有太大的感觉，只能说与想象中的地方有所差距。不过吾辈还是要出去玩，上半年预计每周六都会出去玩，可能近的主要是在北京市内，远一点会去郊区之类的地方，这也是寻求改变的一种方式。<br>下面是一些拍的照片</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8AsVfH7C2VQ8sNyKJpI32eV6B6-lMnQTBy86P8bXXvc-02IYtUawHorV2ZxsUKfGgRU5Y9MVWYWrpgShPnvgKBhq-rvvinKKSxYuwsG74tDr3B19-3SLOahiVbVlBrItSzK580vO_p0ja2-_j_pZhl1=w1783-h1337-no" alt="颐和园主要建筑群"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8Ahc5T_a58tiPhxXdyDXklq0IMGR5yGl8-QYWSRPU5FgFIC41yG-jS2kX6Fpg0IMQG4UdlwetLUJ_BbKV0wDn7jXSxwG6SzWVtDtNT7VrasxcbTF1HsENtqI-ovnW12th3b6Wox4y30MSKUPleEu1ok=w1783-h1337-no" alt="故宫太和殿"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AMWts8BI0M7qXjLOvzJCe_GCKHhOfiiV8KgCCm4d6UJtTa3_byqtt6YcABPseC13S3fhWFQEhE3XKBGIRfjf5trgcIH_7MI6Jo_TexEXfiFVWjAcPm4cbsXGNntwLzC9GD9e2VCYfgoUIO4gLw5uD-ePKXxV=w1783-h1337-no" alt="天安门"></p><p>Google Photo 照片集</p><ul><li><a href="https://photos.app.goo.gl/9m74qinKPnDSP4Hi9">北京颐和园</a></li><li><a href="https://photos.app.goo.gl/zpjvkRp9U2ZKUQXF7">故宫与天安门</a></li></ul><blockquote><p>预计下周六去水族馆和动物园玩，有认识的推友可以一起出来玩顺便见个面。</p></blockquote><h2 id="签证"><a href="#签证" class="headerlink" title="签证"></a>签证</h2><p>目前主要正在着手处理的一件事，虽然目前日本的 3 年旅游签证并未开放，但所需要的资料繁多，提前准备总是没有错的。而且，也希望今年 5 月份至少去一次感受一下真实的样子，后续做决定可能有更多的参考依据。</p><p><img src="/resources/f6da6c3fb3ff4039a7fd3b2a97531ecc.png" alt="1675596831512.png"></p><p>考虑到可能会使用到，也在申请北京市居住证，不过已经失败了两次，只能说尽量不要与中介签合同，这会让资料审核变得很烦人。</p><blockquote><p>见鬼，都 2023 年了，这些人为什么还非要纸质版的资料，拍成照片和将照片打印出来有什么区别么？</p></blockquote><h2 id="日语"><a href="#日语" class="headerlink" title="日语"></a>日语</h2><p>目前，正在复习中，距离 02-19 的考试还有 2 周，过了这个门槛之后后面应该会走的更容易一点吧 ٩(๑•̀ω•́๑)۶<br><strong>今は復習しています、私は頑張ってください！</strong></p><h2 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h2><p>最近没有任何积极开发任何社区项目，只是为 joplin-search-integration 添加 metagar 搜索引擎的集成。</p><p><img src="https://user-images.githubusercontent.com/24560368/216649515-57e6cb7a-39a3-4fb5-ba58-252fc087408b.png" alt="metagar"></p><h2 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h2><p>除了一直在追的《别当哥哥了》，最近还开始追了一部《转生王女与天才千金的魔法革命》，是“你给我百合，我就给你钱”的延申，虽然剧情不怎么样，不过百合只要可爱就好了，不是么？</p><p><img src="/resources/a29192174e2f4614bed98fca8775c6e5.png" alt="1675597896625.png"></p><p>话说回来，另一部尝试看过的《为了养老金去异世界存八万金》则是看不下去，剧情逻辑感人，在第二集女主角作为一个普通人轻易就与军事基地的军官做了交易的情节实在降智，实在无法忍受遂弃坑。</p><h2 id="galgame"><a href="#galgame" class="headerlink" title="galgame"></a>galgame</h2><p>上周日稍微尝试了一下乙女游戏《我的超级现充生活》，这个游戏是社群中 CodeHz 推荐给吾辈的，虽然吾辈之前从未玩过乙女类游戏，但之前看过《转生恶役只好拔除破灭旗标》动画之后对这类游戏倒也有一个简单的认识，这次尝试也算是入了一个新类型的坑。</p>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="周报" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/%E5%91%A8%E6%8A%A5/"/>
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/tags/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="周报" scheme="https://blog.rxliuli.com/tags/%E5%91%A8%E6%8A%A5/"/>
    
  </entry>
  
  <entry>
    <title>过年、亲戚与面子</title>
    <link href="https://blog.rxliuli.com/p/fbc92423364d486c9ad7f3ebe30f14a6/"/>
    <id>https://blog.rxliuli.com/p/fbc92423364d486c9ad7f3ebe30f14a6/</id>
    <published>2023-01-26T00:13:47.361Z</published>
    <updated>2023-01-26T02:05:19.908Z</updated>
    
    <content type="html"><![CDATA[<h2 id="缘由"><a href="#缘由" class="headerlink" title="缘由"></a>缘由</h2><p>今年春节回来有几天，家乡身处北方农村，到昨天为止吾辈已经难以忍受家里这些鸟事，今天打算就回北京了。<br>曾经，吾辈讨厌复杂的人际关系而转向了计算机，相比于人与人之间的模糊与暧昧不清，计算机要直白的多，对就是对，错就是错，即便是老板提出了“根据手机壳改变应用程序背景颜色”这种不合理的需求也可以拒绝掉，就像 1 + 1 不可能等于 3 一样。</p><h2 id="工作怎么样？收入多少钱？"><a href="#工作怎么样？收入多少钱？" class="headerlink" title="工作怎么样？收入多少钱？"></a>工作怎么样？收入多少钱？</h2><p>基本上，每一个人见到面的亲戚的前 3 句话必然会问这个，很烦人，好像是为了评估猪肉的价格来判断应该搭配什么小菜一样。有些人会死皮赖脸的追问和猜测，这就更加烦人了。<br>对比，会产生羡慕与嫉妒，更会让其他的家长自学生时代之后，再次说出“别人家的孩子”，但他们对“别人家的家长”缄口不提。吾辈嫌恶这种对比，也讨厌这一切。<br>这也正是相比于大人吾辈更喜欢小孩子的原因之一，他们心思很单纯和简单，不会有复杂的人际关系，好恶都可以直接说出来。</p><h2 id="有女朋友了么？给你介绍个对象吧"><a href="#有女朋友了么？给你介绍个对象吧" class="headerlink" title="有女朋友了么？给你介绍个对象吧"></a>有女朋友了么？给你介绍个对象吧</h2><p>这是紧接着上面的问题的问下来的，总想着让人早点结婚生子，早早的定下一切。很多人仍然认为结婚生育应该尽早，对于现在养育小孩更没有什么概念。让子女再走一遍自己的路，除了满足父母的期望之外，有什么意义呢？<br>说起结婚，在上一篇也提到过，两个表哥去年结婚，另一个堂哥今年迫于压力也开始相亲了。结婚意味着什么？结婚在现在的吾辈看来就是意味着不自由，意味着很大的一份责任，意味着在很长一段时间内都要与另一个人生活在一起，意味着在许多事情上必须兼顾另一个人，意味着很难再有太多自己的时间。。。<br>生育，这是另一个吾辈从来没有认真考虑的事情，现在吾辈的能力完全不足以改变什么。现在生育，小孩子小时候或许可以自己养育，但长大之后呢？上学怎么办？回老家农村上学？<br>已经过去 12 年了，亲戚家的一个小孩现在接受的教育和吾辈曾经接受的没有差别。每天早上 6 点起床，上完夜自习就 8 点半了，一次 12 天连轴转，996 社畜听到都直呼内行。</p><h2 id="祖宗之法不可变"><a href="#祖宗之法不可变" class="headerlink" title="祖宗之法不可变"></a>祖宗之法不可变</h2><p>是的，都 2202 年了，你没听错，现在上一辈的人还在说祖训，还在说要将辈分酒桌文化传承下去。一群不认识的人，一个个的都自称叔了，简直是<strong>无中生叔</strong>。<br>说什么是一个根，说什么血浓于水，但吾辈真的不在乎也不喜欢他们。<br>有些人自身无法改变命运，还要嘲笑别人的努力与尝试。曾经童话中的寓言，现在已然成为现实。</p><h2 id="面子"><a href="#面子" class="headerlink" title="面子"></a>面子</h2><p>在农村，面子是个很奇怪的东西，明明大部分人都没有钱，却还是为了复杂的面子而做出许多现在看来匪夷所思的事情。<br>即便今年因为疫情没有赚到太多的钱，过年也要大操大办，买很多吃的、年货（走亲戚带的饮料）、烟花，吃饭时还很浪费，不管是食物还是时间，如果想指出这一点，他们会用<strong>这就是农村的习俗</strong>、<strong>家里就是这样的</strong>这些话搪塞过去，为自己的行为找到理由。</p><p>一些更常见的关于面子的事情</p><ul><li>大部分人都买车了，不买车就没有面子 – 来自父母</li><li>会喝酒的话，不喝酒就是不给面子 – 来自同辈人</li><li>单身的话，不结婚在农村被人看不起 – 来自父母</li></ul><p>尤其是喝酒，吾辈对之厌恶深重，尤其是爸爸本身有病还要喝酒。也有人想让吾辈学习喝酒，这样就可以帮爸爸挡酒了。但吾辈讨厌的不仅仅是爸爸喝酒，更是讨厌为了面子被强迫喝酒以及喝酒本身。不管是喝酒导致身体不舒服还是发酒疯，这种例子都有太多现成的了。吾辈才不会在他们画的圈中思考问题，万事只要一开头，就再也收不回去。只要喝过一次酒，后面就再难拒绝掉别人的劝酒。</p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>吾辈已经很清楚的认识到上一代人无法改变，但没想到新的一代人已经染上了旧习。洼地无法被改变，也只能逃离它了。</p>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="其他" scheme="https://blog.rxliuli.com/categories/%E5%85%B6%E4%BB%96/"/>
    
    <category term="杂谈" scheme="https://blog.rxliuli.com/categories/%E5%85%B6%E4%BB%96/%E6%9D%82%E8%B0%88/"/>
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/tags/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="杂谈" scheme="https://blog.rxliuli.com/tags/%E6%9D%82%E8%B0%88/"/>
    
  </entry>
  
  <entry>
    <title>周报 2023-01-22</title>
    <link href="https://blog.rxliuli.com/p/9472ef44b098409a90673b353db5acf8/"/>
    <id>https://blog.rxliuli.com/p/9472ef44b098409a90673b353db5acf8/</id>
    <published>2023-01-22T09:21:24.178Z</published>
    <updated>2023-02-05T11:45:30.679Z</updated>
    
    <content type="html"><![CDATA[<p>终于，过年了呢，今天是大年初一，无论如何，先祝大家农历新年快乐。[]~(￣ ▽ ￣)~*</p><p>家里今年真是少有的大团圆了，爸爸妈妈妹妹，堂哥表哥以及各种亲戚今年都回来了，也预示着可能是麻烦的一年。</p><h2 id="年货"><a href="#年货" class="headerlink" title="年货"></a>年货</h2><p>好吧，不出意料地，身处农村的老家仍然不可免俗的购买了许多年货，许多生肉甚至很难想象可以在一个春节就能吃完。</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVEksMJMZ4E3W33-3gCDai-wJp6enyIdALU-4mKlNDQ21bHq-kS4Y1QJDTVD1FqI5tq-tooB4I-GTLzX8pMp_-LGU5XFAJSALPsXM14F3L7ews_iA-x2HXano1u6hakGC_o5vlaKOSKyVZm5c38KL8p=w733-h977-no" alt="猪肉"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXoYwv86eDA2STgu_iZyN2bllSAhB_60dzincNtB2qENR-XvkbMCUW-AEYf5W0Ci8zb8-hmuIVq47-9L1UtiI9yl3ILCGgKmibtOHziEXDBIBjtJ9VialfvRUtjPFxCvfKIgl44pYdw6q-6A-zy7utP=w733-h977-no" alt="羊肉"></p><p>今天赶了庙会之后还买了一些童年回忆中的零食</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWb5495-EjoVY_X6sGexwQjA6Fu9_zBA2R3GRXsSgG5U0ZkppAmwQUHDtzxdM5jbozKHb0trHXBq0nKui4A5m5hYWVn4A3oQO3YQhGN74nYtFQk8QDscoVyjkGL8C_ehLWouOkLr7DokYvE62wbOsrx=w733-h977-no" alt="零食 1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXkXPKJrgHvIxV2WfawsZp7jIodSpZ2M3kzmtEACZPer62EogUO2LXayxYpGisRGyqB_NXNhR53MQZaMkTJte7Gq_UxMKeMVqzMM09LNkZ8CxlfjKLIMSuffE_jw0uTH5EDSlPdBiIMcVkfY0JVUM9q=w733-h977-no" alt="零食 2"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXW1CXJVuFFs7b7jKDLCSNsXgR1wIBnlfRnxDObR52hMXZERJDklmG95vf4Sq7ABZhlt7lH_ngcFtFfypOfCBQYeKRnNUSXcP5t2ddLZDdSNkW3twtEE4MJIQXgDDdo_w-DmwtYnVjulQ05hwqpPmjr=w733-h977-no" alt="零食 3"></p><h2 id="新年礼物"><a href="#新年礼物" class="headerlink" title="新年礼物"></a>新年礼物</h2><p>好吧，m2 macbook pro 终于出来了，windows arm 迟迟未见实质性进展，所以还是下定了转向 mac 的决心，在发售当天就买了。</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXrjqTBd4diW61Tbff1XPotM2X260BoeUqtU4r32pI1iMyCdW-TOgpIx5IGmeyxRijH413U90LGa9w0cc_Y0Fb7nTfyaapLV73PjgkYVUI9FStc5N97kupyf8tqCQJHdTUoD8pk5Sj14AnDvP8bJ6KI=w440-h977-no" alt="macbook"></p><p>不过，在第一次付费的时候却失败了，或许是因为支付宝从未见过吾辈花过这么一大笔钱，所以认为是诈骗行为，于是还不得不找人工客服解除限制，也是无语。</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWmMC1JKBHhguOBg8LG30LLC08XV7GMkd5nVj17KR1pPQEOGD48l6k1ZXK-BwzSoJnZQMv7iDicN6eYIpuF4SzIyjtXx1s6uvaWpZSb7fUTWAym5hyKgN71BISr5XEj8pJxJw-sDLSzzLfPiZtUsSEj=w440-h977-no" alt="支付"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXQTkMttM9W-VMFF1XRHbIc0Ajg5AGg2ETXZuxov3BZLQ9JbjAaRaeumnOkg5dPpQW3o1Tfla_F7zjn8-uizLX6ZeA_gHBJ3FVb3oYmqcop1khsARHYOERkW2-zmW-gRdolJ9MqpuE5cK7fDTtrRPhn=w440-h977-no" alt="支付"></p><h2 id="烟花与爆竹"><a href="#烟花与爆竹" class="headerlink" title="烟花与爆竹"></a>烟花与爆竹</h2><p>虽然今年村里的大喇叭仍然在喊着禁止燃放烟花，但显然今年大家的怒气值 max，并未起到任何实际作用。</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVSeF18m6yjjYee_1uOyQ17k_0-qAnWBDQAM03WmYaCWn3k5i4UyfxuyoXQmFlSUQGxgGZFvHbGTds2GU1j2d-GZAxa2_m5hEY53BIjjdUYNu75XAj8jtXFsrLzK31E7r3BSeCVXqwNBgKGyuM0bwl3=w733-h977-no" alt="爆竹"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXZrGMandohorFwpzbpUQupsMpJcADMUvLBClCjOa_o9xijHQ7j8i9wulrkhFp58rD7JiZRywC9eJqDR7foVGVPgbOeXhReZ-IdaKqN7KU0skcYXsVZS4y-trirHumAJ-yZ4AWWT63Hre2ealCm3DXy=w1303-h977-no" alt="燃放过后"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXZGXJyQrG_15OMO4BjWlkk4Ypw22z2u1q34RiPJtzLPYY7ekGFT32sz_dvGHKZhoPprHZ5u0KENY4tT43Yfgc7v5RxsS_AcE7rqZwqs3PHOTiFaOdm-cl90RiejobTtxDRg6-HHdilTe88XZTWeoB7=w1528-h978-no" alt="烟花"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXkIJrV_H1sEZtS0FWLVjKgu_ws0dmBtpoYrBLDajcnNI7lPds3sGjFZYA1xJ_lsMmx2TOkxHqzbJ22UNSbR-DYf3Kco6KhGRQf2aKkur4-RiJqeFGTju08ShAakVctZL2KbaeikAe3VuzMZ5WdLDc2=w1078-h977-no" alt="烟花"></p><p>不过相比于大的烟花和爆竹，吾辈还是更喜欢小小的电光花，很容易让吾辈想起动画中的场景，夏天、夜晚、河边总是会出现这个东西呢。</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXQ1ZpK5LiZXaASjywr7SNLJPxfD8X1H0BdOVt-u8qG9E_vyMEWp4f-KCr4Xbnc1XaP0oehEM2g-tncixtN743g9M18LYsjri4TFarPIamhSLd3IcdYj_3SDId5Jqr7LQf9x51tg9VxZArP9sk1l8jd=w733-h977-no" alt="电光花"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVZTeVYShw8XjXWpjR5Z2XsXnzqL1fGnd0ZhZjjzZ868D3jDz5Rk2f_Sxgh0PJCzXiPLHnmbhbtoWNcyD9-Hle-4QAWYOr7h7bZzc0SbKJSpZnIFD7J98zAo-h8a7k8wIeEeNcNC3auQnYinwBu8yJa=w733-h977-no" alt="电光花"></p><p>动画中的效果</p><p><img src="/resources/641cd6cd000241d78d188b0b0da9f6e7.png" alt="电光花"></p><p>家里的夜空，虽然没有小时候记忆中那么通透了，但还是比大城市的夜空更好，还能依稀的看到一些星星。</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEU8BSUTHT6KDrXn8DMJzu83221t6hUsakfF01vpB9nAbenPL7w87uXdAubmJOXYfEC8kHFltlJHWCB8Fcyqhuf4h9DrrwNoU_YT0VBe6R7CBAxSLyL-ZPjRHNx7q5m8gpG8eZYb1aCn2bU-6ZjA6zq2=w1303-h977-no" alt="夜空"></p><h2 id="结婚"><a href="#结婚" class="headerlink" title="结婚"></a>结婚</h2><p>好吧，表哥去年奉子成婚，堂哥去年还拒绝相亲，今年就转变了态度，父母的压力确实也有，但由于吾辈考虑前往日本，所以直接拒绝掉了。话虽如此，由于吾辈未曾有过全日制大学的经历，所以所有事情确实都变得更难就是了。</p><p>在表哥家里看到的积木，能花这么久拼积木也挺厉害的呢！</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEUtcG9UskzHI8f4I26BwwJ-dSiXy1yJEafryw90Qe6uC_0_k_3peBYmSdfmFdOVLNWG51Ck-nNndMbzCGXDh_sPpXH3pe8Bf8FTXfDDk0uN1qIDySieJpx3ufvERwoyW-Y3dHTJEb8W7OHsCMl4za80=w733-h977-no" alt="积木"></p><h2 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h2><p>看完了动画 <a href="https://zh.m.wikipedia.org/zh-hk/%E4%BA%BA%E9%A1%9E%E8%A1%B0%E9%80%80%E4%B9%8B%E5%BE%8C">人类衰退之后</a>，但其实没看懂在说什么，可能是没有吸引到吾辈的点吧。<br>新番则还在看 <a href="https://zh.m.wikipedia.org/zh-hk/%E5%88%AB%E5%BD%93%E6%AC%A7%E5%B0%BC%E9%85%B1%E4%BA%86%EF%BC%81">别当欧尼酱了！</a>，动画中的<strong>いもうと</strong>是最可爱的！</p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>还是希望新的一年能够做到自己想做的事，也祝愿大家也能这样吧。</p>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="周报" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/%E5%91%A8%E6%8A%A5/"/>
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/tags/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="周报" scheme="https://blog.rxliuli.com/tags/%E5%91%A8%E6%8A%A5/"/>
    
  </entry>
  
  <entry>
    <title>周报 2023-01-15</title>
    <link href="https://blog.rxliuli.com/p/d6d8c1b89ef448f39a085e2ad5718cef/"/>
    <id>https://blog.rxliuli.com/p/d6d8c1b89ef448f39a085e2ad5718cef/</id>
    <published>2023-01-15T04:14:04.429Z</published>
    <updated>2023-01-15T08:11:45.078Z</updated>
    
    <content type="html"><![CDATA[<p>好久不见的周报，希望 2023 新的一年，能有个新的开始。也能真正确定自己想做的各种事情，然后着手去做。</p><p>新的一年，吾辈在做什么呢？</p><h2 id="回家"><a href="#回家" class="headerlink" title="回家"></a>回家</h2><p>首先，由于国内的疫情躺平，今年春节终于能回老家了。不出所料的，春运的火车票一如既往的难买，虽然回去的票买到了，但却是凌晨 4 点的火车票。回来的票尚且在候补之中，实际什么时候能买到还没有着落。<br>不过 8 月份的时候，在北京和老家都没有封城的时候，吾辈请了一周年假回去了，当时认为疫情在国内还要持续很久，春节不再可能回去，所以单独回去了，没想到转瞬之间大饼就翻面了。</p><p>也来张迟来（或者早来）的新年祝福，祝福大家今年自己和家人都能平平安安。</p><p><img src="/resources/aad107b87fba49ec93333a8edae7e904.png" alt="NovelAI 生成兔年萌娘"></p><h2 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h2><p>今年的工作快结束了，绩效也在这周刚评定完。虽然吾辈对自己的去年非常不满意（个人自评 3.25），但最终还是得到一个不错的绩效评价。不管好坏，今年的工作也算是即将结束，期望明年真正在系统性解决问题上踏出更大的一步。</p><h2 id="出国"><a href="#出国" class="headerlink" title="出国"></a>出国</h2><p>在 2022 年的大封城之后，吾辈对国内当前的状况不满已经达到下限，对长期发展也不再有信心。在此之前，虽然对国内互联网的封闭和混乱不满意，但也还在容忍度之内。再加上至今为止已经工作了 5 年，之前吾辈努力的基本方法是<strong>但行好事，莫问前程</strong>，遇到什么好玩的就去尝试一下，不必考虑太多会有什么用。但最近一年这种方式不再真的有效，吾辈需要一种更好的方式，更有规划和目标去做事。怎么说呢，也需要新鲜感，所以期望换个大环境改变自己。</p><p>在下半年断断续续开始学习日语，日语在上周看完了《大家的日语》初级第一本，之后复习之前的内容，并准备二月份的 n5 考试。</p><p>出国这件事，由于相关的疑问非常多，也在上午做了一个视频咨询。确定了之前的一些重要问题，以及对某些刻板印象的疑问得到了回答，只能说，许多日本的刻板印象确实存在，尤其是工作方面在传统日企中，也有许多意想不到的地方也很奇怪。包括但不限于</p><ul><li>互联网整体上发展是落后的，外包是主流（在国内这很糟糕），行业收入与国内相比更平均，大约在 300w~2000w/year – 似乎只有 google 提供 2000w/year</li><li>大多数（包括互联网的）日企还是论资排辈，取决于年龄而非能力 – 这与国内非常不同，吾辈只是没想到互联网日企也是，外企似乎好很多</li><li>消费很高，但是收入中位数很低，大约家庭 400w/year，有福利但还是有点难以想象这是发达国家的平均水平 – 前半部分有所预期，但后者确实意外</li><li>人际关系界限感很强，不推崇个性，喜欢说话说半句 – 这点有所预期，其实还是感觉很麻烦，正是不想面对与人沟通之间的复杂性，所以才选择了计算机的</li><li>如果走留学的方式要花很多时间脱产，可能会花 5~6 年 – 这很糟糕，吾辈确实没有做好这个心理准备</li></ul><p>总的来说，这次咨询还是帮吾辈回答了许多疑问，也更多的了解了这种选择的得失。</p><p><img src="/resources/a09cc84fd7fa420d941ce7112a81c1aa.png" alt="来张日本的城市夜晚风景图，由 NovelAI 生成"></p><h2 id="读书"><a href="#读书" class="headerlink" title="读书"></a>读书</h2><p>上周末读完了 <a href="https://book.douban.com/subject/24851460/">历代经济变革得失</a>，一本从历史角度描述经济改革的书，其中许多事情从历史的角度来看确实有其周期性的规律，例如改革开放到现在逐渐闭关锁国，参考：<a href="/p/8d1d975302f44c54bafcd17f506a2e8a">读书笔记 历代经济变革得失</a>。</p><p><img src="/resources/4684f2a8e1eb4827959a23bfc0222134.png" alt="1673766780360.png"></p><p>奇怪的是，作者的名字吾辈总是和刘晓波弄混，更巧的是吾辈现在的一个同事在创业时和作者有过一段不愉快的经历。</p><h2 id="galgame"><a href="#galgame" class="headerlink" title="galgame"></a>galgame</h2><ul><li>supipara 1 通关</li></ul><p>好久没玩过校园日常类的 galgame 了，中二社的这部作品一直有所耳闻，之前也玩过 eden，甚至在圣诞节送了一份给朋友，但一直没有去玩 sppl，这周花了两个晚上通关了。之前看过被高度评价的 OP，和 ef 不同，没有令人震撼的瞬间（从空中走螺旋的楼梯下来），但与之相比更多体现了可爱的感觉。</p><!-- markdownlint-disable-next-line MD033 --><iframe width="560" height="315" src="https://www.youtube.com/embed/1w-dyYRksXo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe><p>吐槽役担当的主人公很有趣，女主角都非常有个性，身着女仆装的偶像青梅竹马学姐鸣海樱、神社的多重人格巫女学妹夕月红叶、预知未来的傲娇毒舌天使天野・安洁莉娜・萤、以及最可爱的能够实现任何愿望的魔女神代爱丽丝。</p><blockquote><p>白发红瞳确实有加成！咦，吾辈不是在说 QB 吧？</p></blockquote><p><img src="/resources/bd490a6790464eed8727259aaaaa0a81.png" alt="鸣海樱"><br><img src="/resources/eaeb6a9337264b888210c2db0c5caa46.png" alt="夕月红叶"><br><img src="/resources/f1f66b2ade024a69a21f1411f0df8f70.png" alt="天野・安洁莉娜・萤"><br><img src="/resources/a932bd8574ba4f46bd87a06ebc6cb6a9.png" alt="神代爱丽丝"></p><h2 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h2><ul><li>恋爱 flops</li></ul><p>1 月份了，补了一下上一季的新番，除了这部之外，还有几部没来得及补的，可能之后会有更多的时间吧。<br>说回《恋爱 flops》这部动画，如果让吾辈用一个词形容它的话，只能说<strong>逆天</strong>。玩梗数量之多，确实堪称文艺复兴。另一位网友的评价更是绝妙：<strong>“一封送给 galgame 的情书”</strong>。</p><p><img src="/resources/ce269e366a3c497eb0ffb108631e2e77.png" alt="1673770300740.png"></p>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="周报" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/%E5%91%A8%E6%8A%A5/"/>
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/tags/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="周报" scheme="https://blog.rxliuli.com/tags/%E5%91%A8%E6%8A%A5/"/>
    
    <category term="读书" scheme="https://blog.rxliuli.com/tags/%E8%AF%BB%E4%B9%A6/"/>
    
  </entry>
  
  <entry>
    <title>读书笔记 历代经济变革得失</title>
    <link href="https://blog.rxliuli.com/p/8d1d975302f44c54bafcd17f506a2e8a/"/>
    <id>https://blog.rxliuli.com/p/8d1d975302f44c54bafcd17f506a2e8a/</id>
    <published>2023-01-08T16:25:18.925Z</published>
    <updated>2023-01-15T07:12:09.599Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><a href="https://book.douban.com/subject/24851460/">豆瓣</a></p><h2 id="批注"><a href="#批注" class="headerlink" title="批注"></a>批注</h2><p>毛泽东：“百代都行秦政法”<br>不能让民众太富足、太有思想的潜意识却一直留存在了下来，最终变成了一种系统化的愚民政策<br>【批注】现在不也还是这样，奉行愚民政策，互联网的审查尤为甚之，疫情更是充分暴露了这一切。</p><hr><p>绝大多数的治国者把国家强大远远放在民众富足之前，强调“国强民安”，而不是“国强民富”，所谓“安”者，年份好的时候，有口饭吃，饥荒到来的时候，不饿死，这已是最大的善政。<br>【批注】好的时候赏口饭给你，不好的时候饿死也不管事。总的来说，都是不把人当人看。</p><hr><p>改革三战场：财政、货币和土地<br>中国人从来认为今不如古，前人比今人聪明。<br>【批注】所以一直在尝试证明古代的中国是世界最强。问题来了，如果今天相比于两千年前的古人还不如，那这么长的发展时间是都去喂狗了么？</p><hr><p>不过，后世的人们也都知道，所有推行计划经济的人无不以“均贫富”和实现社会公正为口号，而实际上都是为了加强集权以及扩充财政收入。<br>【批注】遗憾的是，不是所有人都知道这点，例如最近的 “共同富裕” 实际目的仍然是为了收割大户</p><hr><p>以轮船招商局为例：国营与民营的取舍<br>在后面的讲述中，我们将看到，在百年现代化历史上，先后出现过六次重要的“国进民退”事件，1884 年的轮船招商局事件乃是第一起。<br>【批注】第七起显然已经发生在了中国互联网企业，尤其是阿里巴巴被锤的都快不成人样了，从蚂蚁未能上市，到被迫 “共同富裕” 捐出 1000 亿，再到现在马老板远遁日本，无不说明了这一点。</p><hr><p>发展与公平：2013 年的双重困境<br>国家富强，与我何干？如果我的国家是全球第二或第一大经济体，可是，我买不起房、看不起病、上不起学，我的家园要被强拆，我的子女要喝毒奶粉，那么，强国的意义又在哪里？强国与利民本是相互依存的命题，当后者不至，前者自然暗淡。<br>【批注】这正是现代年轻人不婚不育的缘由，让人在受到对以后子女威胁时说出了 “我们是最后一代谢谢”。更早的也有人说过 “兴，百姓苦；亡，百姓苦。” 似乎东亚地区都面临着类似的问题，不过盲猜未来会再来一次计划生育，毕竟有着 “低人权优势” 嘛</p><hr><p>一个不容置疑的前提：“统一文化”是一切自由化改革的边界<br>生活于 21 世纪的中国人，大抵都已具备一定的现代意识，对专制独裁的厌恶及反对日渐成为社会常识。时至今日，民间呼吁推进法治化、维护司法独立、强化民主监督的声浪日渐高涨，决策层也不断释放正面信息，习近平总书记表示共产党愿意接受“最尖锐的批评”，要求“把权力关进笼子”，李克强总理更在就职新闻发布会上感慨“触及利益比触及灵魂还难”，并承诺“依宪治国”，“使明规则战胜潜规则”。这些都表明，中国的政治治理也许在未来有得到一定程度的改善的迹象。<br>【批注】遗憾的是，这个预言在十年之后的现在看是完全失败的，看不到改善的迹象。莫说把权利关进笼子里，这两位一个已然事实上称帝，号“庆丰”，另一位也未能以宪治国，甚至可能是修改宪法的帮凶。</p><hr><p>两个永恒性的主题：分权与均富<br>除兴盛规律之外，历朝历代的经济治理还有“先开放、后闭关”的规律，往往一开放就搞活，一搞活就失衡，一失衡就内乱，一内乱就闭关，一闭关就落后，一落后再开放，朝代更迭，轴心不变，循环往复，无休无止。<br>【批注】听起来现在像是走向闭关了，所有大型互联网企业都有政府参与了</p><hr><p>四股前所未见的新势力：互联网、非政府组织、企业家和自由知识分子<br>中国社会，政府的权力太大了，使富有的非统治者不能享有任何真正的安全。对任意征收的恐惧始终挥之不去。<br>【批注】别说富有的人了，疫情这几年下来，想离开这篇土地的又何止富人</p><hr><p>近十年来，民间出现了众多游离于体制之外、以自己的专业能力谋生的知识分子，越来越广阔的市场空间给予了他们生存的机会。以思想研究为己任的民间智库层出不穷。在博客和微博上，更是涌现出很多大胆的“意见领袖”。<br>【批注】遗憾的是，大多数都已经被批判为“公知”，更别提现在国内互联网的舆论管控了</p><hr>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="其他" scheme="https://blog.rxliuli.com/categories/%E5%85%B6%E4%BB%96/"/>
    
    <category term="读书" scheme="https://blog.rxliuli.com/categories/%E5%85%B6%E4%BB%96/%E8%AF%BB%E4%B9%A6/"/>
    
    
    <category term="读书" scheme="https://blog.rxliuli.com/tags/%E8%AF%BB%E4%B9%A6/"/>
    
  </entry>
  
  <entry>
    <title>重新发布 fs-extra 用以正确支持 esm/cjs 使用</title>
    <link href="https://blog.rxliuli.com/p/0e1fad3617514ced89c07959c8d8f52b/"/>
    <id>https://blog.rxliuli.com/p/0e1fad3617514ced89c07959c8d8f52b/</id>
    <published>2022-12-25T05:40:07.414Z</published>
    <updated>2022-12-25T06:19:59.898Z</updated>
    
    <content type="html"><![CDATA[<h2 id="动机"><a href="#动机" class="headerlink" title="动机"></a>动机</h2><p>自从更新 nodejs@18 并切换到 esm only 以来，许多库都已经被替换成支持 esm 导入，但其中 <a href="https://www.npmjs.com/package/fs-extra">fs-extra</a> 却一直没有正确的支持 esm 使用，也没有找到合适的替代品。在吾辈之前提出的 <a href="https://github.com/jprichardson/node-fs-extra/pull/986">一个 PR</a> 被否定之后，决定重新发布一个正确支持 esm 使用的 <a href="https://www.npmjs.com/package/fs-extra-unified">fs-extra-unified</a> 模块。</p><p>如果你还不知道 fs-extra 是什么，这里可以简单介绍一下：它是一个 nodejs 文件操作相关的工具库，用以完全替代 fs 模块，在 fs/promises 存在之前，它就已经将所有 fs 中的异步 callback 函数转换为了 Promise。同时提供了另外一些非常有用的工具函数以供使用，例如 <code>pathExists</code>、<code>remove</code>、<code>mkdirp</code>、<code>copy</code>。</p><p>例如删除一个临时目录之后然后重建它</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { remove, mkdirp } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs-extra'</span><br><span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'node:path'</span><br><span class="hljs-keyword">import</span> { fileURLToPath } <span class="hljs-keyword">from</span> <span class="hljs-string">'node:url'</span><br><br><span class="hljs-keyword">const</span> __filename = <span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>)<br><span class="hljs-keyword">const</span> __dirname = path.<span class="hljs-title function_">dirname</span>(__filename)<br><span class="hljs-keyword">const</span> tempPath = path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'.temp'</span>)<br><span class="hljs-keyword">await</span> <span class="hljs-title function_">remove</span>(tempPath)<br><span class="hljs-keyword">await</span> <span class="hljs-title function_">mkdirp</span>(tempPath)<br></code></pre></td></tr></tbody></table></figure><p>但在 esm 模块中，它目前并不能正确支持 ts 使用，例如上面那段代码只能在 cjs 模块中可以正常使用。在 esm 模块中，必须使用以下导入</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> fsExtra <span class="hljs-keyword">from</span> <span class="hljs-string">'fs-extra'</span><br><span class="hljs-keyword">const</span> { remove, mkdirp } = fsExtra<br></code></pre></td></tr></tbody></table></figure><p>即便 fs-extra@11 宣称已经支持 esm 了，但却是以另一个 entry <code>fs-extra/esm</code> 支持的，而且 ts 类型定义还尚未更新导致 ts 中实际上无法使用。例如上面的导入可以转换为以下导入</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { remove, mkdirp } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs-extra/esm'</span><br></code></pre></td></tr></tbody></table></figure><p>另外它还有另一个麻烦的问题，即不支持 fs 导出的函数，例如以下代码会报错</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { readFile } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs-extra/esm'</span><br><span class="hljs-keyword">import</span> { fileURLToPath } <span class="hljs-keyword">from</span> <span class="hljs-string">'node:url'</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">readFile</span>(<span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>), <span class="hljs-string">'utf-8'</span>))<br></code></pre></td></tr></tbody></table></figure><p>官方声称只会 <code>fs-extra/esm</code> 只会导出独有的一些函数，fs 原本导出的函数需要使用 <code>fs/promises</code> 模块，需要修改为以下导入</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { readFile } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs/promises'</span><br><span class="hljs-keyword">import</span> { fileURLToPath } <span class="hljs-keyword">from</span> <span class="hljs-string">'node:url'</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">readFile</span>(<span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>), <span class="hljs-string">'utf-8'</span>))<br></code></pre></td></tr></tbody></table></figure><p>好的，看起来 esm/ts 支持就是二等公民，让吾辈总结一下已知的问题</p><ol><li>默认的 <code>fs-extra</code> entry 不支持 esm 命名导入</li><li><code>fs-extra/esm</code> 不支持 fs 的原有函数</li><li><code>fs-extra/esm</code> 没有正确声明 ts 类型定义</li><li>cjs/esm 使用的行为不同</li></ol><p>正是因为它是常用的工具库，所以吾辈才重新发布它。</p><h2 id="重新发布"><a href="#重新发布" class="headerlink" title="重新发布"></a>重新发布</h2><p>基本思路很简单，通过脚本扫描 <code>fs-extra</code> 导出的模块，然后生成一个 esm 的 entry，最终在 package.json 的 <code>exports</code> 中正确声明，这样 esm/cjs 便在使用层面不再有差异。</p><h3 id="期望的结果"><a href="#期望的结果" class="headerlink" title="期望的结果"></a>期望的结果</h3><ol><li><p>esm 支持命名导入和默认导入</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { readdir } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs-extra'</span><br><span class="hljs-keyword">import</span> fsExtra <span class="hljs-keyword">from</span> <span class="hljs-string">'fs-extra'</span><br><span class="hljs-keyword">import</span> { fileURLToPath } <span class="hljs-keyword">from</span> <span class="hljs-string">'url'</span><br><span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span><br><br><span class="hljs-keyword">const</span> __filename = <span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>)<br><span class="hljs-keyword">const</span> __dirname = path.<span class="hljs-title function_">dirname</span>(__filename)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">readdir</span>(__dirname))<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">await</span> fsExtra.<span class="hljs-title function_">readdir</span>(__dirname))<br></code></pre></td></tr></tbody></table></figure></li><li><p>cjs 支持命名导入和默认导入</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { readdir } <span class="hljs-keyword">from</span> <span class="hljs-string">'fs-extra'</span><br><span class="hljs-keyword">import</span> fsExtra <span class="hljs-keyword">from</span> <span class="hljs-string">'fs-extra'</span><br><span class="hljs-keyword">const</span> { <span class="hljs-attr">readdir</span>: readdirCjs } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs-extra'</span>)<br><span class="hljs-keyword">const</span> fsExtraCjs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs-extra'</span>)<br>;(<span class="hljs-keyword">async</span> () =&gt; {<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">readdir</span>(__dirname))<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">readdirCjs</span>(__dirname))<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">await</span> fsExtra.<span class="hljs-title function_">readdir</span>(__dirname))<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">await</span> fsExtraCjs.<span class="hljs-title function_">readdir</span>(__dirname))<br>})()<br></code></pre></td></tr></tbody></table></figure></li><li><p>正确支持 ts 使用，esm 不再使用单独的 entry</p></li></ol><h3 id="最终的实现方法"><a href="#最终的实现方法" class="headerlink" title="最终的实现方法"></a>最终的实现方法</h3><ol><li><p>使用生成脚本生成 esm entry</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> fsExtra = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./lib/index'</span>)<br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)<br><span class="hljs-keyword">const</span> { difference } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'lodash'</span>)<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">scan</span>(<span class="hljs-params"></span>) {<br>  <span class="hljs-keyword">const</span> excludes = [<br>    <span class="hljs-string">'FileReadStream'</span>,<br>    <span class="hljs-string">'FileWriteStream'</span>,<br>    <span class="hljs-string">'_toUnixTimestamp'</span>,<br>    <span class="hljs-string">'F_OK'</span>,<br>    <span class="hljs-string">'R_OK'</span>,<br>    <span class="hljs-string">'W_OK'</span>,<br>    <span class="hljs-string">'X_OK'</span>,<br>    <span class="hljs-string">'gracefulify'</span>,<br>  ]<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">difference</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(fsExtra), excludes)<br>}<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">list</span>) {<br>  <span class="hljs-keyword">return</span> (<br>    <span class="hljs-string">"import fsExtra from './index'\n"</span> +<br>    list.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="hljs-string">`export const <span class="hljs-subst">${item}</span> = fsExtra.<span class="hljs-subst">${item}</span>\n`</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>) +<br>    <span class="hljs-string">`export default {<span class="hljs-subst">${list</span></span><br><span class="hljs-subst"><span class="hljs-string">      .map((item) =&gt; <span class="hljs-string">`<span class="hljs-subst">${item}</span>: fsExtra.<span class="hljs-subst">${item}</span>,`</span>)</span></span><br><span class="hljs-subst"><span class="hljs-string">      .join(<span class="hljs-string">''</span>)}</span>}`</span><br>  )<br>}<br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {<br>  <span class="hljs-keyword">const</span> list = <span class="hljs-title function_">scan</span>()<br>  <span class="hljs-keyword">const</span> code = <span class="hljs-title function_">generate</span>(list)<br>  <span class="hljs-keyword">await</span> fsExtra.<span class="hljs-title function_">writeFile</span>(path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'lib/esm.mjs'</span>), code)<br>}<br><br><span class="hljs-title function_">build</span>()<br></code></pre></td></tr></tbody></table></figure></li><li><p>然后添加 <code>@types/fs-extra</code> 的依赖，在 <code>index.d.ts</code> 中重新导出</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'fs-extra'</span><br></code></pre></td></tr></tbody></table></figure></li><li><p>在 package.json 中声明正确的 <code>exports/types</code> 字段</p><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">{</span><br>  <span class="hljs-attr">"exports"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><br>    <span class="hljs-attr">"."</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><br>      <span class="hljs-attr">"import"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./lib/esm.mjs"</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">"require"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./lib/index.js"</span><br>    <span class="hljs-punctuation">}</span><br>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">"types"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./index.d.ts"</span><br><span class="hljs-punctuation">}</span><br></code></pre></td></tr></tbody></table></figure></li></ol><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>如果 fs-extra 最终正确支持 esm/ts 使用，吾辈也将会删除这个模块，避免造成麻烦，不过在此之前，吾辈还是只能先使用这个模块。</p><blockquote><p>GitHub: <a href="https://github.com/rxliuli/node-fs-extra">https://github.com/rxliuli/node-fs-extra</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="前端" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="工具库" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/%E5%B7%A5%E5%85%B7%E5%BA%93/"/>
    
    
    <category term="开源" scheme="https://blog.rxliuli.com/tags/%E5%BC%80%E6%BA%90/"/>
    
    <category term="javascript" scheme="https://blog.rxliuli.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>出一些用不到的东西</title>
    <link href="https://blog.rxliuli.com/p/0f2182e4368c4195be5f7699fa62e026/"/>
    <id>https://blog.rxliuli.com/p/0f2182e4368c4195be5f7699fa62e026/</id>
    <published>2022-12-17T05:27:21.925Z</published>
    <updated>2023-01-02T12:14:05.529Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>一些用不到的东西想出掉，所以在这里发一下。</p><ul><li>走闲鱼，有意向请使用 mail/telegram 联系，吾辈会上咸鱼挂上去发链接</li><li>不讲价，浪费的时间可能很容易超过物品的价值</li><li>不包邮，所以如果是书的话最好不要只买一本</li></ul><h2 id="电子垃圾"><a href="#电子垃圾" class="headerlink" title="电子垃圾"></a>电子垃圾</h2><h3 id="x-Wacom-数位板-CTL672"><a href="#x-Wacom-数位板-CTL672" class="headerlink" title="[x] Wacom 数位板 CTL672"></a>[x] Wacom 数位板 CTL672</h3><p>好吧，之前想替代纸笔处理流程图之类的事情，后来证明是吾辈想多了。300 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEW9cXgVF4kWEt0XjOVK4zRrrTlYR_2H2vYgmqNfWoM1z6ruZkpH9vzkmIYvswSHLZMnA8GB56id_NyhFqFNNqL6PVGBNEpAG5GV9LURjmkFLiBjai1JGbg6lJDuvGNVvyuGNGLPc0AZG_zovV8L3X8L=w1783-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEUul85wYGXijKWa340sER-n3MjfGBGMKqscvTMxms96bgYpZY9B6LDB0x31wY2DCSuCT--QalGC8N3-2rRwApSoCqojAG6mGJ48H5hEAVuacTnU5TKOWLiXqa8bRWJY017NWjnfFFH6MgAO4x2FfT8x=w1783-h1337-no?authuser=0" alt="2"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEX5zJsnjLpuIIze6e4eZm74Ni_NQ_xPXBGNZXK-aiu5ji3BlSq6L6golzWnxA0Fj2g8w_6a7kOnymz6xjVicGbU_19vyhS5d0b2eT5IjRI1h4ycynAm0jLjE7e6YBd5Nu1Mpe4gei2NiwzjF3bSayRk=w1783-h1337-no?authuser=0" alt="3"></p><blockquote><p>淘宝链接: <a href="https://detail.tmall.com/item.htm?id=558799421450">https://detail.tmall.com/item.htm?id=558799421450</a></p></blockquote><h3 id="东方叠纸周边"><a href="#东方叠纸周边" class="headerlink" title="[ ] 东方叠纸周边"></a>[ ] 东方叠纸周边</h3><p>好吧，在一次东方漫展中买的，通电之后还算不错。30 出。</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWnh7yqh5EbNnN3RO8MK5M5mxIdmMNhsZQnhguNA9onYRFkJx4a1dXcJAh0JRTuDX5pcZTxDAEn-hV4jlxp2hBKmBVbJbLQ9NmNxDV8x6sj2qlBKvJGtCav5z2TttWd_dfPTfMYaReAfxJnzqLz_znt=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVGp5qWQnY2aY6A7kXr8ugv5cHNPvO6VXkDfbC_dsQkmgLE_QGs_g0v5A8PAoOvzm296L44hmqan47ekjgg7wsxSBSsqO88vXfOBjA36NMDfZADRSg5jtJ2WVyfN4St_TGXSpwdyujJyRMLbZBk1iXL=w1003-h1337-no?authuser=0" alt="2"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVdYYH_iwcUOuv2-EwnSW6teaJN-MYBwhnnqxmMAl4mHkxJPfIbAd1oUvt19rEigT6f5ZqOIOuS4I8iKwW7ayKssrV5nrkhqW9aqNIcORIZ66XC0W7RmSP3HwBbl5Ek9sDOxNW22RKuT3kl1hrf9VCW=w540-h720-no?authuser=0" alt="3"></p><h3 id="Kindle-Paperwhite4"><a href="#Kindle-Paperwhite4" class="headerlink" title="[ ] Kindle Paperwhite4"></a>[ ] Kindle Paperwhite4</h3><p>之前买的 kindle 想尝试电子书，后面换屏幕更大的 boox 了，吾辈没有太多便携的需求。755 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEUU8dgt_glJOU_hXn1afCq2DgBFWMZBEYqSNxcpN1pUWYvvqggcbklcV-FkBZiFDtjRmZp24O14FlXT_TERiqv87IfY3H1JCetV6Zan2yeHbkvj76LNar8KWCd4V2dd1urVWRhTrqeMYfiTwVwQiHVy=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWoUAUNQNTDAYYZChNN2Zqc4NzWm1DpdN_1PBG6w_tujfkuPSHcI8loLPSfohioVb2huH7yycvT2r_fUkxqSMYOdHpP6SH-4d8YTytyDij3Un99tTJEVG91ab5iAPDTTE0eVIfIcn78WYKMzwv1UIF5=w1003-h1337-no?authuser=0" alt="2"></p><h3 id="GPD-Pocket2-代"><a href="#GPD-Pocket2-代" class="headerlink" title="[ ] GPD Pocket2 代"></a>[ ] GPD Pocket2 代</h3><p>早前买的想着出去玩时或许可以使用，结果一年到头也没出去玩几次。2160 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWW6-dQ9bAIgKEHViqRXR2oXzM1c7xldGL1-IEnd3tI2PFJ2nVTdimz_D5zt68S8Y56g9F-6gpbyWE_syTKb-Tce-pMm20xwY99YdD-LHyiNMv-gS3JyFodn7BTsQcZ78ZbpXt78AfZL_KZheSeWjhR=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXrqbnSDSfqiNmtybKX4g16DG3r8prMSwCuvx8MnvWM0o8P-BQz6MJ2-miXIujwwainJARY2ZSEJYDcmaIEx2fBGPONYX3sm2E-DdJ91Q2Ok_1isxeg4MCGmpjEK61dG1hYJIzb-uX4ET1TwGJn2X4y=w1003-h1337-no?authuser=0" alt="2"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEUke9qjChU2HVUjZjhJS0lxMewYNFWI0dSN2GeyGU8bH-QhLORMw_w8YVLAPU3fn0jmuwxtBbKDGUaEuPhA2uj4o22XjSn1jT8MGp8y0cxfOAag4n_6o8b2QusTZn4L4u6u2sTZCCCxkDSlxxpVPO9y=w1003-h1337-no?authuser=0" alt="3"></p><blockquote><p>淘宝链接: <a href="https://detail.tmall.com/item.htm?id=592357039823">https://detail.tmall.com/item.htm?id=592357039823</a></p></blockquote><h3 id="英菲克-H1-硬盘盒子"><a href="#英菲克-H1-硬盘盒子" class="headerlink" title="[ ] 英菲克 H1 硬盘盒子"></a>[ ] 英菲克 H1 硬盘盒子</h3><p>之前买的硬盘盒，不过后来组台式机就空出来一个。65 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXbugIVWTIPKy1LF_9P_Cn0uPt4hHGzNCEinmocyQSlgYf6ydWssw4yTckNLp7p-CuRjQKSCFaMtVr5svD-ckuyuBNfiNbkpaGPGcc13wS06CdPoJJUm2Z8wG1DWtQCIhgbdeCJq8PG4gIgSZb3BNny=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVbKMwOsmiWWy6NllDGIeK2PTaWjOsbbRAgQZlxxtbpYp5nV1-GJ9SsWKXAEIK84pH0TGJWifLWof8Klv3HOFcwyoJzLSsh4dx06qRTH4KnkO-ZpWSTsO_cpkrUrkj-afLmfpf6q01OOLB6dqJplJdH=w1783-h1337-no?authuser=0" alt="2"></p><blockquote><p>淘宝链接: <a href="https://detail.tmall.com/item.htm?id=580593221126">https://detail.tmall.com/item.htm?id=580593221126</a></p></blockquote><h2 id="实体书"><a href="#实体书" class="headerlink" title="实体书"></a>实体书</h2><blockquote><p>由于转向电子书，所以之前的实体书大多都要出掉。<br>ps: 未出掉的书都已经寄回老家</p></blockquote><h3 id="x-出租女友-1-7"><a href="#x-出租女友-1-7" class="headerlink" title="[x] 出租女友 1-7"></a>[x] 出租女友 1-7</h3><p>之前在漫展上买的，56 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWajPcucpZX5XWvHq_RsYrBON952MQZo_Zh72BWsM32N73GjlvtCsq-esdya3lviqHV8APqYO5VAaEzHlGK1FpsCmFBOMZ07IsBrsE1GoKTY0ythGEIodccKtMXWi23fkETA1yq0-v_bQEF3gwOIPXh=w1783-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVqmykVlvnOGKYxqhmuIPrguYEJhymItHsSsctUv5wC2YpK6aX9JxPF21FmNQQT5MvEEygpXEga977UsPU9acO6uipOqP_45oDx2RrB_vFfQfoU3gkJfYFq_g0TCRv6yXdMijYNbABNCRF8DDTI9wXV=w1783-h1337-no?authuser=0" alt="2"></p><h3 id="x-神雕侠侣"><a href="#x-神雕侠侣" class="headerlink" title="[x] 神雕侠侣"></a>[x] 神雕侠侣</h3><p>39 出。</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVrwOMyHAb4l5pJh3-v_Iy08MZCPUEErBrRYsJQ5lp8OhMXqew10pOLh0MBP5m8BOp9YRqLM1Gz9sdGamyg4aVLJfbkjVu2ihGEljF3yFSaN4rdaKr0kPZljUXr_NTVJVnSa9JX43DkTLz9wr72ZZtw=w1783-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWk6KbrlUmoINsU5EDvXp98IAszMx581ZC9xklYKsts68xth9kyGIHRygnSnZrmmKT1YMGfXM9d7ucLrrH4CGHzKGbICgX1UAH0oUxbnEH5zO2saanzpyO9HqBCnU4TD7g5U6aAthnOchGK6-iyvlxG=w1783-h1337-no?authuser=0" alt="2"></p><h3 id="x-来自新世界"><a href="#x-来自新世界" class="headerlink" title="[x] 来自新世界"></a>[x] 来自新世界</h3><p>42 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXW12m8aCJ_lQmC2vM2-sCzFEIzBKU8u1MYUVycSL51fDg4M68g6ws8IpgxklWJd0V6ktos3JNXaajzIo0YWWIdUyCnt_aTgRHsyHsPYV3Y0v0kjHTNPMB_ZfbBpK_LOIbWMig6qjlkqEgdRRevuRGZ=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVKmbarEpe2y3VJIB6JWxElwuZ_P4H_myOZ7Aj2GspthJ0yGUx7X1pmLd0uHhqEzRmXv-1lZdeIoB_4tVpswN7JkWGWy81OaCq9ZErc6dZ-RxbKw4wQwzSOWC2CwEi_qCS6WgzeFYRYBE0XThPhzBax=w1783-h1337-no?authuser=0" alt="2"></p><h3 id="x-规模-原则-爆裂"><a href="#x-规模-原则-爆裂" class="headerlink" title="[x] 规模 + 原则 + 爆裂"></a>[x] 规模 + 原则 + 爆裂</h3><p>103 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVFPJ2Ci9zcUYS2s85p8vWOwIAqQWz2oZaCsXDehTKrJuCexhyowmaY-MyjgEKf7aY2QRWTEpzZ4LNCQQNLzu0HQXOw2TKaZT096H2XKMljbsi6gVYzoenVg_JrDCNCDqyQCl37Duel0yELJzb0xo0I=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXb_r1kwP_ZI1h2w3ZxhMsctqBqNUy9upW5AoZOZO_3_yCe0roxFE9YR1VxHabfaZQlyAhgC3qRdAcshKCn1JRJOjXB-um_6ejUN_gp9zNeWz_lXYB6y914LbAWuJJIZ7EysGg7Jy0jXgpWP8awr_W-=w1003-h1337-no?authuser=0" alt="2"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWz_GqPKsNcNx-5Qxzhfp3k884FTgbcOrOHEwQTma-zo3csnrt_iRSMoDw08aMNxNHBt27CXJHI_wH25GKZscXC4FjXCqp8QxRj8cHy8QXeNPVVTMlfNhy-2f9Rhj6VoK7VcqF3M4Jpxpw_ukBi12g4=w1003-h1337-no?authuser=0" alt="3"></p><h3 id="x-拉普拉斯的魔女"><a href="#x-拉普拉斯的魔女" class="headerlink" title="[x] 拉普拉斯的魔女"></a>[x] 拉普拉斯的魔女</h3><p>12 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWaeQjKyEdtMfkrCjNgFgIuF4Dltaamfsuszz6pcoRyEgAUH0qR2c2t7edp_qAe1kkRywBOfTWuOiq7kbANgWzoY8lPW-eUjS-43eWc4H3-BZSzTX1wPoAWAMRZhpZ7UeTdhwD4P-6d699cBdbExjdz=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-朝花夕拾"><a href="#x-朝花夕拾" class="headerlink" title="[x] 朝花夕拾"></a>[x] 朝花夕拾</h3><p>11 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXAkToTAP9ag-4cho_psP3GF8vrmg_7n4Eck_CcMZ696PzmIUyD4xDYwSDU3hYyvjjlIxKGXzFRItDwH9fHW9bpLIhnFRzSVlZUNXj1K9AvDCMekB5EK0YfzdATGj5W9xaQjZFWJ5touPZzW_O4eKB_=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-人以什么理由来记忆"><a href="#x-人以什么理由来记忆" class="headerlink" title="[x] 人以什么理由来记忆"></a>[x] 人以什么理由来记忆</h3><p>42 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVYX8HBpa1qlxar6MP6ApBj9GhIp4_fZHjNUFLtUEaVOGi1Fi8AZV2ncmxmcJUqglXEPS38OBlY00AHQO1gscb6Fgglvv8pNGjOWsGA8ZRZZt8TmP7QvxfbjOQ7wtFvIF8C744IG7HIddrA-x5CEhfP=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-美丽新世界"><a href="#x-美丽新世界" class="headerlink" title="[x] 美丽新世界"></a>[x] 美丽新世界</h3><p>29 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWHdP85uGGqvbQp5TLA5HO7M6Baqaji4WklbaxyRu3JrWxOWju1O2Lwpc1FQ4pLb5x6Hja5r9e5RI-huY3udnMn0GFx8pmdQy_wSjd11br9kNd3WzKRh8eXNi6UBkcJG7xohvn-bYm-QZHolG4Q74h5=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-阿尼玛"><a href="#x-阿尼玛" class="headerlink" title="[x] 阿尼玛"></a>[x] 阿尼玛</h3><p>9 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEUsGluA7u4mA9OykS_yDKDlESB6GiHYyaKV97wSERNB7v2VqIK0nf06v-LBgkfUA5Yyv7G45RbTCWR-dVMNDDhMAkjfDPQ49lWGylXwLvO-UtSRqTGsARgjWkNIE0ZyzsOb_oUQAG_ECCJDZKJm3NMd=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-给心理治疗师的礼物"><a href="#x-给心理治疗师的礼物" class="headerlink" title="[x] 给心理治疗师的礼物"></a>[x] 给心理治疗师的礼物</h3><p>23 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXexPSI1ZyncH27jm5a1ypELpbfu9w3ODJkJ28RKQZav0eREmRZbuA3XYdVqGoxY-qrrjxAd0LwaxVrJUWLSdYGjWC0rnNpfXwdthEKLf2W88qQpGbGxSjpy1JGRYEz9boPQT9j0f_t2JXOHlKfIXjD=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-金字塔原理"><a href="#x-金字塔原理" class="headerlink" title="[x] 金字塔原理"></a>[x] 金字塔原理</h3><p>53 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXu-JaETRgd3TFtOPqV4lMS06DKGAHyI6XqlUzV9qzQvVno4V3izD2y4unTXYCVv5Wbro1Py0ZFZh-6KSrrSHadEKCHWC80Zxf_wEkK5A01Fyd_cpx2pGubcqCzKyom3DioGPN4nFw-WXEED2l6D6RD=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVQaUo7_KlCNuqvRQDtjdF_7vD8DsgXQbRwnLV9jy2hWC3xyKjljDgGzWOYF1rg2XADJVLbaNo3iJ9r4hSLAL8Cj4L2SMJJUwikee-CZuz8TzsTX42qO8x-4u60-1pw6ckjmui74OfIeNZfNCXpgP4B=w1783-h1337-no?authuser=0" alt="2"></p><h3 id="x-你不知道的自己"><a href="#x-你不知道的自己" class="headerlink" title="[x] 你不知道的自己"></a>[x] 你不知道的自己</h3><p>34 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEUtx4cXxTvf-gZbl7RFg0zZMaFyu2CyUr1XayGUUJDLdkA6eWIuViZMjvSSV3CY5fF8QbwU5CKzSwiiCj-LOkPUAoUsiFjJDOnbVIosQwrkPIEIV9aXkbJcpI7m8oN5Frys0I9d7qBa4jHMBfwcu06m=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-论人类不平等的起源"><a href="#x-论人类不平等的起源" class="headerlink" title="[x] 论人类不平等的起源"></a>[x] 论人类不平等的起源</h3><p>14 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWWhsi1fRpszGZ5-oeP2XyKWWdjS7QE2U7GcebmRkDvE7VeqwIhDGPHl2kEhOMy-Lt-jeGIZKHQfnKqRg-SrwO-mw3IHTdGjDs87IFtD5UG9IsyqZctbm6sLz9FC33XSfhRXqabJ_vk16kpIEuK8Uq3=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-网络是怎样连接的-程序是怎样跑起来的-计算机是怎么跑起来的"><a href="#x-网络是怎样连接的-程序是怎样跑起来的-计算机是怎么跑起来的" class="headerlink" title="[x] 网络是怎样连接的 + 程序是怎样跑起来的 + 计算机是怎么跑起来的"></a>[x] 网络是怎样连接的 + 程序是怎样跑起来的 + 计算机是怎么跑起来的</h3><p>54 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVL430Tkj85rgaCM9M2jSz5_KOtVUNb6jIC9p4KczVhBG5gr0MbrvgG7a13pFx52Gek-tqDdi-6CgZW93DIZ9IEHkCVSKF3qwjoDqhRet0JFY_7lbMEFOledbZ4so_l7whSotInvh9i6KtrPuxi9GXg=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXVp72-KO76r24MAv3NcYEBHyVMDgJPUf_iJmGVbN4Yz-8qIKlaZKRAjyacy-iXh_AmOCHTjyqNzI_4WBzSOi7vS3Sx4dQnKjulmzLlVFoB99J9n3-8M5x_VjmJMQs3cB9M693vxc9zXxmPNydl7vQF=w1003-h1337-no?authuser=0" alt="2"></p><h3 id="x-这就是软件工程师-这就是投资人-这就是保险代理人"><a href="#x-这就是软件工程师-这就是投资人-这就是保险代理人" class="headerlink" title="[x] 这就是软件工程师 + 这就是投资人 + 这就是保险代理人"></a>[x] 这就是软件工程师 + 这就是投资人 + 这就是保险代理人</h3><p>85 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEUeqdZTP-ppizLOEyK2bBNT8lQI58fZxLjTqjlEq2XB8Lg8i6Iz60uqyQ6VSWRM8gMZWomgQ3RA9uO2R3kL-DZlRV4LGaxks-43DYe2JkjD8oYvIHLCzn2plOB0j9etxtSuyPJfogCGx2D1zzz02UeZ=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWT2_uRXr0oMrsjWXKCWIjL2JpM0ZDt43acIqbmarr3Hqa28CNCADWslhUPllApN00AAACxetzsohWgZzPdUBMarfnbGrT-o3O-YxA3mjVGv6x7jWOxlwvZWRv6uPaKJGuAkjec8ZPjgIJpLR3kKG89=w1783-h1337-no?authuser=0" alt="2"></p><h3 id="x-你不了解的真相"><a href="#x-你不了解的真相" class="headerlink" title="[x] 你不了解的真相"></a>[x] 你不了解的真相</h3><p>18 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWRAf7kNk5DBkAlBLSivsudYnRMYeE7h3veoDZHyX6kGwrP41gQYX-0mVyGvkaQwxaI6T6FBAT6UVtMhiFYKFTsOZzT_xS79UzQ-MzTNGmxd6iIFv3mPr6hRzREZyjAlZLbrZnEn6Pb1B4WpvprRRnS=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-富兰克林自传"><a href="#x-富兰克林自传" class="headerlink" title="[x] 富兰克林自传"></a>[x] 富兰克林自传</h3><p>29 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEUqcCxH_wuzzofzUQbaVZ-j4TEUlRJZS5s_IJNBvLF_ZW3Jkb2fxgyQ4jZvN5qKP8jCQQDicTVdkYE08PdJEYWg1S_gpO2YYoIaoVMvkJXxuhMYmloOmKSkpSJ3nKJZzVJNJn6COANLOQweHIXHm-C0=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-颓废与沉默-透视犬儒文化"><a href="#x-颓废与沉默-透视犬儒文化" class="headerlink" title="[x] 颓废与沉默 透视犬儒文化"></a>[x] 颓废与沉默 透视犬儒文化</h3><p>15 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVPqNVaykiHzISeyz9_6Bwz1rZbecMx50qGiPKTxg0XzJeEBbB5DLETXsDXAfJc4Q-WFrKdCGPf3vBOV5AxNMQ4J1aBp3g0ohxqbwIObu10SyPbftcgK2mSeWLcEGDBfZV5xwBT-drkJz0wrizZ5mHE=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-通往尊严的公共生活-4"><a href="#x-通往尊严的公共生活-4" class="headerlink" title="[x] 通往尊严的公共生活 * 4"></a>[x] 通往尊严的公共生活 * 4</h3><p>16 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXZ87dOGHlyFKyrz3_o4PZ2UCrIznKLnnJcBg8NxbFFNvJOe4oGTSpnL35zC8O4sKl-FK-1lQsyWH-Y0mcEciut44DukzSJEtwQjoYOstM_FNF9XAYuTNZFbSv6Yn6NOI_NvdWWBPVWJjdhoQ36uO4l=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-美国众神"><a href="#x-美国众神" class="headerlink" title="[x] 美国众神"></a>[x] 美国众神</h3><p>25 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEUyDfmFs6BhCgcwrkrd-nS643imfLOnV1uA4TgGVGra7NSElBBVR5_q9vnwFOoLxeKEk_roPS3cTyNcP5npZoG6zz2NX3SNlDnDCVwWEq7GZeJHNaZk7a45l-x8iud1th9IinwuISN4W09RXgwiLQ7d=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-培根随笔集"><a href="#x-培根随笔集" class="headerlink" title="[x] 培根随笔集"></a>[x] 培根随笔集</h3><p>14 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXoMmnqh4tb1yDOyyHNin_yt7u9mPsf-53gJ5DYbEOMcK_4CX_eh0fpv1Za0wxZMxABhuhCw-b2Vq-UknA_Sht1TuJIKE3FY2RF4yf5Y_cgPtTJ4V2Eey_KHbVexg06BZK6EhLQU_Bnns4XbXZiKAVA=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-上帝造人有多难"><a href="#x-上帝造人有多难" class="headerlink" title="[x] 上帝造人有多难"></a>[x] 上帝造人有多难</h3><p>12 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEV_Mptp8gqi3uzKR98FkY3g-Rh29aTlrwsQZUFhp4qhWr5udb9DZ_I1sSENwtPlOuE9yW4NbwgqiqG40mmyFRW3pxXQceTg1xbqwREczSjJQuYsk-IeogitQft3IZ2CdGfqaqP3gAmDYLKMoaDUBZve=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-致命的自负"><a href="#x-致命的自负" class="headerlink" title="[x] 致命的自负"></a>[x] 致命的自负</h3><p>24 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXtk1_aKf_c54C5fNVqoxy_MY6l5JbgzM9P7ZrraCx0Jdp-nMoXuedbrDozdsNIvBA1Xk6nurqYf-BUNjv32F9pzxHKS4XfJxp32EKzFi-VPTpgt_BWB-FX0sMtd87r6FQNtrjkMp3l93wMw97FIk8J=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-柑橘味香气-4"><a href="#x-柑橘味香气-4" class="headerlink" title="[x] 柑橘味香气 4"></a>[x] 柑橘味香气 4</h3><p>10 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEX74kPDuQ8dSltEFoJNBXMY9c1_UWErqyH4F94ZAQE-jWM6fC4veLRJSQ_nVxbpUU7HQ1xTUItYQsjvOYhkZhx9fTWl5bpa6bXe_TSbtCnKoNhZsnOGbk3D2OS5dGy18zVmvKYXUBNrUbPxkByNG_ho=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-解忧杂货铺"><a href="#x-解忧杂货铺" class="headerlink" title="[x] 解忧杂货铺"></a>[x] 解忧杂货铺</h3><p>18 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEW_cU1ORDL2WuIbc68J8iJjaXQvbFN0-ktueBPKwm8LvbC1Ee-oOIMkQyS6ajApvxlavC_0LQFmvPukQtbxC6UMwLh48jkpRvVOX9a91dav0DfquNq95YR-c9Cqxtpq16yq9n5GGbY03alZv6s3BSLf=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-大学之路"><a href="#x-大学之路" class="headerlink" title="[x] 大学之路"></a>[x] 大学之路</h3><p>35 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEX6i0GsPZdedC4tmpwPC_MnZcXAyJbJZKyX0kYe9Hf-aW-9OrHWjHk739aMgGGB8Y_28C4eIM1i6RpS0MgRMTlHULn8aX6BQYKhyPpWYeYCiiemuJOzpc3Z4PMBmQsVO82jhWG0wliDskgGfmRQUhpk=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEU7C9pT99BlZM636gXx-8tqebPQq2WqwJ8qH2ujWLmu5ShQU_tLnyCRmXUgya-_HYFOLMjmSQD0qrdpoczDElRRwNA2cO0Q1u_MHt8z0aXYdFuXlPrs-vhdAsjR3B034Dt0HJeZWMYnYwR03XkccKWw=w1783-h1337-no?authuser=0" alt="2"></p><h3 id="x-格局-见识"><a href="#x-格局-见识" class="headerlink" title="[x] 格局 + 见识"></a>[x] 格局 + 见识</h3><p>31 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEW1KlDCp-ErhWNhEedmEX89ifijKedIpgDdovCMWTXiTnK_bx0LjiSX2kcTBkUO_EP7YNEP1UUMiERu_qr4q6Pd_gWzqlQ1gs6Z2-4xxkTqGs0a15g3jRLjeVtYklvyzmlP7zLX-67iN473Lj4txQW0=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXS1Y3XcaaeO3Q9T8lo2BIvxcIYBiFW07wRp6jFd4h9NO7QWM6vJQqMidmc0J4CJVPKaBybyfEliO78w4Q78ZEWyrAdnFwAI87gPU8ZZMt5Q2gyHJ7KOdOhtv1-XrcJMkJ7R9xxIxpjkhLQaJ_q5twc=w1003-h1337-no?authuser=0" alt="2"></p><h3 id="x-我们"><a href="#x-我们" class="headerlink" title="[x] 我们"></a>[x] 我们</h3><p>10 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWJJkoF36hBu37iJ5_AVV0hq8ZQSQg-LdcWyO4v7k27sBH8MTNurCfaNymGhRkTne1ThbhQbA5TbvduzPSDhJI97JLDQHaIaETSAElprczbAF-NxKrG2vrKm44YWDEPo2bZ3h2Uua2LmEWyo4TuJGab=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-野草"><a href="#x-野草" class="headerlink" title="[x] 野草"></a>[x] 野草</h3><p>10 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEV3TvOnebbvO-w-Dt8kwHoveb-MfNYxzzwTbzvT_BxMq88CEU2YJl6l1UE-X7QtVfUd6xN9KstijKgea5PrNwxgRlaLTyL3nqMINQyiBC26dKf5QJlo_zP8_ICPY4g5A1MwOEs8u2t6DzTjHe3R7tJu=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-增长的极限"><a href="#x-增长的极限" class="headerlink" title="[x] 增长的极限"></a>[x] 增长的极限</h3><p>18 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEX4zCe9DDUbE4emCDhTe9qjrI7nm2G4JESa6EdxME94aq0aekjY-nc-BUFrcmln_Pbp3NOtuB1WBNvWG0u4fRaW-jcIShk2NxzI2I2KjKzxWfuyOUGrdulSck_8BmHnjDH8CRD1OvVIDyyArwNIoOjc=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-今日简史-人类简史-未来简史"><a href="#x-今日简史-人类简史-未来简史" class="headerlink" title="[x] 今日简史 + 人类简史 + 未来简史"></a>[x] 今日简史 + 人类简史 + 未来简史</h3><p>55 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEV-FamNg7vMK8Z-3GeUytPVH_tTPZSDOdXOLb0UzTA0d3iEZSHIa8uNr_oKIEC4Ygdg0V6NzTPJr1R-wfnP2rHlslnmwE0IRfI9TDVkMaKvsoGzm2UyYnTHgNeaT_zUsVwQwwWwQFjLWWTi1-HA3UmR=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWCBKhN7-DtCMmlsrsN_mpQg5F8omGhOuJ8jtU3praWoT6L3fyBMKEWcgOQG4KDZPxi7xnGYjsxXkJR8QBDelE47OHoGWZQQuIKfWLFyNIh57BmJgQPifdcJVolXsNFek3hRwtetKuEm5euwG3vZE78=w1003-h1337-no?authuser=0" alt="2"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVkIiNApci4onatxnPYG3ejyVPPfzNIHp3lnT-NraNT6-W2tEY6ePgj8QkNUmayTlnScG_ySKUrmNbPiaJnptJrlGnt7IyL8e_um3kmQqDolEfDUgd5G4HO3WFPx57tkqnYd89Doyqm1Svjt0ACzFFd=w1003-h1337-no?authuser=0" alt="3"></p><h3 id="x-集异璧之大成"><a href="#x-集异璧之大成" class="headerlink" title="[x] 集异璧之大成"></a>[x] 集异璧之大成</h3><p>42 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVj9Yi7oFx9F8U6TiTD25JsalUnKXFKJicrQMS309i_Fn2EsxlwzXYKkrz_Vj-ZtoR1dTBP2tWRy36uI5ve8qZbetyJDGX3IB19_85CIk1SG09Ffd4C58y7CIHHHq_66Y4jkg_4IvfOVqPVFddEuNGR=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-被讨厌的勇气"><a href="#x-被讨厌的勇气" class="headerlink" title="[x] 被讨厌的勇气"></a>[x] 被讨厌的勇气</h3><p>20 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVM4fzPBJwqEN4KV8kYaxJJAN-PHweLIN6Xr5zhwWDvs0QogYy059WpHmJ6DfvjTLEAkVCFwT-el5g20byvy2eeFRR3BDFJniOOr_bh4K9EEemJIe47WWXBQ-5EMrqsubobXgmSD6_OeN1zWU2yMTXv=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-异类"><a href="#x-异类" class="headerlink" title="[x] 异类"></a>[x] 异类</h3><p>30 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWiFFBaIXppXCQicjxYLpvHfEJBAHsZvvOjp41Ty5y-Tynsssszs5D4sdP0YPnII-d0NAOO4Y85AYpRoC-_d_kHfshz6rCvNXi-2g1YEQgD4GWzKtbZAw20OD7ZaWKKiXsRQ9_7sXNTxXWdHDuS_cbQ=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-社会契约论"><a href="#x-社会契约论" class="headerlink" title="[x] 社会契约论"></a>[x] 社会契约论</h3><p>12 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXYETHPN-Z7wGY_nMFgXPsPWImWajgI4TqnlrjAlimmsYow3Uhz_cbEDJK7x0cpWXrQLaAlZ1wHJiUIEHt48H7KGrZL33NHa-Rk62h70Wbalw71X9fDX5dc4utNkSVhkKeahr2ikliEHg21GubsPI87=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-浪潮之巅-4"><a href="#x-浪潮之巅-4" class="headerlink" title="[x] 浪潮之巅 4"></a>[x] 浪潮之巅 4</h3><p>38 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEUHE2-3yF_YBHyCHPvbyQ5DuTR2SEvXxIYDao6Q2-6OJ41BmeSDWchjzMLPmTXMM-vcBmpI36bESwVcyalil4UPffKjpTsOzyGkjteSHB_V-lFSB5sW5GiGD63vwHNRyBd60zqoTkti_P6uyaf9iKsL=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXQwYECOs1OYQlVRhDb4i0h0mfCr5IeEAf-mSohQO7qjxn1ECTBgggmq_ORUwBruE-N3Vseynnsrp3oYFXvkoOGYJwD2oYDAfiXlxNVxan3pUzVSjmVWl2f9Kwv0RKL5jRUU3LZKvquEZITIliNkU32=w1783-h1337-no?authuser=0" alt="2"></p><h3 id="x-纸张创意"><a href="#x-纸张创意" class="headerlink" title="[x] 纸张创意"></a>[x] 纸张创意</h3><p>30 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWimfKnMZmd47igFZLkZVi5Dh7AW7OhQDg3qfN1f4yoEOTxe5T6ojUGmOJBCS9VAcxMVDxkXKf-I5TWS8bnl3LjHztHPKM_jalbcFlqDVoV9pvOA4VO1jvYkzDnsmhWZ7IqKAYAHJGWWMWOYsi6e4Vb=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-css-揭秘"><a href="#x-css-揭秘" class="headerlink" title="[x] css 揭秘"></a>[x] css 揭秘</h3><p>39 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXj43IjpSJMQU_Kkb1xPMY2RbGQnmEdSNklXaX5nqlt0ssa_tIxZyqAfcKpgLS2PNo2kEtEP-jmItwYgIxwCPRVHVbuFqB1Wy0o7Kx8Sg3SunFZBpxZNqnFLS2T30iJDKq8WghhfLtMJzo2znhBg4pr=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-head-first-html-x2F-css"><a href="#x-head-first-html-x2F-css" class="headerlink" title="[x] head first html/css"></a>[x] head first html/css</h3><p>30 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWAcov-GyaudQZQCBELyIb40Ka0ShpJoTgZS7opP06d-A9kTVMEGX1Mrlx8K24bSXhs9rZl6MVkD4_UiWJlJivbwFW3_KSraqoBeqMNU3n_G6psSYPMLewvw4IEsuCScCA4eisdmCpO_zXxyPeaJO3r=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-黑客与画家"><a href="#x-黑客与画家" class="headerlink" title="[x] 黑客与画家"></a>[x] 黑客与画家</h3><p>20 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWIPAPzIlaGJx4vq2VZtQc8u4humwPKJWwKqFwn2-FFTvd9aRaLGKfEmMKQGE3LZ8WIrANwCe3camJ2cCcaO5Nijj8KNzjouCf7kqebxfOxekbE7ppNot6cYTXSbwlDQpqq7mqqIhzUxrfv99_OjKl_=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-浪潮之巅-3"><a href="#x-浪潮之巅-3" class="headerlink" title="[x] 浪潮之巅 3"></a>[x] 浪潮之巅 3</h3><p>25 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWR0TiIsej6a8XDWPqDXP_w1gaJAqjTU-gNDaOl_uvaxeN8S8ZE4t1fWbemcVWlVL74WGtaGIbQnAnAhS-I58L9-Cm2zkyHc93HWUpA7eLjsY2S4Z6aHvjthjOBUU_MyXGoMuITAnn9RL6uvYbv57XQ=w1003-h1337-no?authuser=0" alt="1"><br><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEWmpOr6lP4CTfLPPZmLFAnhSpoIpb5IBBwxJSqCo1UJwv4wcuufc1sLdE6gqM-KR7IhYfRCnLpxp-ONCGBv24sdzgpByCWQcnf7epufSYHeFCpkR4WlcH0CnxZxMVwpnsShZN-pDNi-ZxTiJk3jbwvi=w1783-h1337-no?authuser=0" alt="2"></p><h3 id="x-女士品茶"><a href="#x-女士品茶" class="headerlink" title="[x] 女士品茶"></a>[x] 女士品茶</h3><p>22 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVdjivJdxoNEdPC-fhaMeQnnzV-JHfUVHTNc7hWL4zm5to8XDe4cW0jnz72vN5axFDDQUidF6_r1y1lWoCRAo8x6haA_gah1rCzKx5L0rQ3_xt5mX3157ISuSDUWpU7vPt3vZXLKQAWgL9ADlmjSK1n=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-宇宙-从起源到未来"><a href="#x-宇宙-从起源到未来" class="headerlink" title="[x] 宇宙 从起源到未来"></a>[x] 宇宙 从起源到未来</h3><p>33 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEXYTjN0vLGBQaPBoULJmTfHtQBo1eX82l8-NtRGXJJiL5bUWF8EdSH3sPWIL983S6qZDffrs2afe6zgDrtf9LCmpVSLuBPC0wYG3xUIRiA1jyS8y-3rh2OpY0IQzVjRwfFOq3XCLXS4q8zItR5xZCet=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-交互设计"><a href="#x-交互设计" class="headerlink" title="[x] 交互设计"></a>[x] 交互设计</h3><p>43 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEViADICx3hRo1HXSv-PgnM_H6EPkUl9o0oDkYm3zQlQOuelTgF6KAFXlnuBlkAe6--PwRJ78UdPscUG-air99ndMmxSmX7Y2t6jIiZDz_Ys6tijYCyY_qAQ2TdrSFVHoVFsnj_8yGhfoyPg50gjV_xQ=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-人月神话"><a href="#x-人月神话" class="headerlink" title="[x] 人月神话"></a>[x] 人月神话</h3><p>37 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEU9yBvoFz-ixzDIsWiQeeP48z4Pda85TNm_3gaudJ_4IOd6yx7NuNdNfpTfzi7CIb7z0xYhyUmqldxu--eQXyeikA6qvFQi1nxmiQz3IpFSERcbYsrrRVtCcpQQEyGV9_zCxrP8rKZRpHiC3Ktod7Xt=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-JavaScript-设计模式"><a href="#x-JavaScript-设计模式" class="headerlink" title="[x] JavaScript 设计模式"></a>[x] JavaScript 设计模式</h3><p>27 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEViYS2uZUyAHszGSjz4xzLXKvH102RFWlvQfJKkpTSD4Zk3w0YDg0YDLdLODqiSX4YPCF-8rA8T_iOabegCsnFfFpl5PxsQrRSOatHlEJAc1tSmtOcQRLIyNbvUHBOVgYhIglh17IcbcUftuwuynLmY=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-天才在左-疯子在右"><a href="#x-天才在左-疯子在右" class="headerlink" title="[x] 天才在左 疯子在右"></a>[x] 天才在左 疯子在右</h3><p>21 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEVI2my44vGE3IqZEZnrmmAlk0J8Gjia1omySB6ZH13oN1EfastUx7BBa0z-QTHZ0XTcFj6p4wtXBylyQqV5mn8N48ut6WK3yCTV0QTP12tLxYPNT_H6NktqionspqfNlkSPhk6ei-E6jZaouHfbNIqS=w1003-h1337-no?authuser=0" alt="1"></p><h3 id="x-地铁"><a href="#x-地铁" class="headerlink" title="[x] 地铁"></a>[x] 地铁</h3><p>22 出</p><p><img src="https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEULXeMLS1HZ2iOxxe0v_KUv5qIGTTQt8mNBv8dTKMr4MHWAa18DFz2Rkf1gd1xgC0DEw3N-9-XnHbvpm3ZThjc41i_KG-S78GqTdvxatL5IMLT7WKAGaA9_arM7iRn3UVWhQH4b-iIje_y60Bhz2MFm=w1003-h1337-no?authuser=0" alt="1"></p>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="其他" scheme="https://blog.rxliuli.com/categories/%E5%85%B6%E4%BB%96/"/>
    
    <category term="生活" scheme="https://blog.rxliuli.com/categories/%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/"/>
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/tags/%E4%B8%AA%E4%BA%BA/"/>
    
  </entry>
  
  <entry>
    <title>月报 2022-11</title>
    <link href="https://blog.rxliuli.com/p/450bf8bbe0d447e599c0bb96d2a2b439/"/>
    <id>https://blog.rxliuli.com/p/450bf8bbe0d447e599c0bb96d2a2b439/</id>
    <published>2022-12-01T12:28:32.448Z</published>
    <updated>2022-12-02T05:13:26.671Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>嗯，周报很久很久没写了，所以写个月报，虽然也没有太多有趣的事情发生就是了。</p></blockquote><h2 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h2><p>这个月有点懈怠，连续两个周末都在看同人小说，主要是突然对反应类型的小说感兴趣了：即作品中的人物观看或了解作品本身的反应。不过这个在最后再说，还是先说一下在技术相关的事情。</p><p>joplin-vscode-plugin 发布 1.1.0，支持了在指定笔记目录中搜索的菜单项。idea 参考: <a href="https://discourse.joplinapp.org/t/12854">https://discourse.joplinapp.org/t/12854</a></p><p><img src="/resources/5c75dbca68964c418b1871ec6846446a.gif" alt="632c45944e90a2d37a00211f0da7b86091a51459.gif"></p><p>另外，这个月插件安装数量破 10k 了，真是值得庆祝，也是吾辈被安装最多的 vscode 扩展。</p><p><img src="/resources/d87e29b824244374a56ed85a113040a7.png" alt="1669957684996.png"></p><p>mami 主要是添加 joplin&lt;=&gt;obsidian 相互转换的支持，也增加了对 docsify 的支持 <a href="https://www.npmjs.com/package/@mami/plugin-docsify">@mami/plugin-docsify</a>，现在可以将 joplin/obsidian 的笔记输出为 wiki 了。</p><p><img src="/resources/e24f12ebdd9648678f739dacb5774bdf.png" alt="1669956740972.png"></p><p>尝试了 file system api 与 pwa，并创建了一个 demo <a href="https://image-viewer.rxliuli.com/">image-viewer</a></p><p><img src="https://github.com/rxliuli/image-viewer/raw/master/docs/demo.gif" alt="最终效果"></p><p>尝试自行制作了 ts playground，老实说支持类型提示很麻烦，因为必须将所有类型定义的代码添加到 monaco-editor 中。</p><p><img src="/resources/9d65c31166db43d5a7faba19a753a880.png" alt="1669956914407.png"></p><h2 id="同人小说"><a href="#同人小说" class="headerlink" title="同人小说"></a>同人小说</h2><p>好吧，最近看的数量之多足以单开一节了。很神奇的，突然就开始看了，而且没停下来，只能说和国内的网文一样非常消耗时间。话虽如此，同人小说确实很好看，因为它描绘了不同的假设下原作中的人物会如何行动的事情，通常这也用来弥补一些原作的遗憾。<br>典型的就是：《魔法少女小圆》中小焰很喜欢小圆，这似乎超越了友情，以至于在《叛乱》中因此将圆神拉下了天堂，那么，为什么之前没有采取更激烈的方式保护小圆呢？比如把她绑架到见泷原之外的其他城市。好吧，于是就有同人小说做出了这个假设，并描绘了新的故事。好吧，如果你愿意，可以自己去看，吾辈才不会在这里剧透！</p><ul><li>魔法少女小圆<ul><li><a href="https://archiveofourown.org/works/31263467/">Knowledge is Power</a>: 另一个魔法少女小圆与死神交叉同人小说的反应小说</li><li><a href="https://www.fanfiction.net/s/13942972/">FavMagia: A New Hope</a>: 一位小圆/魔法记录的粉丝突然在魔法少女的世界中醒来，成为一个配角。特色阿什利泰勒。注意：如果不是很明显，你应该预料到特许经营中几乎所有内容都会在这里出现大量剧透。</li><li><a href="https://archiveofourown.org/works/577310/">Persephone’s Waltz</a>: 她救小圆失败的次数越多，小焰就越绝望……直到绑架她并将她锁在地下室，直到 Walpurgisnacht 结束，这听起来不像是一个疯狂的想法。</li><li><a href="https://www.fanfiction.net/s/11339239/">Perfect Crime</a>: 为了保护小圆不死，小焰绑架并监禁了小圆</li><li><a href="https://www.fanfiction.net/s/13409084/">FavDiversis Mundi Magia Actum</a>: 一个人变成女孩并且来到了魔法少女小圆的世界</li><li><a href="https://www.fanfiction.net/s/11551156/">FavA Wish Within Darkness</a>: 小圆许下了让她们拥有更好的未来的愿望，这足以扭曲现有的规则。</li><li><a href="https://archiveofourown.org/works/32241079/">Heartstrings</a>: 小圆从记事起就能看到琴弦，它们一直都在那里，她的父母只是认为她的想象力很丰富，但她始终知道不止于此。在她的灵魂深处。</li></ul></li><li>刀剑神域<ul><li><a href="https://www.fanfiction.net/s/13114758/">FavSword Art Online: Invitation to the show</a>: 桐人和朋友们正打算去看神崎艾尔莎的演唱会，直到一个神秘的蒙面人出现在屏幕上，带来了惊天动地的通告。同一天，凯伦和她的朋友们正在现场观看艾莎的演唱会。他的宣布将动摇 SAO 世界的基础。“欢迎大家的到来！”</li><li><a href="https://archiveofourown.org/works/4097260/">Discovering Aincraid</a>: 桐人和其他角色被神秘的“朋友”拉入了黑暗的深渊。他们必须一起观看他在刀剑神域中的旅程。不幸的是，他们必须和当初困住他们的男人一起观看。</li><li><a href="https://archiveofourown.org/works/22026883/">Orange</a>: 在死亡游戏的第一天，情况有所不同。在茅场宣布之前，桐人已经 PK 了另外一个玩家。将他的光标永久更改为橙色的动作。现在他是个罪犯。其他玩家会为此追捕他。NPC 将拒绝为他服务。他将无法再与任何人交易。他现在完全是一个人了。</li></ul></li><li>暗杀教室<ul><li><a href="https://archiveofourown.org/works/24225712/">School watches Assassination Classroom</a>: Ritsu 穿越到过去 20 年试图消除天启，但由于不可预见的错误，Kunugigaoka 初中三年级的整个三年级都被带走了，现在被困在时间泡泡中三年天… 事情不是一个好的开始。</li></ul></li><li>火影忍者<ul><li><a href="https://www.fanfiction.net/s/10474631/">FavThe Girl Who Spun Through Time</a>: 日向雏田穿越时空的故事</li></ul></li><li>魔法禁书目录<ul><li><a href="https://www.fanfiction.net/s/13538042/">Misfortune No One Sees, Until Now</a>: 你们所有人都以某种方式与那个男孩有联系，所以我提供了一个机会。我会向你们展示他的记忆，以及潜伏在其中的绝望和艰辛。所以，如果你认为你能处理那个微笑背后的黑暗 —— 那么无论如何，我欢迎你……！为了无人能及的不幸…… 直到现在……！” - 舞台已经搭好了。让地狱开始……</li><li><a href="https://www.fanfiction.net/s/13776469/">FavLibrary of Consumed gods</a>: 茵蒂克丝一直是一个单纯的女孩，一个生活中不需要太多东西的女孩。与当麻和奥帝努斯一起在宿舍里过着平凡的生活，她已经很满足了。所以当神话妖精降临，悲剧发生时，她不知道自己愿意为保护它付出多大的努力。</li><li><a href="https://www.fanfiction.net/s/8918264/">A Certain Unknown Level 0</a>: 一方通行和超电磁炮。两个受到同样传闻的 5 级：他们被一个 0 级打败了。但是这个神秘的能力者是谁？这是魔禁宇宙中的人物对这个 Level 0 所做的无数调查，不了解他的人会知道真相，了解他的人会瞥见他的生活。会有行动。</li><li><a href="https://www.fanfiction.net/s/12696204/">FavA Certain Strange Addition</a>: 如果当麻在引力子爆炸事件中的行为被美琴的其他朋友发现会怎样。倒霉的上条在本质上被拖入风纪委员的情况下，还能卷入多少不幸和疯狂？</li><li><a href="https://archiveofourown.org/works/25020067/">Sometimes Even Touma Can’t Save The Smiles…</a>: 当白井黑子濒临死亡当麻放弃世界时会发生什么？</li></ul></li><li>我的青春恋爱物语<ul><li><a href="https://www.fanfiction.net/s/13897216/">FavWatching My Youth Romantic Comedy Is Terrible, As Expected</a>: 八幡在他的房间里发现了一盒 DVD，还有一些说明。但他拒绝跟随他们！无聊的上帝决定必须观看 DVD，无论如何！几天后，所有人都被拖进了一个剧场。屏幕上播放着一档节目，名字叫…… 我的青春爱情喜剧，果然如我所料，搞错了？这到底是什么？</li></ul></li><li>从零开始的异世界生活<ul><li><a href="https://archiveofourown.org/works/27548665/">Re:Zero Watching Him Die Again and Again</a>: 角色将在其中观看斯巴鲁在他们的世界中的冒险</li><li><a href="https://archiveofourown.org/works/35089096/">The Otherworldly Sage</a>: 在击败斯洛特的任务中被所有三名候选人拒绝后，斯巴鲁偷走了一条地龙并逃跑，放弃了。然而，当他到达 Flugel’s Tree 时，他遇到了一个盒子，里面有一根手杖、旅行衣服、五件力量神器，以及一封来自一个早已被遗忘的时代的五个神秘朋友写给他的信。他能拯救所有人吗？</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="周报" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/%E5%91%A8%E6%8A%A5/"/>
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/tags/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="周报" scheme="https://blog.rxliuli.com/tags/%E5%91%A8%E6%8A%A5/"/>
    
    <category term="读书" scheme="https://blog.rxliuli.com/tags/%E8%AF%BB%E4%B9%A6/"/>
    
  </entry>
  
  <entry>
    <title>读书清单</title>
    <link href="https://blog.rxliuli.com/p/bfdfebadf5fe473bb59be6665f98603b/"/>
    <id>https://blog.rxliuli.com/p/bfdfebadf5fe473bb59be6665f98603b/</id>
    <published>2022-12-01T12:06:26.747Z</published>
    <updated>2022-12-02T05:14:36.544Z</updated>
    
    <content type="html"><![CDATA[<h2 id="正作"><a href="#正作" class="headerlink" title="正作"></a>正作</h2><table><thead><tr><th>已读</th><th>名字</th></tr></thead><tbody><tr><td>x</td><td>程序员修炼之道</td></tr><tr><td>x</td><td>码农翻身：用故事给技术加点料</td></tr><tr><td>x</td><td>失乐园</td></tr><tr><td></td><td>圣经</td></tr><tr><td></td><td>一千零一夜</td></tr><tr><td>x</td><td>北欧神话</td></tr><tr><td></td><td>被嫌弃的松子的一生</td></tr><tr><td>x</td><td>穿越平行宇宙</td></tr><tr><td></td><td>纯粹理性批判-康德</td></tr><tr><td>x</td><td>单身社会</td></tr><tr><td>x</td><td>低智商社会-如何从智商衰退中跳脱出来</td></tr><tr><td>x</td><td>动物庄园</td></tr><tr><td></td><td>二十年目睹之怪现状</td></tr><tr><td>x</td><td>福泽谕吉劝学</td></tr><tr><td>未看完</td><td>格林童话全集</td></tr><tr><td></td><td>古今数学思想</td></tr><tr><td></td><td>谎言帝国-中国鸡年纪行</td></tr><tr><td>x</td><td>寂静的春天</td></tr><tr><td>x</td><td>寂静之城</td></tr><tr><td>x</td><td>橘子少女</td></tr><tr><td></td><td>绝对笑喷之弃业医生日志</td></tr><tr><td>x</td><td>了不起的盖茨比</td></tr><tr><td></td><td>利维坦-论国家</td></tr><tr><td></td><td>亮剑</td></tr><tr><td>未看完</td><td>刘慈欣作品集</td></tr><tr><td>x</td><td>罗密欧与朱丽叶</td></tr><tr><td>x</td><td>玛雅</td></tr><tr><td></td><td>美国反对美国</td></tr><tr><td></td><td>魔鬼物理学</td></tr><tr><td>x</td><td>贫穷的本质-我们为什么摆脱不了贫穷</td></tr><tr><td></td><td>人工智能</td></tr><tr><td>x</td><td>人间失格</td></tr><tr><td></td><td>三国演义</td></tr><tr><td>x</td><td>苏菲的世界</td></tr><tr><td></td><td>天地翻覆-中国文化大革命史</td></tr><tr><td>x</td><td>童年的消逝</td></tr><tr><td>x</td><td>万物发明指南</td></tr><tr><td></td><td>银河铁道之夜</td></tr><tr><td>x</td><td>银河系漫游指南</td></tr><tr><td></td><td>月亮与六便士</td></tr><tr><td>未看完</td><td>知行合一王阳明</td></tr><tr><td>x</td><td>纸牌的秘密</td></tr><tr><td></td><td>追忆似水年华</td></tr><tr><td></td><td>资本论</td></tr><tr><td></td><td>自然生活的数学原理</td></tr><tr><td>x</td><td>自私的基因</td></tr><tr><td></td><td>我们从未现代过-对称性人类学论</td></tr><tr><td></td><td>刀锋</td></tr><tr><td></td><td>这就是投资人</td></tr><tr><td></td><td>这就是保险代理人</td></tr><tr><td></td><td>数学女孩</td></tr><tr><td>x</td><td>网络是怎么连接的</td></tr><tr><td>x</td><td>论人类不平等的起源</td></tr><tr><td></td><td>TCP 详解（1）</td></tr><tr><td></td><td>TCP 详解（2）</td></tr><tr><td></td><td>TCP 详解（3）</td></tr><tr><td>x</td><td>规模</td></tr><tr><td></td><td>爆裂</td></tr><tr><td></td><td>原则</td></tr><tr><td></td><td>金字塔原理</td></tr><tr><td></td><td>上帝造人有多难</td></tr><tr><td>x</td><td>大学之路</td></tr><tr><td></td><td>女士品茶</td></tr><tr><td></td><td>增长的极限</td></tr><tr><td>x</td><td>被讨厌的勇气</td></tr><tr><td>x</td><td>来自新世界</td></tr><tr><td></td><td>异类</td></tr><tr><td>x</td><td>宇宙-从起源到未来</td></tr><tr><td></td><td>修改代码的艺术</td></tr><tr><td>x</td><td>解忧杂货铺</td></tr><tr><td>x</td><td>朝花夕拾</td></tr><tr><td></td><td>地铁</td></tr><tr><td>x</td><td>神雕侠侣</td></tr><tr><td>x</td><td>家有女友</td></tr><tr><td>x</td><td>SICP 计算机程序的构造和解释</td></tr><tr><td>x</td><td>颓废与沉默-透视犬儒文化</td></tr><tr><td>x</td><td>人以什么理由来记忆</td></tr><tr><td>x</td><td>富兰克林自传</td></tr><tr><td>x</td><td>野草</td></tr><tr><td></td><td>数学之美</td></tr><tr><td>x</td><td>格局</td></tr><tr><td>x</td><td>见识</td></tr><tr><td>x</td><td>态度</td></tr><tr><td>x</td><td>浪潮之巅</td></tr><tr><td>x</td><td>美国众神</td></tr><tr><td>x</td><td>你不了解的真相</td></tr><tr><td>x</td><td>这就是软件工程师</td></tr><tr><td></td><td>信息论</td></tr><tr><td></td><td>集异壁之大成</td></tr><tr><td>x</td><td>JavaScript 设计模式</td></tr><tr><td>x</td><td>人月神话</td></tr><tr><td></td><td>算法导论</td></tr><tr><td>x</td><td>人类简史</td></tr><tr><td></td><td>什么是数学</td></tr><tr><td>x</td><td>拉普拉斯妖的魔女</td></tr><tr><td>x</td><td>黑客与画家</td></tr></tbody></table><h2 id="轻小说"><a href="#轻小说" class="headerlink" title="轻小说"></a>轻小说</h2><table><thead><tr><th>已读</th><th>名字</th></tr></thead><tbody><tr><td>x</td><td>关于我转生后成为史莱姆的那件事</td></tr><tr><td></td><td>回复术士的重启人生</td></tr><tr><td></td><td>魔法禁书目录</td></tr><tr><td>x</td><td>魔法少女小圆 飞向星空</td></tr><tr><td></td><td>魔女之旅</td></tr><tr><td>x</td><td>魔王勇者</td></tr><tr><td>x</td><td>女高中生小春在异世界成为娼妓</td></tr><tr><td>x</td><td>骑士与魔法</td></tr><tr><td></td><td>文学少女</td></tr><tr><td>x</td><td>问题儿童都来自异世界</td></tr><tr><td>x</td><td>我不是说了能力要平均值么</td></tr><tr><td>x</td><td>无职转生</td></tr><tr><td></td><td>仰望半月的夜空</td></tr><tr><td></td><td>要听爸爸的话</td></tr><tr><td>x</td><td>游戏人生</td></tr><tr><td>x</td><td>转生成蜘蛛又怎样</td></tr><tr><td>x</td><td>OVERLORD 不死者之王</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="其他" scheme="https://blog.rxliuli.com/categories/%E5%85%B6%E4%BB%96/"/>
    
    <category term="读书" scheme="https://blog.rxliuli.com/categories/%E5%85%B6%E4%BB%96/%E8%AF%BB%E4%B9%A6/"/>
    
    
    <category term="读书" scheme="https://blog.rxliuli.com/tags/%E8%AF%BB%E4%B9%A6/"/>
    
  </entry>
  
  <entry>
    <title>2022 年终总结及 2023 的计划</title>
    <link href="https://blog.rxliuli.com/p/48334b653bc9470aae86d06519a907ec/"/>
    <id>https://blog.rxliuli.com/p/48334b653bc9470aae86d06519a907ec/</id>
    <published>2022-11-29T03:20:50.820Z</published>
    <updated>2022-12-17T17:33:14.134Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="/p/971404f2f72c429083a614f8ee522237">2021 年终总结及 2022 的计划</a></p></blockquote><h2 id="年终总结"><a href="#年终总结" class="headerlink" title="年终总结"></a>年终总结</h2><p>具体来讲</p><ul><li>补足和实践理论层面的知识 – 看完了 sicp 课程</li><li>继续维护和改进 liuli-tools/liuli-utils – 继续维护中</li><li>继续维护 joplin-utils 系列的笔记相关工具 – joplin-vscode-plugin 发布 1.0，从 joplin-blog 衍生出 mami</li><li>提高发布博客的质量，而不是简单的笔记映射 – 目前仍然从笔记映射，这是正确的方法。</li><li>参与一些知名的开源项目并提 PR，而非仅仅做自己的东西 – 今年提了 15 个 pr，合并了 14 个</li></ul><p>生活上希望更加自律和保持精神，希望下面几件事情都有一些进展</p><ul><li>保持作息规律，日常水果和牛奶补充营养 – 日常水果和牛奶已经完全做到了，作息规律仍然时好时坏</li><li>开始一些简单的锻炼，例如跑步 – 由节奏光剑 vr 替代</li><li>尝试更多工作之外基于现实的社交活动 – 无</li><li>kigurumi 出一些室外日常照片 – 无</li></ul><p>开的一些新坑</p><ul><li><a href="https://mami.rxliuli.com/">mami</a>: 基于 markdown 的跨工具转换器，支持 joplin/obsidian/hexo/hugo/docsify</li><li><a href="https://marketplace.visualstudio.com/items?itemName=rxliuli.tsx">tsx-vscode</a>: 在 vscode 中集成 tsx 运行任意 ts/js 文件，用于替代付费的 quokka</li><li><a href="https://marketplace.visualstudio.com/items?itemName=rxliuli.new-project">new-project</a>: 创建项目的可视化引导面板，复刻 jetbrains ide 的相同功能</li><li><a href="https://github.com/rxliuli/mdbook">mdbook</a>: 从 markdown 生成 epub 的工具，主要处理中文 markdown 的一些问题</li><li><a href="https://tts.liuli.moe/">to-the-stars</a>: 魔法少女小圆 飞向星空同人小说维护，负责生成 epub 和在线网站</li><li><a href="https://magia.rxliuli.com/">magia</a>: 一个可爱的关于魔法少女网站的重写，主要尝试了 css 动画</li><li><a href="https://rxliuli.github.io/hanoi/">hanoi</a>: 汉诺塔游戏，在学习 sicp 时创建的</li><li><a href="https://github.com/rxliuli/saki">saki</a>: 尝试实用 golang 重写 cli 以提高性能的实验</li><li><a href="http://rxliuli.com/">rxliuli</a>: 个人主页，重写了 v2 版本</li></ul><p>技术方面踩的新坑有</p><ul><li>mdast: 大量使用的 markdown 解析器，灵活且强大</li><li>esm only: 好吧，一开始吾辈对它并不满意，但自 nodejs 16 以来已然大势所趋了</li><li>tsup: 使用它替代了 liuli-cli，它是开箱即用的 lib 构建工具</li><li>changeset: monorepo npm 发布工具，与 pnpm 结合使用体验不错</li><li>recast: ast 操作工具，用于代码生成或批量代码重构</li><li>preact: 实用 preact，目前几乎总是推荐使用它而非 react，尤其是在不需要 react ui 库的情况下</li><li>nx.js: monorepo 工具，尝试并决定放弃，使用起来过于复杂，无法开箱即用</li><li>turbo: monorepo 工具，正在尝试，在许多情况下看起来也不一定需要</li></ul><p>blog 方面一共发布了 35 篇，其中也包括了一些非技术性的内容。</p><p>github 贡献图，好吧好吧，今年确实少了很多，奇怪的倦怠期？<br><img src="/resources/f93da9fc420942c3b092b65ae6579752.png" alt="1669860164904.png"></p><p>另外值得一提是维护了《魔法少女小圆 飞向星空》同人小说中文翻译开源项目，吾辈真的很喜欢这部小说，是吾辈看到的第三部以科幻的方法写动画同人小说，任何喜欢《魔法少女小圆》的人都可以看看，吾辈愿意称之为最好的《魔法少女小圆》同人小说，在线地址：<a href="https://tts.liuli.moe/">https://tts.liuli.moe/</a><br><img src="https://github.com/liuli-moe/to-the-stars/raw/master/books/01/assets/cover.png" alt="cover"></p><h2 id="工作方面"><a href="#工作方面" class="headerlink" title="工作方面"></a>工作方面</h2><p>年初的计划完成情况</p><ul><li>希望明年遇到更有趣的人，做一些更有趣的事 – 前者我认为有一个，后者参考通用部分</li><li>希望明年整个公司技术团队的效率变高，而非现在如此<strong>低效</strong>，尤其是跨团队合作 – 老实说没有本质变化，只是更熟悉 som 相关的接口而已。前后端对接自动化方面还是尚需解决</li><li>做的事情在实际场景中使用，而不仅仅是<strong>玩具</strong> – 在 3 个场景交付，但 uv 仅有 200+ 而已</li><li>希望明年能够依赖于文档或 FAQ 解决问题，而非依赖于人力 – 文档确实增加了许多，api 聚合和 demo/playground 可能会有一些帮助</li><li>更好在团队中推广技术 – 仅分享了一些 blog 上的内容</li><li>让技术探索走在更远的地方 – 参考通用部分</li><li>尝试系统化，而不仅仅是依赖于经验 – 学习了 sicp，实现过 <code>stream</code>/<code>lisp parser/evaler</code></li></ul><h2 id="来年的计划"><a href="#来年的计划" class="headerlink" title="来年的计划"></a>来年的计划</h2><ul><li>日语学习，这是从今年北京疫情之后下半年开始的一个想法，它的中长期优先级是最高的 – 指明年上半年</li><li>解决前后端接口通信与协作的问题，这是一个常见但仍未解决的问题，包括 grpc/graphql/fass 的接口，提供 online/vscode plugin/codegen</li><li>尝试在应用层面使用 ai 相关的技术 – 不过这个吾辈还不确定，似乎 GPT-3 之类的高级 AI 必须要大型计算中心才能训练，个人似乎无法折腾 ai 了？或者可以使用 api 之类的直接开发业务层应用，不过尚未确定范围</li><li><code>@mami/*</code> 系列支持更多框架和类型，实现 gui 客户端支持普通用户使用</li></ul><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>从 2018 年开始，已经工作了快 5 年了，虽然经历过几份工作，在业余时间也多有折腾，但技能层次上还是没有得到质的提升。上次遇到瓶颈的时候吾辈从后端转向了前端，但这次卡住又当如何呢？</p>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="年终总结" scheme="https://blog.rxliuli.com/categories/%E4%B8%AA%E4%BA%BA/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"/>
    
    
    <category term="个人" scheme="https://blog.rxliuli.com/tags/%E4%B8%AA%E4%BA%BA/"/>
    
    <category term="开源" scheme="https://blog.rxliuli.com/tags/%E5%BC%80%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>windows 10 -- 广告系统</title>
    <link href="https://blog.rxliuli.com/p/b7bf3d9e766e4829b32d915008e736c7/"/>
    <id>https://blog.rxliuli.com/p/b7bf3d9e766e4829b32d915008e736c7/</id>
    <published>2022-11-25T13:36:23.048Z</published>
    <updated>2022-11-25T13:57:04.268Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>正版受害者 +1，卖 2k+ 软妹币的生产系统居然到处都是广告，而且还很难关闭，和国内的这些恶心软件公司学坏了。</p></blockquote><p>好吧，刚刚在使用 Windows 搜索某个应用时出现了广告，之前可能还没留意，但这次看到真的瞬间爆炸，浓浓的国产狗皮膏药式的广告，没什么用还占了好大一片地方，微软这是直接在操作系统级别打广告了。</p><p><img src="/resources/aaefd6438fcd48d68f62fc2478f1f857.png" alt="1669384280333.png"></p><p>在尝试在系统设置中寻找未果后，使用 Google 搜索了一下，在这篇 <a href="https://www.baiyunxitong.com/bangzhu/7714.html">Win10 搜索框中热门搜索怎么关闭</a> 网页中找到了答案，发现居然要使用注册表才能关闭这个广告。好家伙，真的好家伙，这已经完全可以称得上是居心不良了！下一个 miui 就是你么？</p><p>直接使用以下命令修改注册表然后重启即可</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">reg add HKCU\Software\Policies\Microsoft\Windows\explorer /v DisableSearchBoxSuggestions /t reg_dword /d 1 /f<br></code></pre></td></tr></tbody></table></figure><p>去除广告后的效果，但这也只是一个点，之前的点击通知栏会出现奇怪的资讯信息也是，也不过是 Windows 继续变烂的一部分就是了。</p><p><img src="/resources/1666773381144003aaddb19f2529e67b.png" alt="1669383400633.png"></p><p>结语</p><p>Windows 整天不干别的折腾这种歪门邪道起来了，也不看看隔壁 m1 有多香，太烦人了，或许什么时候换个 m2？</p>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="其他" scheme="https://blog.rxliuli.com/categories/%E5%85%B6%E4%BB%96/"/>
    
    <category term="Windows" scheme="https://blog.rxliuli.com/categories/%E5%85%B6%E4%BB%96/Windows/"/>
    
    
    <category term="windows" scheme="https://blog.rxliuli.com/tags/windows/"/>
    
    <category term="杂谈" scheme="https://blog.rxliuli.com/tags/%E6%9D%82%E8%B0%88/"/>
    
  </entry>
  
  <entry>
    <title>web 文件系统探索</title>
    <link href="https://blog.rxliuli.com/p/b0cb4560702945069f8c885bc5244ef8/"/>
    <id>https://blog.rxliuli.com/p/b0cb4560702945069f8c885bc5244ef8/</id>
    <published>2022-11-25T13:11:15.276Z</published>
    <updated>2022-11-25T15:13:34.833Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>浏览器到了今天已经非常强大了，足以称之为操作系统。很多人（包括吾辈）可能对网页的印象仍然停留在网站，一些非富交互式的的应用，只是用来展示和操作后端数据，但复杂程度不高。而在最近，吾辈发现了 <a href="https://web.dev/file-system-access/">file system access api</a>，它是 chrome 推出的一组可以操作本地文件的 api，这也是第一次可以直接将文件写入到本地而不需要使用 indexeddb 之类的模拟的方法。虽然尚不完善，但已经足以让 sqlite 这种项目开始考虑支持在 web 上基于文件系统实现支持了，参考：<a href="https://sqlite.org/wasm/doc/ckout/index.md">https://sqlite.org/wasm/doc/ckout/index.md</a>。</p><p>那么，就算有了文件系统，我们能做什么呢？</p><ul><li>首先，我们有可能不再需要 nodejs，尽管 nodejs 提供了各式各样的 api，但最常用的也只有 fs/fetch 罢了，浏览器的原生支持意味着只需要这两个 api 的应用不需要使用 nodejs 了</li><li>其次，我们之前提到的一些应用不再需要使用 electron 打包，例如图片编辑器、drawio 之类的，都不再需要 electron 客户端了</li><li>最后，某些依赖于文件系统的 lib 可以在 web 上复用，例如上面提到的 sqlite 数据库</li></ul><p>下面将使用文件系统 api 尝试写一个基本的图片查看器，它将做到以下几件事以尽可能贴近原生应用的行为</p><ol><li>安装之后可以离线访问</li><li>支持从资源管理器打开图片</li><li>支持拖拽图片</li><li>窗口尺寸记忆支持</li></ol><p><img src="https://github.com/rxliuli/image-viewer/raw/master/docs/demo.gif" alt="最终效果"></p><p>以下会涉及到各种常见 web 开发中不那么常见的东西，仅做提及不做深入，相关资料建议参考 <a href="https://web.dev/">https://web.dev/</a></p><ul><li>service worker: web 离线支持</li><li>manifest.json: web 应用元数据</li><li>file system access api: 文件系统</li><li>preact: react 的一个更小的实现</li></ul><h2 id="拖拽图片显示"><a href="#拖拽图片显示" class="headerlink" title="拖拽图片显示"></a>拖拽图片显示</h2><p>首先，我们实现一个可以拖拽图片到网页并显示的 web 应用，好吧，这实际上没什么难的。这里的关键是通过 event 获取到 File 对象，然后就可以创建 blob url 渲染图片了。</p><figure class="highlight tsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">import</span> css <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.module.css'</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">'file-system-access'</span><br><span class="hljs-keyword">import</span> { useEffect, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'preact/hooks'</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) {<br>  <span class="hljs-keyword">const</span> [url, setUrl] = useState&lt;<span class="hljs-built_in">string</span>&gt;()<br><br>  <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">onDrop</span>(<span class="hljs-params">ev: DragEvent</span>) {<br>    ev.<span class="hljs-title function_">preventDefault</span>()<br>    <span class="hljs-keyword">const</span> items = [...(ev.<span class="hljs-property">dataTransfer</span>?.<span class="hljs-property">items</span> ?? [])].<span class="hljs-title function_">filter</span>(<br>      <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-property">kind</span> === <span class="hljs-string">'file'</span> &amp;&amp; item.<span class="hljs-property">type</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'image/'</span>),<br>    )<br>    <span class="hljs-keyword">if</span> (items.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {<br>      <span class="hljs-title function_">alert</span>(<span class="hljs-string">'找不到图片文件'</span>)<br>      <span class="hljs-keyword">return</span><br>    }<br>    <span class="hljs-keyword">const</span> file = items[<span class="hljs-number">0</span>].<span class="hljs-title function_">getAsFile</span>()<br>    <span class="hljs-keyword">if</span> (!file) {<br>      <span class="hljs-title function_">alert</span>(<span class="hljs-string">'无法读取文件'</span>)<br>      <span class="hljs-keyword">return</span><br>    }<br>    <span class="hljs-title function_">setUrl</span>(<span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(file))<br>  }<br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">onDragOver</span>(<span class="hljs-params">ev: DragEvent</span>) {<br>    ev.<span class="hljs-title function_">preventDefault</span>()<br>  }<br>  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {<br>    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'drop'</span>, onDrop)<br>    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'dragover'</span>, onDragOver)<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {<br>      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'drop'</span>, onDrop)<br>      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'dragover'</span>, onDragOver)<br>    }<br>  }, [])<br>  <span class="hljs-keyword">return</span> url ? (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">{css.img}</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{url}</span> /&gt;</span></span><br>  ) : (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">{css.content}</span>&gt;</span>拖拽图片到这儿<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>}<br></code></pre></td></tr></tbody></table></figure><p>当然，这里需要需要导入 file-system-access 模块，因为这个 api 是 chrome 系独有，firefox/safari 不支持，需要使用 polyfill 添加正确的类型定义。</p><p><img src="/resources/41b8430a157c45c5a82f19f06c05065a.png" alt="1669386555147.png"></p><h2 id="pwa-实现"><a href="#pwa-实现" class="headerlink" title="pwa 实现"></a>pwa 实现</h2><p>虽然我们实现了一个简单的 web 网站，但它并不能安装到系统，这里我们需要让它变成 pwa 应用。我不准备解释它是什么，因为吾辈也没怎么太多了解，具体可以参考：<a href="https://web.dev/learn/pwa/">https://web.dev/learn/pwa/</a>，这是一个很长的列表。<br>幸运的是，吾辈使用的 vite 有一个插件可以开箱即用的做到这一点，它是 <a href="https://vite-pwa-org.netlify.app/">vite-plugin-pwa</a><br>吾辈安装它之后仍然需要配置，因为吾辈想要</p><ul><li>自定义应用的显示名，使用 <code>name/short_name</code></li><li>自定义应用 icon，使用 <code>icons</code></li></ul><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span><br><span class="hljs-keyword">import</span> preact <span class="hljs-keyword">from</span> <span class="hljs-string">'@preact/preset-vite'</span><br><span class="hljs-keyword">import</span> { cssdts } <span class="hljs-keyword">from</span> <span class="hljs-string">'@liuli-util/vite-plugin-css-dts'</span><br><span class="hljs-keyword">import</span> { <span class="hljs-title class_">VitePWA</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite-plugin-pwa'</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-title function_">preact</span>(),<br>    <span class="hljs-title function_">cssdts</span>(),<br>    <span class="hljs-title class_">VitePWA</span>({<br>      <span class="hljs-attr">registerType</span>: <span class="hljs-string">'autoUpdate'</span>,<br>      <span class="hljs-attr">devOptions</span>: {<br>        <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span>,<br>      },<br>      <span class="hljs-attr">manifest</span>: {<br>        <span class="hljs-attr">id</span>: <span class="hljs-string">'rxliuli.image-viewer'</span>,<br>        <span class="hljs-attr">short_name</span>: <span class="hljs-string">'图片查看器'</span>,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">'图片查看器'</span>,<br>        <span class="hljs-attr">icons</span>: [<br>          {<br>            <span class="hljs-attr">src</span>: <span class="hljs-string">'/icons/logo512x512.png'</span>,<br>            <span class="hljs-attr">sizes</span>: <span class="hljs-string">'512x512'</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">'image/png'</span>,<br>          },<br>          {<br>            <span class="hljs-attr">src</span>: <span class="hljs-string">'/icons/logo.svg'</span>,<br>            <span class="hljs-attr">sizes</span>: <span class="hljs-string">'any'</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">'image/svg'</span>,<br>          },<br>        ],<br>      },<br>    }),<br>  ],<br>})<br></code></pre></td></tr></tbody></table></figure><p>现在，它应该可以被安装并作为独立窗口打开了，并且能在的应用程序列表中看到</p><p><img src="/resources/9bf1c2d16d8c4b1aa1d46219a9beb675.png" alt="1669386797740.png"><br><img src="/resources/cc3114f170ac4be89e1ab96113afea02.png" alt="1669386739999.png"><br><img src="/resources/9449067cd9e9496cb9bbf166c9c13ba7.png" alt="1669386864465.png"></p><h2 id="与文件系统集成"><a href="#与文件系统集成" class="headerlink" title="与文件系统集成"></a>与文件系统集成</h2><p>虽然安装到系统中，但它现在仍然没有集成到系统的文件管理器中 – 许多原生应用程序都允许从文件管理器中打开特定类型的文件。想要做到做到这一点，需要做两件事情</p><ol><li>在 manifest 中声明 <code>file_handlers</code></li><li>访问 <code>window.launchQueue</code> 获取打开的文件</li></ol><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-comment">// 其他配置...</span><br>    <span class="hljs-title class_">VitePWA</span>({<br>      <span class="hljs-comment">// 其他配置...</span><br>      <span class="hljs-attr">manifest</span>: {<br>        <span class="hljs-comment">// 其他配置...</span><br>        <span class="hljs-attr">file_handlers</span>: [<br>          {<br>            <span class="hljs-attr">action</span>: <span class="hljs-string">'./'</span>,<br>            <span class="hljs-attr">accept</span>: {<br>              <span class="hljs-comment">// ref: https://developer.mozilla.org/zh-CN/docs/Web/Media/Formats/Image_types</span><br>              <span class="hljs-string">'image/*'</span>: [<br>                <span class="hljs-string">'.apng'</span>,<br>                <span class="hljs-string">'.avif'</span>,<br>                <span class="hljs-string">'.bmp'</span>,<br>                <span class="hljs-string">'.gif'</span>,<br>                <span class="hljs-string">'.ico'</span>,<br>                <span class="hljs-string">'.cur'</span>,<br>                <span class="hljs-string">'.jpg'</span>,<br>                <span class="hljs-string">'.jpeg'</span>,<br>                <span class="hljs-string">'.jfif'</span>,<br>                <span class="hljs-string">'.pjpeg'</span>,<br>                <span class="hljs-string">'.pjp'</span>,<br>                <span class="hljs-string">'.png'</span>,<br>                <span class="hljs-string">'.svg'</span>,<br>                <span class="hljs-string">'.tif'</span>,<br>                <span class="hljs-string">'.tiff'</span>,<br>                <span class="hljs-string">'.webp'</span>,<br>              ],<br>            },<br>          },<br>        ],<br>      },<br>    }),<br>  ],<br>})<br></code></pre></td></tr></tbody></table></figure><p>好吧，可能是这个 api 太新（chrome 102 添加），导致现在仍然没有类型定义，不过这不复杂，所以自己定义一下</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">declare</span> <span class="hljs-variable language_">global</span> {<br>  <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">launchQueue</span>: <span class="hljs-title class_">LaunchQueue</span><br><br>  <span class="hljs-keyword">interface</span> <span class="hljs-title class_">LaunchQueue</span> {<br>    <span class="hljs-title function_">setConsumer</span>(<span class="hljs-attr">consumer</span>: <span class="hljs-title class_">LaunchConsumer</span>): <span class="hljs-built_in">void</span><br>  }<br><br>  <span class="hljs-keyword">interface</span> <span class="hljs-title class_">LaunchConsumer</span> {<br>    (<span class="hljs-attr">launchParams</span>: <span class="hljs-title class_">LaunchParams</span>): <span class="hljs-built_in">void</span><br>  }<br><br>  <span class="hljs-keyword">class</span> <span class="hljs-title class_">LaunchParams</span> {<br>    <span class="hljs-keyword">readonly</span> <span class="hljs-attr">files</span>: <span class="hljs-keyword">readonly</span> <span class="hljs-title class_">FileSystemFileHandle</span>[]<br>  }<br>}<br></code></pre></td></tr></tbody></table></figure><p>然后就可以访问它了</p><figure class="highlight tsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) {<br>  <span class="hljs-comment">// 其他代码...</span><br>  <span class="hljs-keyword">const</span> [mounted, setMounted] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>)<br>  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {<br>    <span class="hljs-keyword">if</span> (<span class="hljs-string">'launchQueue'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span> &amp;&amp; <span class="hljs-string">'files'</span> <span class="hljs-keyword">in</span> <span class="hljs-title class_">LaunchParams</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>) {<br>      launchQueue.<span class="hljs-title function_">setConsumer</span>(<span class="hljs-keyword">async</span> (launchParams) =&gt; {<br>        <span class="hljs-keyword">if</span> (!launchParams.<span class="hljs-property">files</span>.<span class="hljs-property">length</span>) {<br>          <span class="hljs-keyword">return</span><br>        }<br>        <span class="hljs-title function_">setUrl</span>(<span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(<span class="hljs-keyword">await</span> launchParams.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>].<span class="hljs-title function_">getFile</span>()))<br>      })<br>    }<br>    <span class="hljs-title function_">setMounted</span>(<span class="hljs-literal">true</span>)<br>  }, [])<br>  <span class="hljs-keyword">return</span> (<br>    mounted &amp;&amp;<br>    (url ? (<br>      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">{css.img}</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{url}</span> /&gt;</span></span><br>    ) : (<br>      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">{css.content}</span>&gt;</span>拖拽图片到这儿<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    ))<br>  )<br>}<br></code></pre></td></tr></tbody></table></figure><p>现在，我们可以从系统文件管理器中打开它了</p><p><img src="/resources/6e028b5f898d4ac097769594dcf4a2e8.png" alt="1669387508422.png"></p><p>如果你想尝试它，可以访问 <a href="https://image-viewer.rxliuli.com/">https://image-viewer.rxliuli.com/</a> 安装尝试</p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>有趣的是，chrome 仍然在不断添加各种各样的 api 到 web 上，以尽可能缩小与原生应用的功能差异。在 <a href="https://developer.chrome.com/docs/web-platform/">chrome 开发者文档中</a> 可以看到各种各样奇怪的 api，某些看起来与传统意义上的 web 网站大相径庭，甚至有人吐槽说：“applet: 不行，web api: 行”。话虽如此，兜兜转转，发展的螺旋式又转回了这一边。</p><blockquote><p>完整项目见：<a href="https://github.com/rxliuli/image-viewer">https://github.com/rxliuli/image-viewer</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="前端" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="Web API" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/Web-API/"/>
    
    
    <category term="javascript" scheme="https://blog.rxliuli.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>实用 vue3 script setup</title>
    <link href="https://blog.rxliuli.com/p/452a85351b7f4a31b56cf25eb9d3ba50/"/>
    <id>https://blog.rxliuli.com/p/452a85351b7f4a31b56cf25eb9d3ba50/</id>
    <published>2022-11-10T11:16:46.652Z</published>
    <updated>2023-02-17T05:12:23.663Z</updated>
    
    <content type="html"><![CDATA[<h2 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h2><blockquote><p><a href="https://cn.vuejs.org/api/sfc-script-setup.html">官方文档</a></p></blockquote><p>在两年前，vue3 发布之后不久创建了一个 <a href="https://github.com/vuejs/rfcs/blob/master/active-rfcs/0040-script-setup.md">sfc 提案</a>，它允许所有 script 中顶级变量默认绑定到模板，以消除和 react 的开发者体验的差距之一。</p><p>大概长这样</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup&gt;<br>// imported components are also directly usable in template<br>import Foo from './Foo.vue'<br>import { ref } from 'vue'<br><br>// write Composition API code just like in a normal setup()<br>// but no need to manually return everything<br>const count = ref(0)<br>const inc = () =&gt; {<br>  count.value++<br>}<br>&lt;/script&gt;<br><br>&lt;template&gt;<br>  &lt;Foo :count="count" @click="inc" /&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></tbody></table></figure><p>第一感觉：现在真就 vue script 了<br>实际使用：真香</p><p>它确实解决了一些固有的问题</p><ul><li>template 无法访问 js 值域</li><li><code>defineProps/defineEmits</code> 无法复用类型定义</li></ul><p>经过两年之后，它确实能够在生产中使用了，即便可能仍然不算完美，下面将描述它主要解决的两个问题以及与其他方法的差异</p><h2 id="template-访问-js-值域"><a href="#template-访问-js-值域" class="headerlink" title="template 访问 js 值域"></a>template 访问 js 值域</h2><p>在 react 中，我们可以直接在 jsx 中访问任意 js 值域。例如 import 一个变量，并在 jsx 中使用。</p><figure class="highlight tsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">List</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span><br><span class="hljs-keyword">import</span> { uniq } <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash-es'</span><br><span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) {<br>  <span class="hljs-keyword">const</span> [list] = <span class="hljs-title function_">useState</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>])<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">List</span></span></span><br><span class="hljs-tag"><span class="language-xml">      <span class="hljs-attr">dataSource</span>=<span class="hljs-string">{uniq(list)}</span></span></span><br><span class="hljs-tag"><span class="language-xml">      <span class="hljs-attr">renderItem</span>=<span class="hljs-string">{(item)</span> =&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">List.Item.Meta</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item}</span> <span class="hljs-attr">title</span>=<span class="hljs-string">{item}</span> /&gt;</span>}</span><br><span class="language-xml">    /&gt;</span><br>  )<br>}<br></code></pre></td></tr></tbody></table></figure><p>在 vue2 中，template 能访问的值必须注册到 vue 中，不管是 <code>data/methods/components</code></p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script lang="ts"&gt;<br>import { defineComponent } from 'vue'<br>import { List, ListItemMeta } from 'ant-design-vue'<br>import { uniq } from 'lodash-es'<br><br>export default defineComponent({<br>  components: { List, ListItemMeta },<br>  data: () =&gt; ({<br>    list: [1, 2, 1],<br>  }),<br>  methods: {<br>    uniq,<br>  },<br>})<br>&lt;/script&gt;<br><br>&lt;template&gt;<br>  &lt;List :data-source="uniq(list)"&gt;<br>    &lt;template #renderItem="{ item }"&gt;<br>      &lt;ListItemMeta :title="item" /&gt;<br>    &lt;/template&gt;<br>  &lt;/List&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></tbody></table></figure><p>在 vue3 中，虽然有了 hooks，但仍然未解决 js 值域的问题，只是可以通过 setup 统一暴露给 template</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script lang="ts"&gt;<br>import { defineComponent, ref } from 'vue'<br>import { List, ListItemMeta } from 'ant-design-vue'<br>import { uniq } from 'lodash-es'<br><br>export default defineComponent({<br>  components: { List, ListItemMeta },<br>  setup() {<br>    const list = ref([1, 2, 1])<br>    return { list, uniq }<br>  },<br>})<br>&lt;/script&gt;<br><br>&lt;template&gt;<br>  &lt;List :data-source="uniq(list)"&gt;<br>    &lt;template #renderItem="{ item }"&gt;<br>      &lt;ListItemMeta :title="item" /&gt;<br>    &lt;/template&gt;<br>  &lt;/List&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></tbody></table></figure><p>但 vue3 setup script 中，则部分解决了这个问题，所有在 script 中的值均可以在 template 中访问</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script lang="ts" setup&gt;<br>import { ref } from 'vue'<br>import { List, ListItemMeta } from 'ant-design-vue'<br>import { uniq } from 'lodash-es'<br>const list = ref([1, 2, 1])<br>&lt;/script&gt;<br><br>&lt;template&gt;<br>  &lt;List :data-source="uniq(list)"&gt;<br>    &lt;template #renderItem="{ item }"&gt;<br>      &lt;ListItemMeta :title="item" /&gt;<br>    &lt;/template&gt;<br>  &lt;/List&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></tbody></table></figure><p>可以看到，setup script 已经接近 react jsx 的使用体验了</p><p>当然，你可以在 <a href="https://sfc.vuejs.org/">https://sfc.vuejs.org/</a> 中查看 setup script 的实际编译结果，例如上面的代码会被编译为</p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/* Analyzed bindings: {</span><br><span class="hljs-comment">  "ref": "setup-const",</span><br><span class="hljs-comment">  "List": "setup-maybe-ref",</span><br><span class="hljs-comment">  "ListItemMeta": "setup-maybe-ref",</span><br><span class="hljs-comment">  "uniq": "setup-maybe-ref",</span><br><span class="hljs-comment">  "list": "setup-ref"</span><br><span class="hljs-comment">} */</span><br><span class="hljs-keyword">import</span> { defineComponent <span class="hljs-keyword">as</span> _defineComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span><br><span class="hljs-keyword">import</span> {<br>  unref <span class="hljs-keyword">as</span> _unref,<br>  createVNode <span class="hljs-keyword">as</span> _createVNode,<br>  withCtx <span class="hljs-keyword">as</span> _withCtx,<br>  openBlock <span class="hljs-keyword">as</span> _openBlock,<br>  createBlock <span class="hljs-keyword">as</span> _createBlock,<br>} <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span><br><br><span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span><br><span class="hljs-keyword">import</span> { <span class="hljs-title class_">List</span>, <span class="hljs-title class_">ListItemMeta</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'ant-design-vue'</span><br><span class="hljs-keyword">import</span> { uniq } <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash-es'</span><br><br><span class="hljs-keyword">const</span> __sfc__ = <span class="hljs-comment">/*#__PURE__*/</span> <span class="hljs-title function_">_defineComponent</span>({<br>  <span class="hljs-attr">__name</span>: <span class="hljs-string">'App'</span>,<br>  <span class="hljs-title function_">setup</span>(<span class="hljs-params">__props</span>) {<br>    <span class="hljs-keyword">const</span> list = <span class="hljs-title function_">ref</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>])<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">_ctx, _cache</span>) =&gt;</span> {<br>      <span class="hljs-keyword">return</span> (<br>        <span class="hljs-title function_">_openBlock</span>(),<br>        <span class="hljs-title function_">_createBlock</span>(<br>          <span class="hljs-title function_">_unref</span>(<span class="hljs-title class_">List</span>),<br>          {<br>            <span class="hljs-string">'data-source'</span>: <span class="hljs-title function_">_unref</span>(uniq)(list.<span class="hljs-property">value</span>),<br>          },<br>          {<br>            <span class="hljs-attr">renderItem</span>: <span class="hljs-title function_">_withCtx</span>(<span class="hljs-function">(<span class="hljs-params">{ item }</span>) =&gt;</span> [<br>              <span class="hljs-title function_">_createVNode</span>(<br>                <span class="hljs-title function_">_unref</span>(<span class="hljs-title class_">ListItemMeta</span>),<br>                { <span class="hljs-attr">title</span>: item },<br>                <span class="hljs-literal">null</span>,<br>                <span class="hljs-number">8</span> <span class="hljs-comment">/* PROPS */</span>,<br>                [<span class="hljs-string">'title'</span>],<br>              ),<br>            ]),<br>            <span class="hljs-attr">_</span>: <span class="hljs-number">1</span> <span class="hljs-comment">/* STABLE */</span>,<br>          },<br>          <span class="hljs-number">8</span> <span class="hljs-comment">/* PROPS */</span>,<br>          [<span class="hljs-string">'data-source'</span>],<br>        )<br>      )<br>    }<br>  },<br>})<br>__sfc__.<span class="hljs-property">__file</span> = <span class="hljs-string">'App.vue'</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> __sfc__<br></code></pre></td></tr></tbody></table></figure><p>局限性</p><p>尽管有些改进，但它也确实引发了一些问题</p><ul><li>无法在 setup 中使用 export，因为所有代码都会被编译到 setup 函数中</li></ul><h2 id="defineProps-复用类型定义"><a href="#defineProps-复用类型定义" class="headerlink" title="defineProps 复用类型定义"></a>defineProps 复用类型定义</h2><p>在 tsx 中，另一个很有用的功能是可以直接复用 ts 类型定义，而不需要定义单独的 PropType。实际上，在 react 早期，它也包含内置的 PropType 支持，但最终它们采用了 ts 的类型定义，而 vue 则一直保留了下来，并不得不忍受 ts 类型与 props 类型无法共享的问题，即便它们都在 ts 中。</p><p>例如在 tsx 中我们会这样编写类型</p><figure class="highlight tsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">WindowMeta</span> {<br>  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span><br>  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span><br>  <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span><br>}<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Window</span>(<span class="hljs-params">props: { meta: WindowMeta }</span>) {<br>  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(props.meta, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span></span><br>}<br></code></pre></td></tr></tbody></table></figure><p>在 vue3 没有 defineProps 之前</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script lang="ts"&gt;<br>import { defineComponent, PropType } from 'vue'<br><br>interface WindowMeta {<br>  id: string<br>  title: string<br>  url: string<br>}<br><br>export default defineComponent({<br>  props: {<br>    meta: {<br>      type: Object as PropType&lt;WindowMeta&gt;,<br>      required: true,<br>    },<br>  },<br>})<br>&lt;/script&gt;<br><br>&lt;template&gt;<br>  &lt;pre&gt;{{ JSON.stringify($props.meta, null, 2) }}&lt;/pre&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></tbody></table></figure><p>使用 defineProps 之后</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script lang="ts" setup&gt;<br>interface WindowMeta {<br>  id: string<br>  title: string<br>  url: string<br>}<br><br>defineProps&lt;{<br>  meta: WindowMeta<br>}&gt;()<br>&lt;/script&gt;<br></code></pre></td></tr></tbody></table></figure><p>可以看到，可以直接复用 ts 类型了，不再需要单独定义 vue PropType。你可能发现 defineProps 没有被导入，是的，它们实际上是宏，实际上它们在编译后就不存在了，甚至不会被编译为 vue PropType。下面是编译结果</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">/* Analyzed bindings: {</span><br><span class="hljs-comment">  "meta": "props"</span><br><span class="hljs-comment">} */</span><br><span class="hljs-keyword">import</span> { defineComponent <span class="hljs-keyword">as</span> _defineComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span><br><br><span class="hljs-keyword">const</span> __sfc__ = <span class="hljs-comment">/*#__PURE__*/</span> <span class="hljs-title function_">_defineComponent</span>({<br>  <span class="hljs-attr">__name</span>: <span class="hljs-string">'App'</span>,<br>  <span class="hljs-attr">props</span>: {<br>    <span class="hljs-attr">meta</span>: <span class="hljs-literal">null</span>,<br>  },<br>  <span class="hljs-title function_">setup</span>(<span class="hljs-params">__props</span>) {<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {}<br>  },<br>})<br>__sfc__.<span class="hljs-property">__file</span> = <span class="hljs-string">'App.vue'</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> __sfc__<br></code></pre></td></tr></tbody></table></figure><p>局限性</p><p>虽然看起来不错，但它确实有局限性，例如</p><ul><li><code>defineProps/defineEmits</code> 无法引用外部类型，需要使用额外的插件 <a href="https://github.com/wheatjs/vite-plugin-vue-type-imports">vite-plugin-vue-type-imports</a></li></ul><h2 id="defineEmit-使用类型"><a href="#defineEmit-使用类型" class="headerlink" title="defineEmit 使用类型"></a>defineEmit 使用类型</h2><p>在 react 中不存在 emits/attrs/slots，它们都被整合到 props 中（这是一个非常优雅而强大的设计）。在 vue3 中，emits 可以定义类型，但在 defineEmits 之前，仍然要通过定义值来推导类型。</p><p>例如</p><figure class="highlight tsx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">WindowMeta</span> {<br>  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span><br>  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span><br>  <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span><br>}<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params">props: { onClick(item: WindowMeta): <span class="hljs-built_in">void</span> }</span>) {}<br></code></pre></td></tr></tbody></table></figure><p>在 vue3 之前一般要这样写，定义对象并由 vue 根据值推断类型</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script lang="ts"&gt;<br>import { defineComponent } from 'vue'<br><br>interface WindowMeta {<br>  id: string<br>  title: string<br>  url: string<br>}<br><br>export default defineComponent({<br>  // 注意，此处是一个 js 对象<br>  emits: {<br>    onClick(item: WindowMeta): void {},<br>  },<br>})<br>&lt;/script&gt;<br></code></pre></td></tr></tbody></table></figure><p>在使用 setup script 后，可以使用 ts 类型</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script lang="ts" setup&gt;<br>interface WindowMeta {<br>  id: string<br>  title: string<br>  url: string<br>}<br><br>defineEmits&lt;{<br>  // 这里则是一个类型<br>  (type: 'onClick', item: WindowMeta): void<br>}&gt;()<br>&lt;/script&gt;<br></code></pre></td></tr></tbody></table></figure><p>当然，它会在编译时全部删除掉，仅用于开发时的代码提示和校验</p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/* Analyzed bindings: {} */</span><br><span class="hljs-keyword">import</span> { defineComponent <span class="hljs-keyword">as</span> _defineComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span><br><br><span class="hljs-keyword">const</span> __sfc__ = <span class="hljs-comment">/*#__PURE__*/</span> <span class="hljs-title function_">_defineComponent</span>({<br>  <span class="hljs-attr">__name</span>: <span class="hljs-string">'App'</span>,<br>  <span class="hljs-attr">emits</span>: [<span class="hljs-string">'onClick'</span>],<br>  <span class="hljs-title function_">setup</span>(<span class="hljs-params">__props</span>) {<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {}<br>  },<br>})<br>__sfc__.<span class="hljs-property">__file</span> = <span class="hljs-string">'App.vue'</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> __sfc__<br></code></pre></td></tr></tbody></table></figure><p>也可以使用使用一些工具类型编写更符合直觉的接口</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script lang="ts" setup&gt;<br>import { UnionToIntersection } from 'utility-types'<br><br>type ShortEmits&lt;T&gt; = UnionToIntersection&lt;<br>  {<br>    [P in keyof T]: T[P] extends (...args: any[]) =&gt; any<br>      ? (type: P, ...args: Parameters&lt;T[P]&gt;) =&gt; ReturnType&lt;T[P]&gt;<br>      : never<br>  }[keyof T]<br>&gt;<br><br>interface WindowMeta {<br>  id: string<br>  title: string<br>  url: string<br>}<br><br>defineEmits&lt;<br>  ShortEmits&lt;{<br>    onClick(item: WindowMeta): void<br>  }&gt;<br>&gt;()<br>&lt;/script&gt;<br></code></pre></td></tr></tbody></table></figure><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>它确实解决了一些开发上糟糕的体验，但也引发了一些问题</p><ul><li>必须使用 @vue/compiler-dom 才能处理 vue script 的代码，因为 setup script 意味着它不再是真正的 ts 代码了</li><li>某些更激进的社区方案添加了各种各样的自定义宏，参考 <a href="https://github.com/sxzz/unplugin-vue-macros">unplugin-vue-macros</a></li></ul>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="前端" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="Vue" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/Vue/"/>
    
    
    <category term="typescript" scheme="https://blog.rxliuli.com/tags/typescript/"/>
    
    <category term="vue" scheme="https://blog.rxliuli.com/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>使用 cloudflare workers 代理访问 google photos</title>
    <link href="https://blog.rxliuli.com/p/c826295333d241969663ac463ad63642/"/>
    <id>https://blog.rxliuli.com/p/c826295333d241969663ac463ad63642/</id>
    <published>2022-11-06T09:20:16.041Z</published>
    <updated>2022-11-06T14:58:10.790Z</updated>
    
    <content type="html"><![CDATA[<h2 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h2><p>吾辈使用 Google Photos 作为个人相册，但它的外链却无法在 blog 中使用，而且也无法在国内直接访问，这其实有点麻烦。在此之前，吾辈通过 <a href="https://blog.csdn.net/kaimo313/article/details/119649989">使用外链图片的时候报 403 怎么处理？</a> 了解到 <a href="https://images.weserv.nl/">https://images.weserv.nl</a> 服务，它可以通过 cloudflare cdn 代理访问原本无法直接访问的图片。使用上也很简单，只要在 <a href="https://images.weserv.nl/?url=">https://images.weserv.nl?url=</a> 加上原本图片的路径即可。<br>但在今天偶然一次打开 blog 的时候发现，通过 weserv 外链的图片加载很慢，数量比较多时甚至需要几分钟才能全部加载完成，这是不能忍受的。</p><p><img src="/resources/347adbd7a2f44629abb6d1258f75ac49.png" alt="1667745493673.png"></p><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><blockquote><p>cloudflare workers 的免费层每天最多允许 10w 次请求，对于吾辈这种流量很小的网站完全可以接受。</p></blockquote><p>于是，吾辈想到了利用 <a href="https://workers.cloudflare.com/">cloudflare workers</a> 代理的方法，它的基本思路与 weserv 类似，但不再使用它的服务，而是直接使用 cloudflare 代理。lambda 函数实现很简单，就是透传 url 参数罢了。</p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {<br>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-params">request</span>) {<br>    <span class="hljs-keyword">const</span> url = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(request.<span class="hljs-property">url</span>)<br>    <span class="hljs-keyword">const</span> r = url.<span class="hljs-property">searchParams</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'url'</span>)<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'r'</span>, r)<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(r)<br>  },<br>}<br></code></pre></td></tr></tbody></table></figure><p>部署上去之后，再配置一下自定义路由。于是，吾辈便有了一个基本的图片访问代理 <a href="https://image-proxy.rxliuli.com/">https://image-proxy.rxliuli.com</a>。可以检查另一篇 <a href="/p/7a436b6754e4484db517fc002532d94d">终之空通关感想</a>，它已经在使用这个代理服务了。</p><h2 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h2><p>使用之后，图片加载速度变得看起来还不错。</p><p><img src="/resources/ac26ab6a729f4cd3b4ea5c2bc9eee18a.png" alt="1667745662310.png"></p><p>直接使用 curl 访问单张图片它们看起来差距没那么大，但在浏览器中同时加载多张图片的体验却截然不同。下面是使用 curl 的对比</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ time curl https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEUmvKBtRxGeG-J-0oVDVmdZccu0E0_HiDHaMPlvWBLp1v2wjaA152s9FxkIRFZROAChN-tYgimcK-ZYBFD_KGya40RzSKfDTVJqvoXjg5CsBmAaJPurSPdDmaDm6Bcunj4IxL_YPBnwtH0h7XdwaUxN=w1600-h1200-no<br><br>real    0m1.951s<br>user    0m0.000s<br>sys     0m0.000s<br><br>$ time curl https://images.weserv.nl/?url=https://lh3.googleusercontent.com/pw/AL9nZEUmvKBtRxGeG-J-0oVDVmdZccu0E0_HiDHaMPlvWBLp1v2wjaA152s9FxkIRFZROAChN-tYgimcK-ZYBFD_KGya40RzSKfDTVJqvoXjg5CsBmAaJPurSPdDmaDm6Bcunj4IxL_YPBnwtH0h7XdwaUxN=w1600-h1200-no<br><br>real    0m4.584s<br>user    0m0.000s<br>sys     0m0.000s<br></code></pre></td></tr></tbody></table></figure><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>公共的服务看起来不错，weserv 甚至将性能作为第一点声明，但免费的东西使用的太多了性能可能就会变差，毕竟资源总是有限的呢。</p><p><img src="/resources/4bc71ba715f048b5b5d7beb7bb93cd56.png" alt="1667746013873.png"></p>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="前端" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="有趣的知识" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="工具" scheme="https://blog.rxliuli.com/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>2022 年里做前端是怎样一种体验</title>
    <link href="https://blog.rxliuli.com/p/ef26175b98af43ccaf918296a739ded5/"/>
    <id>https://blog.rxliuli.com/p/ef26175b98af43ccaf918296a739ded5/</id>
    <published>2022-11-06T08:23:18.431Z</published>
    <updated>2022-11-28T16:09:33.887Z</updated>
    
    <content type="html"><![CDATA[<p>今天在社区聊天群友说起 react 状态管理器时突然想起来了一篇旧文 <a href="/p/333051b25bd047e8864d161a9a6982de">2016 年里做前端是怎样一种体验</a>，所以又模仿它跟着最近的新的技术写了一点。</p><p>问：最近我开始了一个新的 web 项目，不过老实说我已经好久没碰过这方面的代码了，之前只写过 vue2。听说前端的技术栈已经发生了极大的变革，不知道你现在是不是仍然处于最前沿的开发者阵列？<br>答: 是的，自从 hooks 出来之后，web 框架又发生了很多的变化。并且我刚从 Next.js Conf 2022 回来，因此我觉得我还是了解目前 Web 前端领域最新的面貌的。<br>问：不错不错，我的需求其实也不复杂，就是从后端提供的 REST 风格的 EndPoint 来获取用户活动数据并且将其展示在前端界面上。并且需要以列表形式展示，同时，列表要支持筛选排序等操作，对了，还要保证前端数据和服务端保持一致，以及能够做基本的编辑。其实就是简单的后台增删改查，按照我现在的理解，我打算用 vue2+axios 来抓取与操作数据，你觉得咋样？<br>答：不不不，现在估计已经没多少人使用 vue2 了吧。你可以试试 react，毕竟这是 2022 年了啊。<br>问：额，好吧，那 react 和 vue2 有什么区别啊？<br>答：react 是倾向函数式、不可变的框架，社区丰富，实践很多，而且 hooks 改变了一切。<br>问：不错不错，那我是不是就可以用 react+axios 来展示数据了呢？<br>答：额，你的应用需要处理任何的状态变更吗？<br>问：应该需要，有什么推荐么？我之前用过 vuex，听说 react 社区的是 redux？<br>答：都 2022 了，redux 早就过时了。试试新的基于 hooks 的状态管理器吧<br>问：举点例子？<br>答：分布式的用 jotai，集中的用 zustand，中后台无脑用 valtio，基本上 daishi kato 把你所有的需求都包了<br>问：好吧，我知道现在状态管理器很多了，听起来我应该用 valtio<br>答：是的，其实还有几十个我没说出来呢<br>问：那我是不是就可以用 webpack 创建一个项目开发了<br>答：额，现在 webpack 也过时了<br>问：过时了，那我要用什么？gulp？<br>答：webpack 太慢了，现在你应该用 vite、turbopack 之类的更快的构建工具<br>问：它们都是什么？<br>答：vite 是一个跨框架的打包工具，它基于 rollup+esbuild，比 webpack 快得多。turbopack 则是 webpack 作者基于 swc 重写的构建工具，比 vite 快 10 倍（就是还没能生产可用 #小声<br>问：你是不是专门一字排开名词来了？rollup 我了解，esbuild/swc 是什么？<br>答：esbuild/swc 是基于 native 编程语言写的编译器，它们分别使用 golang/rust 编写，比 babel 快 10~100 倍？<br>问：我之前用过 babel，插件很多，上一次你似乎推荐给我的就是这个？<br>答：时代在变化嘛～，就像 css 现在都已经过时了<br>问：嗯？css 过时了，那我怎么写样式？<br>答：试试 style-component？或者 tailwind？<br>问：我听说过 sass/less，但不知道这些是什么<br>答：style-component 是在 js 里写 css，它不需要单独的 css 文件，而且可以作为 js 值更容易复用。tailwind 则可以让你完全不写，只写 class 就好了，例如 w-9 h-9<br>问：听起来像是 style 内联样式？它们不是不推荐了么？<br>答：tailwind 不一样，你可以试试看<br>问：好吧，我只想写点简单的样式而已，不会太复杂<br>答：那好吧，你可以直接用 css-module 比较简单<br>问：我不想再纠结于这些名词了，再强调一遍，我只是想做个后台增删改查罢了。<br>答：那你可能根本不需要框架</p><blockquote><p>PS1：redux 之前的流行似乎是因为 react 社区当时 FP 魔怔了<br>PS2：即便写 react 也有人并不喜欢 style-component/tailwind</p></blockquote>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="前端" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="有趣的知识" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/%E6%9C%89%E8%B6%A3%E7%9A%84%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="杂谈" scheme="https://blog.rxliuli.com/tags/%E6%9D%82%E8%B0%88/"/>
    
    <category term="react" scheme="https://blog.rxliuli.com/tags/react/"/>
    
  </entry>
  
  <entry>
    <title>markdown 自动化</title>
    <link href="https://blog.rxliuli.com/p/3b9aa0ac801f4ec0a2494782459c0203/"/>
    <id>https://blog.rxliuli.com/p/3b9aa0ac801f4ec0a2494782459c0203/</id>
    <published>2022-10-28T02:54:44.110Z</published>
    <updated>2022-11-28T14:34:19.993Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>作为一个开发者，吾辈在工作之后开始使用了 markdown 作为一切文档的基本格式。由此衍生出来了一些处理 markdown 的需要，特别是在笔记工具使用了基于 markdown 的 joplin 之后，这种需求确切的开始存在了。</p><p>下面列出一些常见的需求</p><ul><li>在 vscode 中访问和编辑笔记</li><li>从笔记中导出 blog 需要的文件</li><li>从 markdown 生成 epub 文件和网站</li><li>从 markdown 生成 pdf 文件以便分享</li><li>更多。。。</li></ul><h2 id="工具库"><a href="#工具库" class="headerlink" title="工具库"></a>工具库</h2><p>markdown 相关的工具库有很多，举几个知名的</p><ul><li>markdown-it: 很早的一个 markdown 实现，包括 vscode 在内的许多工具都使用它</li><li>marked: 一个更古老的工具，npm 下载量更多，但我没有找到知名的用例</li><li>remark: 一个离散的 markdown 工具，几乎所有功能都交由插件系统实现，非常灵活，被 mdx 等知名工具使用</li><li>mdast: 更底层的 markdown ast 抽象，提供了各种各样的工具包，是 remark 的底层依赖</li></ul><p>虽然有这么多的工具，但最终吾辈选择了 mdast，原因是多方面的</p><ul><li>支持仅修改 markdown 而不将之转换为 html，其他工具一般只能将自定义操作作为插件嵌入到渲染流程中，而不能单独获取和处理 ast，它是吾辈已知唯一能这样做的库</li><li>mdast 提供 markdown 的 ast 抽象，并且对开发者暴露，也能与其他工具很好的结合，例如 astexplorer 支持查看基于 mdast 抽象的 markdown 语法树</li><li>mdast/remark 同源，但 mdast 层级更低也更快，没有准确的测量但实际用例中快了 5 倍</li></ul><p>所以最终选择了 mdast，即便它也有一些缺点，但仍然瑕不掩瑜</p><ul><li>mdast 非常离散化，所需的功能基本都在社区插件包中维护，这意味着要依赖非常多的模块 – 通过自行维护 <a href="https://www.npmjs.com/package/@liuli-util/markdown-util">@liuli-util/markdown-util</a> 解决</li><li>mdast 是 esm only 的，这个社区也开始放弃 cjs 了 – 吾辈也开始这样做了，虽然许多模块仍然支持 cjs，但新的模块已经默认 esm only 了</li></ul><h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><p>一个最简单的使用示例是将 markdown 转换为 html</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { toHtml } <span class="hljs-keyword">from</span> <span class="hljs-string">'hast-util-to-html'</span><br><span class="hljs-keyword">import</span> { fromMarkdown } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast-util-from-markdown'</span><br><span class="hljs-keyword">import</span> { gfmFromMarkdown } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast-util-gfm'</span><br><span class="hljs-keyword">import</span> { toHast } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast-util-to-hast'</span><br><span class="hljs-keyword">import</span> { gfm } <span class="hljs-keyword">from</span> <span class="hljs-string">'micromark-extension-gfm'</span><br><br><span class="hljs-keyword">const</span> s = <span class="hljs-string">'## Hello **World**!'</span><br><span class="hljs-keyword">const</span> root = <span class="hljs-title function_">fromMarkdown</span>(s, {<br>  <span class="hljs-attr">extensions</span>: [<span class="hljs-title function_">gfm</span>()],<br>  <span class="hljs-attr">mdastExtensions</span>: [<span class="hljs-title function_">gfmFromMarkdown</span>()],<br>})<br><span class="hljs-keyword">const</span> r = <span class="hljs-title function_">toHtml</span>(<span class="hljs-title function_">toHast</span>(root)!)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(r) <span class="hljs-comment">// &lt;h2&gt;Hello &lt;strong&gt;World&lt;/strong&gt;!&lt;/h2&gt;</span><br></code></pre></td></tr></tbody></table></figure><p>可以看到，比想象中要麻烦一些，必须使用各种插件和工具，只是这个简单的工作我们需要使用 5 个模块，但在下面吾辈会证明这是值得的，也是可以解决的。</p><p>这里我们可以先简单封装一下，三个最基本的函数</p><ul><li><code>fromMarkdown</code>: 从 markdown 文本得到 ast</li><li><code>toMarkdown</code>: 从 ast 转换为 markdown 文本</li><li><code>toHTML</code>: 从 ast 转换为 html 文本</li></ul><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> {<br>  fromMarkdown <span class="hljs-keyword">as</span> fm,<br>  <span class="hljs-title class_">Options</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">FmOptions</span>,<br>} <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast-util-from-markdown'</span><br><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Options</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">TmOptions</span>, toMarkdown <span class="hljs-keyword">as</span> tm } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast-util-to-markdown'</span><br><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">Content</span>, <span class="hljs-title class_">Root</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast'</span><br><span class="hljs-keyword">import</span> {<br>  frontmatterFromMarkdown,<br>  frontmatterToMarkdown,<br>} <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast-util-frontmatter'</span><br><span class="hljs-keyword">import</span> { frontmatter } <span class="hljs-keyword">from</span> <span class="hljs-string">'micromark-extension-frontmatter'</span><br><span class="hljs-keyword">import</span> { gfm } <span class="hljs-keyword">from</span> <span class="hljs-string">'micromark-extension-gfm'</span><br><span class="hljs-keyword">import</span> { gfmFromMarkdown, gfmToMarkdown } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast-util-gfm'</span><br><span class="hljs-keyword">import</span> { toHast } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast-util-to-hast'</span><br><span class="hljs-keyword">import</span> { toHtml <span class="hljs-keyword">as</span> hastToHtml } <span class="hljs-keyword">from</span> <span class="hljs-string">'hast-util-to-html'</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 解析 markdown 文本为 ast</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> <span class="hljs-variable">content</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@returns</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fromMarkdown</span>(<span class="hljs-params">content: <span class="hljs-built_in">string</span>, options?: FmOptions</span>): <span class="hljs-title class_">Root</span> {<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fm</span>(content, {<br>    ...options,<br>    <span class="hljs-attr">extensions</span>: [<span class="hljs-title function_">frontmatter</span>([<span class="hljs-string">'yaml'</span>]), <span class="hljs-title function_">gfm</span>()].<span class="hljs-title function_">concat</span>(<br>      options?.<span class="hljs-property">extensions</span> ?? [],<br>    ),<br>    <span class="hljs-attr">mdastExtensions</span>: [<br>      <span class="hljs-title function_">frontmatterFromMarkdown</span>([<span class="hljs-string">'yaml'</span>]),<br>      <span class="hljs-title function_">gfmFromMarkdown</span>(),<br>    ].<span class="hljs-title function_">concat</span>(options?.<span class="hljs-property">mdastExtensions</span> ?? []),<br>  })<br>}<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 将 markdown ast 转换为文本</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> <span class="hljs-variable">ast</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@returns</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">toMarkdown</span>(<span class="hljs-params">ast: Content | Root, options?: TmOptions</span>): <span class="hljs-built_in">string</span> {<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">tm</span>(ast, {<br>    ...options,<br>    <span class="hljs-attr">extensions</span>: [<span class="hljs-title function_">frontmatterToMarkdown</span>([<span class="hljs-string">'yaml'</span>]), <span class="hljs-title function_">gfmToMarkdown</span>()].<span class="hljs-title function_">concat</span>(<br>      options?.<span class="hljs-property">extensions</span> ?? [],<br>    ),<br>  })<br>}<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 将一段 markdown ast 序列化为 html</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> <span class="hljs-variable">node</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@returns</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">toHtml</span>(<span class="hljs-params">node: Root</span>): <span class="hljs-built_in">string</span> {<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">hastToHtml</span>(<span class="hljs-title function_">toHast</span>(node)!)<br>}<br></code></pre></td></tr></tbody></table></figure><p>为了方便，我们默认引入了 gfm/yaml 这两个插件。下面的示例代码将直接使用这三个函数，现在重新完成之前转换 markdown 为 html 的需求</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> s = <span class="hljs-string">'## Hello **World**!'</span><br><span class="hljs-keyword">const</span> r = <span class="hljs-title function_">toHtml</span>(<span class="hljs-title function_">fromMarkdown</span>(s))<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(r) <span class="hljs-comment">// &lt;h2&gt;Hello &lt;strong&gt;World&lt;/strong&gt;!&lt;/h2&gt;</span><br></code></pre></td></tr></tbody></table></figure><p>可以看到，现在使用变得简单一些了。</p><h3 id="markdown-ast"><a href="#markdown-ast" class="headerlink" title="markdown ast"></a>markdown ast</h3><p>然后，就是 ast 部分，mdast 抽象了 markdown 的语法树，可以在 <a href="https://astexplorer.net/">astexplorer</a> 中检查一段 markdown 的语法树。</p><p><img src="/resources/f099deeb591d43ef9a00f3b3138bd696.png" alt="1669637555985.png"></p><p>实际上，它就是一个嵌套的 json 对象。当得到 ast 之后，就可以对他进行操作，例如，最简单的遍历</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Node</span>, visit } <span class="hljs-keyword">from</span> <span class="hljs-string">'unist-util-visit'</span><br><span class="hljs-keyword">import</span> { fromMarkdown } <span class="hljs-keyword">from</span> <span class="hljs-string">'../parse'</span><br><br><span class="hljs-keyword">const</span> s = <span class="hljs-string">'## Hello **World**!'</span><br><span class="hljs-keyword">const</span> root = <span class="hljs-title function_">fromMarkdown</span>(s)<br><span class="hljs-title function_">visit</span>(root, <span class="hljs-function">(<span class="hljs-params">node: Node</span>) =&gt;</span> {<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(node.<span class="hljs-property">type</span>)<br>})<br></code></pre></td></tr></tbody></table></figure><p>或者对它做一些修改，例如将粗体的替换为普通文本</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Node</span>, <span class="hljs-title class_">Parent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'unist'</span><br><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Strong</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast'</span><br><span class="hljs-keyword">import</span> { visit } <span class="hljs-keyword">from</span> <span class="hljs-string">'unist-util-visit'</span><br><span class="hljs-keyword">import</span> { fromMarkdown, toMarkdown } <span class="hljs-keyword">from</span> <span class="hljs-string">'../parse'</span><br><br><span class="hljs-keyword">const</span> s = <span class="hljs-string">'## Hello **World**!'</span><br><span class="hljs-keyword">const</span> root = <span class="hljs-title function_">fromMarkdown</span>(s)<br><span class="hljs-title function_">visit</span>(root, <span class="hljs-function">(<span class="hljs-params">node: Node</span>) =&gt;</span> {<br>  <span class="hljs-keyword">if</span> (<span class="hljs-string">'children'</span> <span class="hljs-keyword">in</span> (node <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)) {<br>    <span class="hljs-keyword">const</span> p = node <span class="hljs-keyword">as</span> <span class="hljs-title class_">Parent</span><br>    p.<span class="hljs-property">children</span> = p.<span class="hljs-property">children</span>.<span class="hljs-title function_">flatMap</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span><br>      item.<span class="hljs-property">type</span> === <span class="hljs-string">'strong'</span> ? (item <span class="hljs-keyword">as</span> <span class="hljs-title class_">Strong</span>).<span class="hljs-property">children</span> : [item],<br>    )<br>  }<br>})<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">toMarkdown</span>(root)) <span class="hljs-comment">// ## Hello World!</span><br></code></pre></td></tr></tbody></table></figure><p>嗯，引入了 3 个模块。我们可以更进一步封装一个适用于 mdast 的 <code>flatMap</code></p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 映射一棵 ast 树</span><br><span class="hljs-comment"> * 注：其中会执行真实的修改操作</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> <span class="hljs-variable">tree</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> <span class="hljs-variable">fn</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@returns</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> flatMap&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Node</span>&gt;(<br>  <span class="hljs-attr">tree</span>: T,<br>  <span class="hljs-attr">fn</span>: <span class="hljs-function">(<span class="hljs-params">node: Node, i: <span class="hljs-built_in">number</span>, parent?: Parent</span>) =&gt;</span> <span class="hljs-title class_">Node</span>[],<br>): T {<br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">transform</span>(<span class="hljs-params">node: Node, i: <span class="hljs-built_in">number</span>, parent?: Parent</span>): <span class="hljs-title class_">Node</span>[] {<br>    <span class="hljs-keyword">if</span> (<span class="hljs-string">'children'</span> <span class="hljs-keyword">in</span> node) {<br>      <span class="hljs-keyword">const</span> p = node <span class="hljs-keyword">as</span> <span class="hljs-built_in">unknown</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">Parent</span><br>      p.<span class="hljs-property">children</span> = p.<span class="hljs-property">children</span>.<span class="hljs-title function_">flatMap</span>(<span class="hljs-function">(<span class="hljs-params">item, i</span>) =&gt;</span> <span class="hljs-title function_">transform</span>(item, i, p)) <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span><br>    }<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">fn</span>(node, i, parent)<br>  }<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">transform</span>(tree, <span class="hljs-number">0</span>, <span class="hljs-literal">undefined</span>)[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> T<br>}<br></code></pre></td></tr></tbody></table></figure><p>使用 <code>flatMap</code> 重新完成它</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { fromMarkdown, toMarkdown } <span class="hljs-keyword">from</span> <span class="hljs-string">'../parse'</span><br><span class="hljs-keyword">import</span> { flatMap } <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils'</span><br><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Strong</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast'</span><br><br><span class="hljs-keyword">const</span> s = <span class="hljs-string">'## Hello **World**!'</span><br><span class="hljs-keyword">const</span> root = <span class="hljs-title function_">fromMarkdown</span>(s)<br><span class="hljs-title function_">flatMap</span>(root, <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span><br>  item.<span class="hljs-property">type</span> === <span class="hljs-string">'strong'</span> ? (item <span class="hljs-keyword">as</span> <span class="hljs-title class_">Strong</span>).<span class="hljs-property">children</span> : [item],<br>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">toMarkdown</span>(root)) <span class="hljs-comment">// ## Hello World!</span><br></code></pre></td></tr></tbody></table></figure><p>嗯，只需要一步就完成了。嗯，为了性能吾辈并未将 flatMap 实现为返回一个新的 ast，当然，如果期望如此，无论如何都可以使用 immer 之类的库来实现 immutable。</p><h3 id="转换链接"><a href="#转换链接" class="headerlink" title="转换链接"></a>转换链接</h3><p>好吧，来看一些真实的需求<br>第一个是修改 markdown 中的链接，例如希望将链接中的资源都转换为 cdn 地址，这里使用 google photos 作为示例</p><p>原始 markdown 内容</p><figure class="highlight md"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs md">![<span class="hljs-string">test</span>](<span class="hljs-link">resources/aaefd6438fcd48d68f62fc2478f1f857.png</span>)<br>![<span class="hljs-string">1669384280333.png</span>](<span class="hljs-link">https://lh3.googleusercontent.com/pw/AL9nZEUmvKBtRxGeG-J-0oVDVmdZccu0E0_HiDHaMPlvWBLp1v2wjaA152s9FxkIRFZROAChN-tYgimcK-ZYBFD_KGya40RzSKfDTVJqvoXjg5CsBmAaJPurSPdDmaDm6Bcunj4IxL_YPBnwtH0h7XdwaUxN=w1600-h1200-no</span>)<br></code></pre></td></tr></tbody></table></figure><p>希望转换得到的 markdown 内容，即为 google 图片的地址添加代理服务，避免无法在 blog 显示的错误。同时也不能转换不相关的资源</p><figure class="highlight md"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs md">![<span class="hljs-string">test</span>](<span class="hljs-link">resources/aaefd6438fcd48d68f62fc2478f1f857.png</span>)<br>![<span class="hljs-string">1669384280333.png</span>](<span class="hljs-link">https://image-proxy.rxliuli.com/?url=https://lh3.googleusercontent.com/pw/AL9nZEUmvKBtRxGeG-J-0oVDVmdZccu0E0_HiDHaMPlvWBLp1v2wjaA152s9FxkIRFZROAChN-tYgimcK-ZYBFD_KGya40RzSKfDTVJqvoXjg5CsBmAaJPurSPdDmaDm6Bcunj4IxL_YPBnwtH0h7XdwaUxN=w1600-h1200-no</span>)<br></code></pre></td></tr></tbody></table></figure><p>实际上这件事情很简单，我们只需要过滤出来需要的节点并且修改就好了</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { fromMarkdown, toMarkdown } <span class="hljs-keyword">from</span> <span class="hljs-string">'../parse'</span><br><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Image</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast'</span><br><span class="hljs-keyword">import</span> { selectAll } <span class="hljs-keyword">from</span> <span class="hljs-string">'unist-util-select'</span><br><br><span class="hljs-keyword">const</span> s = <span class="hljs-string">`</span><br><span class="hljs-string">![test](resources/aaefd6438fcd48d68f62fc2478f1f857.png)</span><br><span class="hljs-string">![1669384280333.png](https://lh3.googleusercontent.com/pw/AL9nZEUmvKBtRxGeG-J-0oVDVmdZccu0E0_HiDHaMPlvWBLp1v2wjaA152s9FxkIRFZROAChN-tYgimcK-ZYBFD_KGya40RzSKfDTVJqvoXjg5CsBmAaJPurSPdDmaDm6Bcunj4IxL_YPBnwtH0h7XdwaUxN=w1600-h1200-no)</span><br><span class="hljs-string">`</span>.<span class="hljs-title function_">trim</span>()<br><span class="hljs-keyword">const</span> root = <span class="hljs-title function_">fromMarkdown</span>(s)<br>;(<span class="hljs-title function_">selectAll</span>(<span class="hljs-string">'image'</span>, root) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Image</span>[])<br>  .<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span><br>    item.<span class="hljs-property">url</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'https://lh3.googleusercontent.com/pw/'</span>),<br>  )<br>  .<span class="hljs-title function_">forEach</span>(<br>    <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> (item.<span class="hljs-property">url</span> = <span class="hljs-string">`https://image-proxy.rxliuli.com/?url=<span class="hljs-subst">${item.url}</span>`</span>),<br>  )<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">toMarkdown</span>(root))<br></code></pre></td></tr></tbody></table></figure><h3 id="修改元数据"><a href="#修改元数据" class="headerlink" title="修改元数据"></a>修改元数据</h3><p>我们还可以修改 markdown 的元数据，例如我们从 hexo 转换为 hugo 时，会需要转换它们的元数据。</p><p>例如 hexo 的元数据一般格式是</p><figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">layout:</span> <span class="hljs-string">post</span><br><span class="hljs-attr">title:</span> <span class="hljs-number">2</span><span class="hljs-string">.</span> <span class="hljs-string">Importing</span> <span class="hljs-string">and</span> <span class="hljs-string">exporting</span> <span class="hljs-string">notes</span><br><span class="hljs-attr">abbrlink:</span> <span class="hljs-string">2ba8366ac77c4a93b9eb7595d1343eb6</span><br><span class="hljs-attr">tags:</span> []<br><span class="hljs-attr">date:</span> <span class="hljs-number">1667644025956</span><br><span class="hljs-attr">updated:</span> <span class="hljs-number">1667644025956</span><br></code></pre></td></tr></tbody></table></figure><p>而 hugo 的是</p><figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">title:</span> <span class="hljs-number">2</span><span class="hljs-string">.</span> <span class="hljs-string">Importing</span> <span class="hljs-string">and</span> <span class="hljs-string">exporting</span> <span class="hljs-string">notes</span><br><span class="hljs-attr">slug:</span> <span class="hljs-string">2ba8366ac77c4a93b9eb7595d1343eb6</span><br><span class="hljs-attr">tags:</span> []<br><span class="hljs-attr">date:</span> <span class="hljs-number">2022-11-05T10:27:05.956Z</span><br><span class="hljs-attr">lastmod:</span> <span class="hljs-number">2022-11-05T10:27:05.956Z</span><br></code></pre></td></tr></tbody></table></figure><p>无论如何，它们的 markdown 不会完全一样，这时候我们需要做一些简单的转换。</p><p>首先我们还是先封装 getYamlMeta/setYamlMeta 这些工具函数吧</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Root</span>, <span class="hljs-variable constant_">YAML</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast'</span><br><span class="hljs-keyword">import</span> { select } <span class="hljs-keyword">from</span> <span class="hljs-string">'unist-util-select'</span><br><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> yaml <span class="hljs-keyword">from</span> <span class="hljs-string">'yaml'</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 获取 markdown 的 yaml 元数据</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> <span class="hljs-variable">root</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@returns</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> getYamlMeta&lt;T&gt;(<span class="hljs-attr">root</span>: <span class="hljs-title class_">Root</span>): T {<br>  <span class="hljs-keyword">const</span> r = <span class="hljs-title function_">select</span>(<span class="hljs-string">'yaml'</span>, root)<br>  <span class="hljs-keyword">return</span> yaml.<span class="hljs-title function_">parse</span>(r ? (r <span class="hljs-keyword">as</span> <span class="hljs-variable constant_">YAML</span>).<span class="hljs-property">value</span> : <span class="hljs-string">''</span>)<br>}<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 设置 markdown 的 yaml 元数据</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> <span class="hljs-variable">root</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@returns</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">setYamlMeta</span>(<span class="hljs-params">root: Root, meta: <span class="hljs-built_in">any</span></span>) {<br>  <span class="hljs-keyword">const</span> r = <span class="hljs-title function_">select</span>(<span class="hljs-string">'yaml'</span>, root) <span class="hljs-keyword">as</span> <span class="hljs-variable constant_">YAML</span><br>  <span class="hljs-keyword">if</span> (r) {<br>    r.<span class="hljs-property">value</span> = yaml.<span class="hljs-title function_">stringify</span>(meta).<span class="hljs-title function_">trim</span>()<br>  } <span class="hljs-keyword">else</span> {<br>    root.<span class="hljs-property">children</span>.<span class="hljs-title function_">unshift</span>({<br>      <span class="hljs-attr">type</span>: <span class="hljs-string">'yaml'</span>,<br>      <span class="hljs-attr">value</span>: yaml.<span class="hljs-title function_">stringify</span>(meta).<span class="hljs-title function_">trim</span>(),<br>    } <span class="hljs-keyword">as</span> <span class="hljs-variable constant_">YAML</span>)<br>  }<br>}<br></code></pre></td></tr></tbody></table></figure><p>然后就可以简单的修改元数据了</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { fromMarkdown, toMarkdown } <span class="hljs-keyword">from</span> <span class="hljs-string">'../parse'</span><br><span class="hljs-keyword">import</span> { getYamlMeta, setYamlMeta } <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils'</span><br><br><span class="hljs-keyword">const</span> s = <span class="hljs-string">`</span><br><span class="hljs-string">---</span><br><span class="hljs-string">layout: post</span><br><span class="hljs-string">title: 2. Importing and exporting notes</span><br><span class="hljs-string">abbrlink: 2ba8366ac77c4a93b9eb7595d1343eb6</span><br><span class="hljs-string">tags: []</span><br><span class="hljs-string">date: 1667644025956</span><br><span class="hljs-string">updated: 1667644025956</span><br><span class="hljs-string">---</span><br><span class="hljs-string">`</span>.<span class="hljs-title function_">trim</span>()<br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">HexoMeta</span> {<br>  <span class="hljs-attr">layout</span>: <span class="hljs-built_in">string</span><br>  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span><br>  <span class="hljs-attr">abbrlink</span>: <span class="hljs-built_in">string</span><br>  <span class="hljs-attr">tags</span>: <span class="hljs-built_in">string</span>[]<br>  <span class="hljs-attr">date</span>: <span class="hljs-built_in">number</span><br>  <span class="hljs-attr">updated</span>: <span class="hljs-built_in">number</span><br>}<br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">HugoMeta</span> {<br>  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span><br>  <span class="hljs-attr">slug</span>: <span class="hljs-built_in">string</span><br>  <span class="hljs-attr">tags</span>: <span class="hljs-built_in">string</span>[]<br>  <span class="hljs-attr">date</span>: <span class="hljs-built_in">string</span><br>  <span class="hljs-attr">lastmod</span>: <span class="hljs-built_in">string</span><br>}<br><span class="hljs-keyword">const</span> root = <span class="hljs-title function_">fromMarkdown</span>(s)<br><span class="hljs-keyword">const</span> meta = <span class="hljs-title function_">getYamlMeta</span>(root) <span class="hljs-keyword">as</span> <span class="hljs-title class_">HexoMeta</span><br><span class="hljs-title function_">setYamlMeta</span>(root, {<br>  <span class="hljs-attr">title</span>: meta.<span class="hljs-property">title</span>,<br>  <span class="hljs-attr">slug</span>: meta.<span class="hljs-property">abbrlink</span>,<br>  <span class="hljs-attr">tags</span>: meta.<span class="hljs-property">tags</span>,<br>  <span class="hljs-attr">date</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(meta.<span class="hljs-property">date</span>).<span class="hljs-title function_">toISOString</span>(),<br>  <span class="hljs-attr">lastmod</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(meta.<span class="hljs-property">updated</span>).<span class="hljs-title function_">toISOString</span>(),<br>} <span class="hljs-keyword">as</span> <span class="hljs-title class_">HugoMeta</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">toMarkdown</span>(root))<br></code></pre></td></tr></tbody></table></figure><h3 id="清除额外的空格"><a href="#清除额外的空格" class="headerlink" title="清除额外的空格"></a>清除额外的空格</h3><p>可能不太为人所知的是，markdown 对东亚字符的支持一直有问题，一个之前遇到的例子是如果粗体的结尾使用中文符号，则粗体不会生效。</p><p>例如</p><figure class="highlight md"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs md"><span class="hljs-strong">**真没想到我这么快就要死了，**</span>她有些自暴自弃地想着。<br></code></pre></td></tr></tbody></table></figure><p>会被渲染为</p><p>**真没想到我这么快就要死了，**她有些自暴自弃地想着。</p><p>这很奇怪，但确实存在，commonmark 的实现 markdown-it 官方的建议是添加额外的空格，例如修改为</p><figure class="highlight md"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs md"><span class="hljs-strong">**真没想到我这么快就要死了，**</span> 她有些自暴自弃地想着。<br></code></pre></td></tr></tbody></table></figure><p>这样就能正确渲染粗体了</p><p><strong>真没想到我这么快就要死了，</strong> 她有些自暴自弃地想着。</p><p>但这会渲染额外的空格，如果期望最终 html 中不渲染这个额外的空格怎么办？可以使用程序删除掉它。<br>这里有两种方法</p><ol><li>直接修改 markdown ast 清除空格</li><li>转换为 html 语法树之后再修改</li></ol><p>由于这里更关注 markdown，所以会采用第一种方法</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Strong</span>, <span class="hljs-title class_">Text</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast'</span><br><span class="hljs-keyword">import</span> { fromMarkdown } <span class="hljs-keyword">from</span> <span class="hljs-string">'../parse'</span><br><span class="hljs-keyword">import</span> { toHtml } <span class="hljs-keyword">from</span> <span class="hljs-string">'../stringify'</span><br><span class="hljs-keyword">import</span> { flatMap } <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils'</span><br><br><span class="hljs-keyword">const</span> s = <span class="hljs-string">`**真没想到我这么快就要死了，** 她有些自暴自弃地想着。`</span><br><span class="hljs-keyword">const</span> root = <span class="hljs-title function_">fromMarkdown</span>(s)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">toHtml</span>(root)) <span class="hljs-comment">// &lt;p&gt;&lt;strong&gt;真没想到我这么快就要死了，&lt;/strong&gt; 她有些自暴自弃地想着。&lt;/p&gt;</span><br><span class="hljs-title function_">flatMap</span>(root, <span class="hljs-function">(<span class="hljs-params">item, i, p</span>) =&gt;</span> {<br>  <span class="hljs-keyword">if</span> (item.<span class="hljs-property">type</span> === <span class="hljs-string">'strong'</span>) {<br>    <span class="hljs-keyword">const</span> v = item <span class="hljs-keyword">as</span> <span class="hljs-title class_">Strong</span><br>    <span class="hljs-keyword">const</span> next = p!.<span class="hljs-property">children</span>[i + <span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">const</span> s = (v.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-title class_">Text</span>).<span class="hljs-property">value</span><br>    <span class="hljs-keyword">if</span> (s) {<br>      <span class="hljs-keyword">const</span> last = s.<span class="hljs-title function_">slice</span>(s.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)<br>      <span class="hljs-keyword">if</span> (<br>        next &amp;&amp;<br>        next.<span class="hljs-property">type</span> === <span class="hljs-string">'text'</span> &amp;&amp;<br>        [<span class="hljs-string">'，'</span>, <span class="hljs-string">'。'</span>, <span class="hljs-string">'？'</span>, <span class="hljs-string">'！'</span>, <span class="hljs-string">'〉'</span>].<span class="hljs-title function_">includes</span>(last) &amp;&amp;<br>        next.<span class="hljs-property">value</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">' '</span>)<br>      ) {<br>        next.<span class="hljs-property">value</span> = next.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>()<br>      }<br>    }<br>  }<br>  <span class="hljs-keyword">return</span> [item]<br>})<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">toHtml</span>(root)) <span class="hljs-comment">// &lt;p&gt;&lt;strong&gt;真没想到我这么快就要死了，&lt;/strong&gt;她有些自暴自弃地想着。&lt;/p&gt;</span><br></code></pre></td></tr></tbody></table></figure><h3 id="创建插件"><a href="#创建插件" class="headerlink" title="创建插件"></a>创建插件</h3><p>现在，我们可以来谈一下 mdast 中的插件了，更准确的说是 mdast-util-from-markdown/mdast-util-to-markdown 所支持的插件系统。我们上面写的那些其实都可以封装为插件</p><p>例如最初的转换链接可以封装为插件，可以封装为 MdastExtensions 插件以便在 transforms hooks 中转换 ast</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { fromMarkdown, toMarkdown } <span class="hljs-keyword">from</span> <span class="hljs-string">'../parse'</span><br><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Image</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast'</span><br><span class="hljs-keyword">import</span> { selectAll } <span class="hljs-keyword">from</span> <span class="hljs-string">'unist-util-select'</span><br><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Extension</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast-util-from-markdown'</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">googleImageProxyFromMarkdown</span>(<span class="hljs-params"></span>): <span class="hljs-title class_">Extension</span> {<br>  <span class="hljs-keyword">return</span> {<br>    <span class="hljs-attr">transforms</span>: [<br>      <span class="hljs-function">(<span class="hljs-params">root</span>) =&gt;</span> {<br>        ;(<span class="hljs-title function_">selectAll</span>(<span class="hljs-string">'image'</span>, root) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Image</span>[])<br>          .<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span><br>            item.<span class="hljs-property">url</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'https://lh3.googleusercontent.com/pw/'</span>),<br>          )<br>          .<span class="hljs-title function_">forEach</span>(<br>            <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span><br>              (item.<span class="hljs-property">url</span> = <span class="hljs-string">`https://image-proxy.rxliuli.com/?url=<span class="hljs-subst">${item.url}</span>`</span>),<br>          )<br>      },<br>    ],<br>  }<br>}<br><span class="hljs-keyword">const</span> root = <span class="hljs-title function_">fromMarkdown</span>(s, {<br>  <span class="hljs-attr">mdastExtensions</span>: [<span class="hljs-title function_">googleImageProxyFromMarkdown</span>()],<br>})<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">toMarkdown</span>(root))<br></code></pre></td></tr></tbody></table></figure><p>也可以封装为输出插件，在 handlers hooks 中处理 image 类型的 ast</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { fromMarkdown, toMarkdown } <span class="hljs-keyword">from</span> <span class="hljs-string">'../parse'</span><br><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Image</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast'</span><br><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Options</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'mdast-util-to-markdown'</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">googleImageProxyToMarkdown</span>(<span class="hljs-params"></span>): <span class="hljs-title class_">Options</span> {<br>  <span class="hljs-keyword">return</span> {<br>    <span class="hljs-attr">handlers</span>: {<br>      <span class="hljs-title function_">image</span>(<span class="hljs-params">node</span>) {<br>        <span class="hljs-keyword">const</span> l = node <span class="hljs-keyword">as</span> <span class="hljs-title class_">Image</span><br>        <span class="hljs-keyword">if</span> (l.<span class="hljs-property">url</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'https://lh3.googleusercontent.com/pw/'</span>)) {<br>          l.<span class="hljs-property">url</span> = <span class="hljs-string">`https://image-proxy.rxliuli.com/?url=<span class="hljs-subst">${l.url}</span>`</span><br>        }<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">`![<span class="hljs-subst">${l.alt}</span>](<span class="hljs-subst">${l.url}</span>)`</span><br>      },<br>    },<br>  }<br>}<br><span class="hljs-keyword">const</span> root = <span class="hljs-title function_">fromMarkdown</span>(s)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<br>  <span class="hljs-title function_">toMarkdown</span>(root, {<br>    <span class="hljs-attr">extensions</span>: [<span class="hljs-title function_">googleImageProxyToMarkdown</span>()],<br>  }),<br>)<br></code></pre></td></tr></tbody></table></figure><p>就吾辈而言，一般不会将这种操作封装为插件，而是封装为简单的函数，接收一个 ast 并返回一个 ast 的函数，在需要时直接使用即可。除非一些明显适合使用插件的场景，例如要支持新的语法，例如 <code>[[wiki]]</code> 链接之类的，对这个插件感兴趣可以查看 <a href="https://github.com/rxliuli/mami/blob/master/packages/plugin-obsidian/src/utils/wiki.ts">https://github.com/rxliuli/mami/blob/master/packages/plugin-obsidian/src/utils/wiki.ts</a>。</p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>markdown 是一个有趣的格式，现在几乎所有开发者相关的平台（非国内）都支持它，所以自然而然衍生了很多相关的工具和模块，而基于个人独特的需求则衍生了更多的东西。就吾辈而言，吾辈创建的与 markdown 相关的工具或库包括</p><ul><li><a href="https://marketplace.visualstudio.com/items?itemName=rxliuli.joplin-vscode-plugin">joplin-vscode-plugin</a>: joplin 的 vscode 集成，基于 vscode 提供强大的编辑功能</li><li><a href="https://mami.rxliuli.com/">mami</a>: 跨工具的 note/blog/wiki 转换器，目前支持 joplin/obsidian/hexo/hugo/docsify/local/raw</li><li><a href="https://github.com/rxliuli/mdbook">mdbook</a>: markdown 转换为 epub 的工具，自行实现的主要原因是需要处理中文支持</li><li><a href="https://www.npmjs.com/package/@liuli-util/markdown-util">@liuli-util/markdown-util</a>: 一个 markdown 工具库，将上面那些零散的模块统一导出使用，mami/mdbook 都使用它</li><li><a href="https://www.npmjs.com/package/joplin-blog">joplin-blog</a>: 从 joplin 生成静态网站，支持 hexo/vuepress/docsify/jeykll，已被 mami 替代</li><li><a href="https://github.com/rxliuli/markdown-extension-pack">markdown-extension-pack</a>: 4 年前的一个项目，尝试 pack 了一些常用的 markdown 插件</li></ul>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="前端" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="框架" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/%E6%A1%86%E6%9E%B6/"/>
    
    
    <category term="markdown" scheme="https://blog.rxliuli.com/tags/markdown/"/>
    
    <category term="ast" scheme="https://blog.rxliuli.com/tags/ast/"/>
    
  </entry>
  
  <entry>
    <title>mami 一个跨工具文档转换器</title>
    <link href="https://blog.rxliuli.com/p/a657a02fccca4f788fb864f2ec8ebfa0/"/>
    <id>https://blog.rxliuli.com/p/a657a02fccca4f788fb864f2ec8ebfa0/</id>
    <published>2022-10-11T15:51:55.884Z</published>
    <updated>2022-11-05T04:45:35.936Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>最近在写的一个工具，用以连接不同的工具，使它们的数据能够相互转换，主要用例是多平台发布和跨应用迁移，例如从 joplin/obsidian 笔记中选择一部分通过 hexo/hugo 渲染为 blog 共享给别人，事实上，现在你看到这个 blog 就是这样生成出来的。</p></blockquote><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>mami 是一个转换工具，可以连接不同的基于 markdown 框架和工具，能将一种工具的数据转换到另一种工具，这对于跨应用迁移以及多平台发布很有帮助，目前已支持 <code>joplin/obsidian/hexo/hugo/raw</code>，计划将支持 <code>docsify/vuepress</code>。</p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><blockquote><p>前置条件</p><ul><li>你需要安装 <a href="https://nodejs.org/en/download/">nodejs 18</a></li></ul></blockquote><h3 id="步骤-1：创建新项目"><a href="#步骤-1：创建新项目" class="headerlink" title="步骤 1：创建新项目"></a>步骤 1：创建新项目</h3><blockquote><p>下面使用 pnpm 作为包管理器，但你可以替换它为 npm</p></blockquote><p>创建新目录并进入</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">mkdir</span> mami-starter &amp;&amp; <span class="hljs-built_in">cd</span> mami-starter<br></code></pre></td></tr></tbody></table></figure><p>然后使用喜欢的包管理器初始化</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">pnpm init<br></code></pre></td></tr></tbody></table></figure><h3 id="步骤-2：安装-mami"><a href="#步骤-2：安装-mami" class="headerlink" title="步骤 2：安装 mami"></a>步骤 2：安装 mami</h3><p>添加 @mami/cli 和 typescript 作为项目的开发依赖项</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">pnpm i -D @mami/cli typescript<br></code></pre></td></tr></tbody></table></figure><p>添加一些脚本到 <code>package.json</code></p><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">{</span><br>  ...<br>  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><br>    <span class="hljs-attr">"gen"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"mami"</span><br>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br>  ...<br><span class="hljs-punctuation">}</span><br></code></pre></td></tr></tbody></table></figure><p>创建你的配置文件 <code>mami.config.ts</code></p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'@mami/cli'</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({<br>  <span class="hljs-attr">input</span>: [],<br>  <span class="hljs-attr">output</span>: [],<br>})<br></code></pre></td></tr></tbody></table></figure><p>然后运行</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ pnpm run gen<br><br>&gt; joplin2obsidian-demo@1.0.0 gen<br>&gt; mami<br><br>start<br>end<br></code></pre></td></tr></tbody></table></figure><p>嗯，什么也没有发生，因为你没有定义输入或输出插件。继续看下一步。</p><h3 id="步骤-3：安装需要的插件"><a href="#步骤-3：安装需要的插件" class="headerlink" title="步骤 3：安装需要的插件"></a>步骤 3：安装需要的插件</h3><p>安装需要的插件，用来连接需要的工具，这里使用 joplin =&gt; obsidian 来举例</p><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts">pnpm i -D <span class="hljs-meta">@mami</span>/plugin-joplin <span class="hljs-meta">@mami</span>/plugin-obsidian<br></code></pre></td></tr></tbody></table></figure><p>修改你的配置文件 <code>mami.config.ts</code></p><blockquote><p>这里的 joplin 插件需要的 token 来自 <a href="https://joplinapp.org/clipper/#troubleshooting-the-web-clipper-service">web clipper service</a></p></blockquote><figure class="highlight ts"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'@mami/cli'</span><br><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> joplin <span class="hljs-keyword">from</span> <span class="hljs-string">'@mami/plugin-joplin'</span><br><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> obsidian <span class="hljs-keyword">from</span> <span class="hljs-string">'@mami/plugin-obsidian'</span><br><span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({<br>  <span class="hljs-attr">input</span>: [<br>    joplin.<span class="hljs-title function_">input</span>({<br>      <span class="hljs-attr">baseUrl</span>: <span class="hljs-string">'http://127.0.0.1:41184'</span>,<br>      <span class="hljs-attr">token</span>:<br>        <span class="hljs-string">'5bcfa49330788dd68efea27a0a133d2df24df68c3fd78731eaa9914ef34811a34a782233025ed8a651677ec303de6a04e54b57a27d48898ff043fd812d8e0b31'</span>,<br>      <span class="hljs-attr">tag</span>: <span class="hljs-string">''</span>,<br>    }),<br>  ],<br>  <span class="hljs-attr">output</span>: [<br>    obsidian.<span class="hljs-title function_">output</span>({<br>      <span class="hljs-attr">root</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'dist'</span>),<br>    }),<br>  ],<br>})<br></code></pre></td></tr></tbody></table></figure><h3 id="步骤-4：执行转换"><a href="#步骤-4：执行转换" class="headerlink" title="步骤 4：执行转换"></a>步骤 4：执行转换</h3><p>然后，你可以重新运行以下命令</p><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">pnpm run gen<br></code></pre></td></tr></tbody></table></figure><p>现在，你将能在 dist 中看到转换的 obsidian 文件</p><blockquote><p><a href="https://github.com/rxliuli/mami/tree/master/demos/joplin2obsidian-demo">示例</a></p></blockquote><h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><blockquote><p><a href="https://paka.dev/npm/@mami/cli@latest/api">API 文档</a></p></blockquote><p>大致上，插件分为输入和输出插件，输入插件会返回一个 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncGenerator">AsyncGenerator</a>，而输出插件则会在钩子函数中消费它。</p><p><img src="/resources/3a914293ca6f46f79d0cac4b57046533.svg" alt="design.drawio.svg"></p><p>中间格式</p><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">{</span><br>  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0e2510c9272449dbafe3e0f3fba12d74"</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Welcome to Joplin!"</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"content body"</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">"createAt"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1666288266591</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">"updateAt"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1666288266591</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"Welcome! (Desktop)"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">"tags"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">{</span><br>      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"04dfa5cf19e4435f9f3f09a73a7edfb2"</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"blog"</span><br>    <span class="hljs-punctuation">}</span><br>  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">"resources"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">{</span><br>      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"63b83e548b7b4adfae18544b7038b0bc"</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"AllClients.png"</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">"raw"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"&lt;nodejs buffer&gt;"</span><br>    <span class="hljs-punctuation">}</span><br>  <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">}</span><br></code></pre></td></tr></tbody></table></figure><p>编写插件涉及到一些 markdown ast 操作，例如你可能需要转换 markdown 中的链接，建议使用 <a href="https://github.com/syntax-tree/mdast">mdast</a> 来处理。</p><h2 id="动机"><a href="#动机" class="headerlink" title="动机"></a>动机</h2><blockquote><p>如果你不知道 joplin-blog 是什么，那我简要介绍一下：它是一个将 joplin 笔记转换为其他形式的内容的 cli 工具，支持了 hexo、vuepress、docsify、jeykll 这些 blog/wiki 框架。ref: <a href="https://discourse.joplinapp.org/t/joplin-note-sharing-tool/13480">https://discourse.joplinapp.org/t/joplin-note-sharing-tool/13480</a></p></blockquote><p>为什么开始了这次重写？</p><p>主要原因是目前支持了一些框架，但实际上仍然不够，就吾辈而言，目前接触到了 vitepress 文档生成器，吾辈打算用它替代 vuepress，但这需要对 joplin-blog 做一些修改，实际上这并不太方便。之前也有人提到如何更有定制性的生成文件，例如在生成的 markdown 添加额外的 yaml meta 信息（ref: <a href="https://github.com/rxliuli/joplin-utils/issues/55">https://github.com/rxliuli/joplin-utils/issues/55</a>），这实际上在没有扩展点的情况下有点麻烦，那时给出的临时解决方案是以 lib 的形式使用 joplin-blog，并插入自定义的一些逻辑来完成。也有人提到了支持 hugo，但全部在 joplin-blog 中实现是不显示的。</p><p>后来，吾辈意识到支持生成任意框架的文件需要插件系统，进一步而言，吾辈甚至可以将输入源（例如 joplin）也作为插件，就像 pandoc 一样，连接不同的笔记、博客和 wiki 工具。目前做的一个尝试就是 mami，打算通过 markdown 作为中间格式进行转换。<br>目前这个项目才刚刚创建，并且仅支持 joplin 作为输入源、hexo/hugo/obsidian 作为输出源，但吾辈已经在自己的 blog 中使用了，参考：<a href="https://github.com/rxliuli/blog/blob/master/mami.config.ts">https://github.com/rxliuli/blog/blob/master/mami.config.ts</a></p><blockquote><p>PS：mami 这个名字的来源是 Puella Magi Madoka Magica 中的 <a href="https://en.wikipedia.org/wiki/Mami_Tomoe">Mami Tomoe</a>，她的魔法是<strong>缎带</strong>，可以连接各种不同的事物，甚至能组成火枪（笑）。</p></blockquote>]]></content>
    
    
      
      
    <summary type="html"></summary>
      
    
    
    
    <category term="前端" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="框架" scheme="https://blog.rxliuli.com/categories/%E5%89%8D%E7%AB%AF/%E6%A1%86%E6%9E%B6/"/>
    
    
    <category term="开源" scheme="https://blog.rxliuli.com/tags/%E5%BC%80%E6%BA%90/"/>
    
  </entry>
  
</feed>
